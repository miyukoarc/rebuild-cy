(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ef0e97c"],{"0078":function(e,t,a){},"0115":function(e,t,a){},"011c":function(e,t,a){"use strict";var i=a("fa22"),n=a.n(i);n.a},"0143":function(e,t,a){"use strict";var i=a("41b3"),n=a.n(i);n.a},"014b6":function(e,t,a){},"01cb":function(e,t,a){"use strict";var i=a("3ec7"),n=a.n(i);n.a},"0208":function(e,t,a){"use strict";var i=a("65ae"),n=a.n(i);n.a},"0368":function(e,t,a){},"0380":function(e,t,a){},"03b3":function(e,t,a){"use strict";var i=a("1b90"),n=a.n(i);n.a},"03c4":function(e,t,a){"use strict";var i=a("693c"),n=a.n(i);n.a},"03d5":function(e,t,a){"use strict";var i=a("142f"),n=a.n(i);n.a},"03ec":function(e,t,a){"use strict";var i=a("9915"),n=a.n(i);n.a},"044e":function(e,t,a){},"046d":function(e,t,a){"use strict";var i=a("4b12"),n=a.n(i);n.a},"047b":function(e,t,a){},"05b7":function(e,t,a){},"0717":function(e,t,a){},"0756":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!1}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",auth:e.permissionMap["role"]["role_update"],popAuth:!0},on:{click:function(t){return t.stopPropagation(),e.handleConfirm(t)}}},[e._v(e._s(e.auditSetting["permission"]?"提交审核":"完成"))])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[Object.keys(e.isIndeterminate).length?a("el-form",e._l(e.permissionRenderMap,(function(t,i){return a("el-form-item",{key:i,attrs:{label:e.roleDetail[i]}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate[i]},on:{change:function(t){return e.handleCheckAllChange(i)}},model:{value:e.checkAll[i],callback:function(t){e.$set(e.checkAll,i,t)},expression:"checkAll[key]"}},[e._v("全选")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:function(t){return e.handleSingleChange(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[key]"}},e._l(e.list[i],(function(t){return a("el-checkbox",{key:t.code,attrs:{label:t.uuid}},[e._v(e._s(t.title))])})),1),e._v(" "),a("el-divider")],1)})),1):e._e()],1)],1)])},n=[],s=(a("8615"),a("ac6a"),a("5530")),r=a("2f62"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},o=[],c={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},u=c,d=(a("f558"),a("2877")),m=Object(d["a"])(u,l,o,!1,null,"c89cd3d8",null),f=m.exports,h={name:"role-detail",components:{ToolBar:f},data:function(){return{checkAll:{},checked:{},isIndeterminate:{},list:{},form:{roleUuid:null,permissionUuids:[]}}},computed:Object(s["a"])({},Object(r["c"])({permissionRenderMap:function(e){return e.permission.permissionRenderMap},permissionMap:function(e){return e.permission.permissionMap},auditSetting:function(e){return e.sensitive.auditSetting},roleDetail:function(e){return e.enum.roleDetail}})),created:function(){var e=this,t=this.$route.query.code;this.form.roleUuid=+this.$route.params.uuid,this.initData().then((function(){e.initDetail({roleCode:t})}))},mounted:function(){},methods:{initDetail:function(e){var t=this;this.$store.dispatch("permission/getRolePermissionList",e).then((function(e){var a=function(a){e[a].forEach((function(e){t.checked[a].push(e.uuid)})),e[a].length==t.list[a].length&&(t.checkAll[a]=!0)};for(var i in e)a(i)})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},initData:function(){var e=this;return new Promise((function(t,a){e.$store.dispatch("permission/getListAll").then((function(a){for(var i in a)e.$set(e.checkAll,i,!1),e.$set(e.isIndeterminate,i,!1),e.$set(e.checked,i,[]),e.$set(e.list,i,a[i]);t(a)})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"}),a(t)}))}))},handleCheckAllChange:function(e){var t=this;0==this.checkAll[e]?(this.checkAll[e]=!1,this.checked[e]=[]):1==this.checkAll[e]&&(this.checkAll[e]=!0,this.checked[e]=[],this.list[e].map((function(a){t.checked[e].push(a.uuid)}))),this.isIndeterminate[e]=!1},handleSingleChange:function(e){var t=this.checked[e].length;this.checkAll[e]=t===this.list[e].length,this.isIndeterminate[e]=t>0&&t<this.list[e].length},doExport:function(){},handleConfirm:function(){var e=this,t=Object.values(this.checked).reduce((function(e,t){return e.concat(t)}),[]);this.form.permissionUuids=t,this.$store.dispatch("permission/roleLinkPermissionIsAudit",this.form).then((function(t){var a=e.auditSetting["permission"]?"已提交审核":"已完成";e.$message({type:"success",message:a});var i=e.$route.query.code;e.initDetail({roleCode:i})})).catch((function(t){e.$message({type:"error",message:t||"操作失败"})}))}}},p=h,g=Object(d["a"])(p,i,n,!1,null,null,null);t["default"]=g.exports},"07b5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"single-list-all app-container"},[a("el-card",[a("div",{staticClass:"display-flex"},[a("div",{staticClass:"left",staticStyle:{width:"270px"}},[a("div",{staticClass:"chat-side-bar"},[a("div",{staticClass:"chat-top-warp display-flex align-items-center"},[a("img",{attrs:{src:e.singleLastListAll.avatar,alt:""}}),e._v(" "),a("div",[a("strong",[e._v(e._s(e.singleLastListAll.name))])])]),e._v(" "),a("div",{staticClass:"chat-side-bar-content"},[a("el-tabs",{on:{"tab-click":e.handleClickSideBarTab},model:{value:e.sideTabActiveName,callback:function(t){e.sideTabActiveName=t},expression:"sideTabActiveName"}},[a("div",{staticClass:"side-bar-search flex-between-alinecenter"},["1"==e.sideTabActiveName?a("span",{staticStyle:{"font-size":"13px"}},[e._v("共有"+e._s(e.singleLastListAll.count)+"位好友")]):"2"==e.sideTabActiveName?a("span",{staticStyle:{"font-size":"13px"}},[e._v("共有"+e._s(e.singleLastListAll.friendCount)+"位好友")]):a("span",{staticStyle:{"font-size":"13px"}},[e._v("共有"+e._s(e.singleLastListAll.groupCount)+"个群聊")]),e._v(" "),a("div",{staticStyle:{width:"150px"}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:e.sideBarsearchValue,callback:function(t){e.sideBarsearchValue=t},expression:"sideBarsearchValue"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:e.handleClickSearch},slot:"prefix"})])],1)]),e._v(" "),e._l(e.sideBarTabs,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t.label,name:t.name}},[e.chatSideData&&e.chatSideData.length>0?a("div",[t.name==e.sideTabActiveName?a("ul",{staticClass:"all-chat chat-warp"},e._l(e.chatSideData,(function(i,n){return a("li",{key:n,staticClass:"item display-flex align-items-center",class:{active:e.activeIdx===n},attrs:{item:i},on:{click:function(a){return e.handleSidebarItem(i,n,t)}}},["ROOM"!=i.chatType?a("img",{attrs:{src:e.singleLastListAll.name==i.fromName?i.toAvatar:i.fromAvatar,alt:""}}):a("div",{staticClass:"group-list-left flex-column-center-alinecenter"},[a("svg-icon",{staticClass:"svg-icon",attrs:{"icon-class":"groupChat"}}),e._v(" "),a("p",{staticStyle:{margin:"0px"}},[e._v("群聊")])],1),e._v(" "),a("div",{staticClass:"flex-1"},[a("p",{staticClass:"display-flex justify-content-space-between"},[a("strong",[e._v(e._s(e.singleLastListAll.name==i.fromName?i.toName:i.fromName))]),e._v(" "),a("span",[e._v(e._s(i.msgTime.substr(11)))])]),e._v(" "),"text"==i.type?a("div",{staticClass:"text-over content"},[e._v(e._s(i.content))]):a("div",{staticClass:"text-over content"},[e._v(e._s(e.chatContentType[i.type]))])])])})),0):e._e()]):a("div",{staticClass:"chat-warp no-data"},[e._v("暂无数据")])])}))],2)],1)])]),e._v(" "),a("div",{staticClass:"flex-1"},[a("div",{staticClass:"right"},[a("chat-information",{attrs:{currnetMember:e.currnetMember,name:e.singleLastListAll.name}}),e._v(" "),a("keep-alive",[a("div",{staticClass:"chat-content chat-tab-bar"},[a("el-tabs",{on:{"tab-click":e.handleClickChatType},model:{value:e.chatActiveName,callback:function(t){e.chatActiveName=t},expression:"chatActiveName"}},e._l(e.chatTypeTabs,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t.label,name:t.name}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.singleListAllData.length>0,expression:"singleListAllData.length>0"}],staticStyle:{"overflow-y":"scroll",height:"65vh"}},e._l(e.singleListAllData,(function(t,i){return a("div",{key:i,staticClass:"allChat clearfix"},[a(t.msgType+"Component",{key:i,tag:"component",attrs:{item:t,"to-user-id":e.query.toUserId,"from-user-id":e.query.fromUserId},on:{handleClickViewMore:e.handleClickViewMore}})],1)})),0),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.singleListAllData.length<=0,expression:"singleListAllData.length<=0"}],staticClass:"no-chat-data"},[e._v("暂无数据")])])})),1),e._v(" "),a("customer-pagination",{directives:[{name:"show",rawName:"v-show",value:e.singleListAllData.length>0,expression:" singleListAllData.length>0"}],attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}}),e._v(" "),a("div",{staticClass:"search-form",staticStyle:{"margin-top":"5px"}},[a("chat-search",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1)],1)])],1)])])]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("ac6a"),a("5530")),r=a("2f62"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},o=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"show-more"},[a("ul",e._l(e.transfer.messageMedias,(function(t,i){return a("li",{staticClass:"display-flex"},[a("p",{staticClass:"text-over-2"},[e._v(e._s("text"==t.msgType?t.content:t.fileName+e.chatContentType[t.msgType]))])])})),0)])},u=[],d={props:{transfer:{type:Object,default:function(){}}},data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(r["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},m=d,f=(a("d3d2"),a("2877")),h=Object(f["a"])(m,c,u,!1,null,"e3d5e4c8",null),p=h.exports,g={components:{ShowMoreTemplate:p},data:function(){return{dialogVisible:!1,event:"ShowMoreTemplate",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(r["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("showMore"===this.eventType)return"聊天记录"},close:function(){this.event=""}}},v=g,b=Object(f["a"])(v,l,o,!1,null,null,null),y=b.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat-side-bar"},[a("div",{staticClass:"chat-top-warp display-flex align-items-center"},[a("img",{attrs:{src:e.singleLastListAll.avatar,alt:""}}),e._v(" "),a("div",[a("strong",[e._v(e._s(e.singleLastListAll.name))])])]),e._v(" "),a("div",{staticClass:"chat-side-bar-content"},[a("el-tabs",{on:{"tab-click":e.handleClickSideBarTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("div",{staticClass:"side-bar-search flex-between-alinecenter"},["1"==e.activeName?a("span",{staticStyle:{"font-size":"13px"}},[e._v("共有"+e._s(e.singleLastListAll.count)+"位好友")]):"2"==e.activeName?a("span",{staticStyle:{"font-size":"13px"}},[e._v("共有"+e._s(e.singleLastListAll.friendCount)+"位好友")]):a("span",{staticStyle:{"font-size":"13px"}},[e._v("共有"+e._s(e.singleLastListAll.groupCount)+"个群聊")]),e._v(" "),a("div",{staticStyle:{width:"150px"}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:e.sideBarsearchValue,callback:function(t){e.sideBarsearchValue=t},expression:"sideBarsearchValue"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:e.handleClickSearch},slot:"prefix"})])],1)]),e._v(" "),e._l(e.tabs,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t.label,name:t.name}},[e.chatSideData&&e.chatSideData.length>0?a("div",[t.name==e.activeName?a("ul",{staticClass:"all-chat chat-warp"},e._l(e.chatSideData,(function(i,n){return a("li",{key:n,staticClass:"item display-flex align-items-center",class:{active:e.activeIdx===n},attrs:{item:i},on:{click:function(a){return e.handleSidebarItem(i,n,t)}}},[a("img",{attrs:{src:e.singleLastListAll.name==i.fromName?i.toAvatar:i.fromAvatar,alt:""}}),e._v(" "),a("div",{staticClass:"flex-1"},[a("p",{staticClass:"display-flex justify-content-space-between"},[a("strong",[e._v(e._s(e.singleLastListAll.name==i.fromName?i.toName:i.fromName))]),e._v(" "),a("span",[e._v(e._s(i.msgTime.substr(11)))])]),e._v(" "),(i.type,a("div",{staticClass:"text-over content"},[e._v(e._s(i.content))]))])])})),0):e._e()]):a("div",{staticClass:"chat-warp no-data"},[e._v("暂无数据")])])}))],2)],1)])},C=[],x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("li",{staticClass:"item display-flex align-items-center",class:{active:e.active}},[a("img",{attrs:{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",alt:""}}),e._v(" "),a("div",{staticClass:"flex-1"},[a("p",{staticClass:"display-flex justify-content-space-between"},[a("strong",[e._v(e._s(e.item.name))]),e._v(" "),a("span",[e._v(e._s(e.item.time))])]),e._v(" "),a("div",{staticClass:"text-over"},[e._v(e._s(e.item.content))])])])},$=[],k={props:{item:{type:Object,default:function(){return{}}},active:Boolean},watch:{},data:function(){return{}},mounted:function(){},methods:{}},T=k,w=(a("751d"),Object(f["a"])(T,x,$,!1,null,"adfc983c",null)),S=w.exports,D={name:"chatSideBar",components:{ChatSideBarItem:S},computed:Object(s["a"])({},Object(r["c"])({singleLastListAll:function(e){return e.message.singleLastListAll}})),data:function(){return{activeIdx:0,chatMembers:[],activeName:"1",tabs:[{label:"全部",name:"1"},{label:"单聊",name:"2"},{label:"群聊",name:"3"}],sideBarsearchValue:"",active:"",chatSideData:[]}},created:function(){var e=this;this.chatSideData=this.singleLastListAll.allMessageList,this.singleLastListAll.allMessageList.forEach((function(t,a){e.$route.query.userId==t._id&&(e.activeIdx=a)}))},mounted:function(){console.log(this.activeIdx,"000000000")},methods:{handleClickSideBarTab:function(e){console.log(e.label,"val=="),this.activeIdx=0,"全部"==e.label&&(this.chatSideData=this.singleLastListAll.allMessageList),"单聊"==e.label&&(this.chatSideData=this.singleLastListAll.singleMessageList),"群聊"==e.label&&(this.chatSideData=this.singleLastListAll.groupMessageList)},handleClickSearch:function(){console.log("搜索s")},handleSelect:function(e){console.log(e)},handleSidebarItem:function(e,t,a){this.$emit("handleSidebarItem",e,a),this.activeIdx=t,console.log(e,t,"333",a)}}},E=D,L=(a("62bb"),a("62d8"),Object(f["a"])(E,_,C,!1,null,"1ad1ece6",null)),A=L.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat-info display-flex align-items-center"},["ROOM"!=e.currnetMember.chatType?a("img",{attrs:{src:e.name==e.currnetMember.fromName?e.currnetMember.toAvatar:e.currnetMember.fromAvatar,alt:""}}):a("div",{staticClass:"group-list-left flex-column-center-alinecenter"},[a("svg-icon",{staticClass:"svg-icon",attrs:{"icon-class":"groupChat"}}),e._v(" "),a("p",{staticStyle:{margin:"0px"}},[e._v("群聊")])],1),e._v(" "),a("div",{staticClass:"flex-1"},[a("p",[a("span",[e._v(e._s(e.name==e.currnetMember.fromName?e.currnetMember.toName:e.currnetMember.fromName))]),e._v(" "),a("span",[e._v("@微信")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.currnetMember.toName||e.currnetMember.fromName,expression:"currnetMember.toName || currnetMember.fromName"}]},[e._v("昵称："+e._s(e.name==e.currnetMember.fromName?e.currnetMember.toName:e.currnetMember.fromName))])])])},q=[],O=(a("7f7f"),{props:{currnetMember:{type:Object,default:function(){}},name:String},mounted:function(){console.log(this.currnetMember,"CURR",this.name)}}),I=O,j=(a("0f9d"),Object(f["a"])(I,U,q,!1,null,"1e8ac418",null)),R=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"chat-tab-bar"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabs,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t.label,name:t.name}},[a("div",[e._v("33222")])])})),1),e._v(" "),a("div",{staticClass:"search-form",staticStyle:{"margin-top":"5px"}},[a("chat-search",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1)],1)},M=[],z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",[a("el-input",{staticStyle:{width:"180px"},attrs:{size:"mini",placeholder:"请输入搜索聊天内容"},model:{value:e.query.content,callback:function(t){e.$set(e.query,"content","string"===typeof t?t.trim():t)},expression:"query.content"}},[a("i",{staticClass:"el-input__icon el-icon-search search-icon",attrs:{slot:"prefix"},on:{click:e.handleSearch},slot:"prefix"})])],1),e._v(" "),a("el-form-item",[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{size:"mini",type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-form-item",[a("el-t-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleReport}},[e._v("导出")])],1)],1)},P=[],F={name:"chatSearch",data:function(){return{query:{content:"",startTime:"",endTime:""},value:""}},computed:Object(s["a"])({},Object(r["c"])({})),methods:{handleSelectedTime:function(e){e?(this.query.startTime=this.value[0],this.query.endTime=this.value[1]):(this.query.startTime="",this.query.endTime=""),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleReport:function(){this.$emit("handleReport",this.query)}}},V=F,B=(a("8da0"),Object(f["a"])(V,z,P,!1,null,"fc8fa5c2",null)),G=B.exports,W={components:{ChatSearch:G},data:function(){return{activeName:"all",tabs:[{label:"全部",name:"all"},{label:"文件",name:"file"},{label:"链接",name:"link"},{label:"图片",name:"image"},{label:"视频",name:"video"},{label:"语音",name:"voice"},{label:"视频语音通话",name:"meeting_voice_call"}]}},methods:{handleClick:function(e){console.log(e,"eeeeee"),this.$emit("handleClickChatType",e)},handleSearch:function(e){var t=e.userName,a=e.departmentsUuid,i=e.roleUuid;this.query.userName=t||t,this.query.departmentsUuid=a||a,this.query.roleUuid=i||i,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},resetForm:function(){console.log("重置"),this.searchFrom={keyword:"",planStatu:null}}}},H=W,J=(a("2243"),a("4791"),Object(f["a"])(H,N,M,!1,null,"755b210e",null)),Y=J.exports,X=a("ecfe"),K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"text-component clearfix"},[e.item.toUser==e.toUserId?a("div",{staticClass:"text-left"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticStyle:{"margin-right":"20px","margin-top":"5px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"right"},[a("span",[e._v(e._s(e.item.msgContent))])])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"text-right"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[a("div",{staticStyle:{"margin-right":"20px","margin-top":"5px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"right"},[a("span",[e._v(e._s(e.item.msgContent))])])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},Q=[],Z={name:"TextComponent",props:{item:Object,toUserId:String,fromUserId:String},mounted:function(){}},ee=Z,te=(a("f577"),Object(f["a"])(ee,K,Q,!1,null,"6a1fa652",null)),ae=te.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"image-component"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",[e.item.messageMedias?a("div",{staticClass:"img-warp-left revoke-warp"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[a("img",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.item.messageMedias[0].file}}),e._v(" "),a("img",{staticStyle:{"max-height":"100px","max-width":"150px"},attrs:{slot:"reference",src:e.item.messageMedias[0].file,alt:""},slot:"reference"})])],1):e._e()])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end mb-5"},[e.item.messageMedias?a("div",{staticClass:"img-warp-right revoke-warp"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[a("img",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.item.messageMedias[0].file}}),e._v(" "),a("img",{staticStyle:{"max-height":"100px","max-width":"150px"},attrs:{slot:"reference",src:e.item.messageMedias[0].file,alt:""},slot:"reference"})])],1):e._e(),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},ne=[],se={name:"ImageComponent",props:{item:Object,toUserId:String,fromUserId:String},created:function(){}},re=se,le=(a("e200"),Object(f["a"])(re,ie,ne,!1,null,"5b204556",null)),oe=le.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"emotion-component"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",[e.item.messageMedias?a("div",{staticClass:"img-warp revoke-warp mb-5 ml-20"},[a("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[a("img",{staticStyle:{width:"400px",height:"400px","margin-left":"20px"},attrs:{src:e.item.messageMedias[0].file}}),e._v(" "),a("img",{staticStyle:{"max-height":"100px","max-width":"150px"},attrs:{slot:"reference",src:e.item.messageMedias[0].file,alt:""},slot:"reference"})])],1):e._e()])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end mb-5"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),e.item.messageMedias?a("div",{staticClass:"img-warp revoke-warp mr-20"},[a("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[a("img",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.item.messageMedias[0].file}}),e._v(" "),a("img",{staticStyle:{"max-height":"100px","max-width":"150px"},attrs:{slot:"reference",src:e.item.messageMedias[0].file,alt:""},slot:"reference"})])],1):e._e(),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},ue=[],de={name:"EmotionComponent",props:{item:Object,toUserId:String,fromUserId:String}},me=de,fe=(a("c824"),Object(f["a"])(me,ce,ue,!1,null,"6be5ee8b",null)),he=fe.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"voice-component"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"user-select"},[a("div",{staticClass:"audio-left display-flex align-items-center",style:{width:e.widthPercent+"px"},on:{click:function(t){return e.playAudio(e.item.messageMedias[0].file)}}},[a("span",{staticClass:"play-length"},[e._v(e._s(e.item.messageMedias[0].playLength)+'"')]),e._v(" "),a("i",{staticClass:"play-audio",class:e.isPlayAudio?"el-icon-microphone":"el-icon-turn-off-microphone"})])])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"user-select"},[a("div",{staticClass:"audio-right display-flex align-items-center",style:{width:e.widthPercent+"px"},on:{click:function(t){return e.playAudio(e.item.messageMedias[0].file)}}},[a("span",{staticClass:"play-length"},[e._v(e._s(e.item.messageMedias[0].playLength)+'"')]),e._v(" "),a("i",{staticClass:"play-audio",class:e.isPlayAudio?"el-icon-microphone":"el-icon-turn-off-microphone"})])])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},ge=[],ve=a("ae4c"),be=a.n(ve),ye={name:"VoiceComponent",props:{item:Object,toUserId:String,fromUserId:String},data:function(){return{isPlayAudio:!1}},computed:{widthPercent:function(){return this.item.messageMedias[0].playLength<=2?60:this.item.messageMedias[0].playLength>2&&this.item.messageMedias[0].playLength<30?100:this.item.messageMedias[0].playLength>=30&&this.item.messageMedias[0].playLength<45?150:200}},methods:{playAudio:function(e){var t=this,a=new be.a;a.initWithUrl(e).then((function(){console.log(a.isPlaying(),"rrrr"),a.isPlaying()?(console.log("1"),t.isPlayAudio=!1,a.stop()):(console.log("2"),a.play(),t.isPlayAudio=!0,console.log(a.isPlaying(),"play")),console.log(t.isPlayAudio,"4444",a.isPlaying())})),a.onPlay((function(){console.log("开始播放"),console.log(t.isPlayAudio,"5555")})),a.onStop((function(){console.log("停止播放"),console.log(t.isPlayAudio,"66666")})),a.onEnded((function(){t.isPlayAudio=!1}))}}},_e=ye,Ce=(a("fa3f"),Object(f["a"])(_e,pe,ge,!1,null,"47066176",null)),xe=Ce.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"video-component"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left demo"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",staticStyle:{"object-fit":"fill"},attrs:{playsinline:!0,"x5-video-player-fullscreen":!0,options:e.playerOptions(e.item,1)}})],1)],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[a("div",{staticClass:"demo right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("video-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",staticStyle:{"object-fit":"fill"},attrs:{playsinline:!0,"x5-video-player-fullscreen":!0,options:e.playerOptions(e.item,2)}})],1),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},ke=[],Te={name:"VideoComponent",props:{item:Object,toUserId:String,fromUserId:String},data:function(){return{lPlayerOptions:{playbackRates:[.5,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"video/mp4",src:""}],notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}},rPlayerOptions:{playbackRates:[.5,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"video/mp4",src:""}],notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},methods:{playerOptions:function(e,t){return 1==t?(this.lPlayerOptions.sources[0].src=e.messageMedias[0].file,this.lPlayerOptions):(this.rPlayerOptions.sources[0].src=e.messageMedias[0].file,this.rPlayerOptions)}}},we=Te,Se=(a("ee3d"),Object(f["a"])(we,$e,ke,!1,null,"7b318b84",null)),De=Se.exports,Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"agree-component clearfix"},[e.item.toUserId==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),e._m(0)],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[e._m(1),e._v(" "),a("el-avatar",{attrs:{icon:"el-icon-user-solid"}})],1)]):e._e()])},Le=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"left display-flex justify-content-center"},[a("span",[e._v("对方同意存档会话内容,你可以继续提供服务")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right display-flex justify-content-center align-items-center"},[a("span",[e._v("对方同意存档会话内容,你可以继续提供服务")])])}],Ae={name:"agreeComponent",props:{item:Object,toUserId:String,fromUserId:String}},Ue=Ae,qe=(a("3d4d"),Object(f["a"])(Ue,Ee,Le,!1,null,"8b28ad14",null)),Oe=qe.exports,Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"card-component clearfix"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"card-warp"},[a("div",{staticClass:"card-top"},[a("div",{staticClass:"card--top-left display-flex justify-content-space-between"},[a("div",{staticClass:"display-flex flex-direction-column justify-content-space-between"},[a("p",[e._v(e._s(e.item.messageMedias[0].corpName))]),e._v(" "),a("p",{staticClass:"name"},[e._v(e._s(e.item.messageMedias[0].corpUserName))])]),e._v(" "),a("img",{attrs:{src:e.item.messageMedias[0].corpUserAvatar,alt:""}})])]),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"card-tip"},[e._v("个人名片")])])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"card-warp"},[a("div",{staticClass:"card-top"},[a("div",{staticClass:"card--top-left display-flex justify-content-space-between"},[a("div",{staticClass:"display-flex flex-direction-column justify-content-space-between"},[a("p",[e._v("腾讯")]),e._v(" "),a("p",{staticClass:"name"},[e._v(e._s(e.item.messageMedias[0].corpUserName))])]),e._v(" "),a("img",{attrs:{src:e.item.messageMedias[0].corpUserAvatar,alt:""}})])]),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"card-tip"},[e._v("个人名片")])])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},je=[],Re={name:"CardComponent",props:{item:Object,toUserId:String,fromUserId:String}},Ne=Re,Me=(a("1952"),Object(f["a"])(Ne,Ie,je,!1,null,"6c04d099",null)),ze=Me.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"link-component clearfix"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("a",{attrs:{target:"_blank",href:e.item.messageMedias[0].linkUrl}},[a("div",{staticClass:"link-warp"},[a("div",{staticClass:"title"},[e._v(e._s(e.item.messageMedias[0].title))]),e._v(" "),a("div",{staticClass:"content-warp flex-between-alinecenter"},[a("div",{staticClass:"content"},[a("span",[e._v(e._s(e.item.messageMedias[0].description.split(/\r\n|\n|\r/)[0]))]),e._v(" "),a("p",[e._v(e._s(e.item.messageMedias[0].description.split(/\r\n|\n|\r/)[1]))])]),e._v(" "),a("img",{attrs:{src:e.item.messageMedias[0].imageUrl,alt:""}})])])])])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"right"},[a("a",{attrs:{target:"_blank",href:e.item.messageMedias[0].linkUrl}},[a("div",{staticClass:"link-warp"},[a("div",{staticClass:"title"},[e._v(e._s(e.item.messageMedias[0].title))]),e._v(" "),a("div",{staticClass:"content-warp flex-between-alinecenter"},[a("div",{staticClass:"content"},[a("span",[e._v(e._s(e.item.messageMedias[0].description.split(/\r\n|\n|\r/)[0]))]),e._v(" "),a("p",[e._v(e._s(e.item.messageMedias[0].description.split(/\r\n|\n|\r/)[1]))])]),e._v(" "),a("img",{attrs:{src:e.item.messageMedias[0].imageUrl,alt:""}})])])])])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},Fe=[],Ve={name:"LinkComponent",props:{item:Object,toUserId:String,fromUserId:String}},Be=Ve,Ge=(a("b825"),Object(f["a"])(Be,Pe,Fe,!1,null,"2a551bd4",null)),We=Ge.exports,He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"weaapp-component clearfix"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"weaapp-warp display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"card-warp"},[a("div",{staticClass:"card-top"},[a("div",{staticClass:"weapp-icon"},[a("svg-icon",{attrs:{"icon-class":"xiaochengxu","class-name":"xiaochengxu-icon"}}),e._v(" "),a("span",[e._v(e._s(e.item.messageMedias[0].displayName))])],1),e._v(" "),a("strong",{staticClass:"title"},[e._v(e._s(e.item.messageMedias[0].title))]),e._v(" "),a("div",{staticClass:"des"},[a("span",[e._v(e._s(e.item.messageMedias[0].description))])])]),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"app-type"},[a("svg-icon",{attrs:{"icon-class":"xiaochengxu","class-name":"xiaochengxu-icon"}}),e._v("小程序\n          ")],1)])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"weaapp-warp display-flex justify-content-flex-end"},[a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"card-warp"},[a("div",{staticClass:"card-top"},[a("div",{staticClass:"weapp-icon"},[a("svg-icon",{attrs:{"icon-class":"xiaochengxu","class-name":"xiaochengxu-icon"}}),e._v(" "),a("span",[e._v(e._s(e.item.messageMedias[0].displayName))])],1),e._v(" "),a("strong",{staticClass:"title"},[e._v(e._s(e.item.messageMedias[0].title))]),e._v(" "),a("div",{staticClass:"des"},[a("span",[e._v(e._s(e.item.messageMedias[0].description))])])]),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"app-type"},[a("svg-icon",{attrs:{"icon-class":"xiaochengxu","class-name":"xiaochengxu-icon"}}),e._v("小程序\n          ")],1)])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},Je=[],Ye={name:"CardComponent",props:{item:Object,toUserId:String,fromUserId:String}},Xe=Ye,Ke=(a("3ca3"),Object(f["a"])(Xe,He,Je,!1,null,"02944d82",null)),Qe=Ke.exports,Ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"file-component"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"file-warp",on:{dblclick:function(t){return e.handleDownload(e.item.messageMedias[0].file,e.item.messageMedias[0].fileName,e.item.messageMedias[0].fileExt,e.item.revokeType)}}},[a("div",{staticClass:"file-bg flex-between-alinecenter"},[a("div",[e.item.messageMedias[0].fileName?a("div",{staticClass:"file-name text-over-2"},[e._v(e._s(e.item.messageMedias[0].fileName))]):e._e(),e._v(" "),a("p",{staticClass:"file-size"},[e._v(e._s(e.getFileSize(e.item.messageMedias[0].fileFileSize)))])]),e._v(" "),a("svg-icon",{staticClass:"excel",attrs:{"icon-class":e._f("classFilter")(e.item.messageMedias[0].fileExt)}})],1)])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"right-warp display-flex justify-content-flex-end"},[a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"file-warp",on:{dblclick:function(t){return e.handleDownload(e.item.messageMedias[0].file,e.item.messageMedias[0].fileName,e.item.messageMedias[0].fileExt)}}},[a("div",{staticClass:"file-bg flex-between-alinecenter"},[a("div",[e.item.messageMedias[0].fileName?a("div",{staticClass:"file-name text-over-2"},[e._v(e._s(e.fileNameLength))]):e._e(),e._v(" "),a("p",{staticClass:"file-size"},[e._v(e._s(e.getFileSize(e.item.messageMedias[0].fileFileSize)))])]),e._v(" "),a("svg-icon",{staticClass:"excel",attrs:{"icon-class":e._f("classFilter")(e.item.messageMedias[0].fileExt)}})],1)])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},et=[],tt=(a("96cf"),a("1da1")),at=a("c443"),it={name:"FileComponent",props:{item:Object,toUserId:String,fromUserId:String},computed:{fileNameLength:function(){return this.item.messageMedias[0].fileName.length?this.item.messageMedias[0].fileName.length>25?this.item.messageMedias[0].fileName.substring(0,15)+"..."+this.item.messageMedias[0].fileName.substring(this.item.messageMedias[0].fileName.length-10,this.item.messageMedias[0].fileName.length):this.item.messageMedias[0].fileName:""}},methods:{handleDownload:function(){var e=Object(tt["a"])(regeneratorRuntime.mark((function e(t,a,i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(at["a"])(t).then((function(e){var t=new Blob([e.data],{type:i});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,element.original_name);else{var n=document.createElement("a");n.href=window.URL.createObjectURL(t),n.download=a,n.click(),window.URL.revokeObjectURL(t)}})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})));function t(t,a,i){return e.apply(this,arguments)}return t}(),getFileSize:function(e){var t=e,a="";return a=t<1048576?(t/1024).toFixed(2)+"KB":1048576==t?"1MB":t>1048576&&t<1073741824?(t/1048576).toFixed(2)+"MB":t>1048576&&1073741824==t?"1GB":t>1073741824&&t<1099511627776?(t/1073741824).toFixed(2)+"GB":"文件超过1TB",a}}},nt=it,st=(a("1267"),Object(f["a"])(nt,Ze,et,!1,null,"2662c6b6",null)),rt=st.exports,lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"docmsg-component"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("a",{attrs:{target:"_blank",href:e.item.messageMedias[0].linkUrl}},[a("div",{staticClass:"docmsg-warp"},[e._m(0),e._v(" "),a("div",{staticClass:"docmsg-content flex-between-alinecenter"},[a("div",{staticClass:"content-warp"},[a("span",[e._v("欢迎使用为文档")]),e._v(" "),a("p",[e._v(e._s(e.item.messageMedias[0].docCreatorName))])]),e._v(" "),a("svg-icon",{staticClass:"docmsg-file",attrs:{"icon-class":"wenjian"}})],1)])])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"right-warp display-flex justify-content-flex-end"},[a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("a",{attrs:{target:"_blank",href:e.item.messageMedias[0].linkUrl}},[a("div",{staticClass:"docmsg-warp"},[e._m(1),e._v(" "),a("div",{staticClass:"docmsg-content flex-between-alinecenter"},[e._m(2),e._v(" "),a("svg-icon",{staticClass:"docmsg-file",attrs:{"icon-class":"wenjian"}})],1)])])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},ot=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"docmsg-title display-flex align-items-center"},[a("p",[e._v("W")]),e._v(" "),a("span",[e._v("微文档")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"docmsg-title display-flex align-items-center"},[a("p",[e._v("W")]),e._v(" "),a("span",[e._v("微文档")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-warp"},[a("span",[e._v("欢迎使用为文档")]),e._v(" "),a("p",[e._v("朱余朋")])])}],ct={name:"FileComponent",props:{item:Object,toUserId:String,fromUserId:String},computed:{},methods:{}},ut=ct,dt=(a("03b3"),Object(f["a"])(ut,lt,ot,!1,null,"18685dde",null)),mt=dt.exports,ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"chatrecord-component clearfix"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"chat-record-title"},[e._v(e._s(e.item.title)+"的聊天记录")]),e._v(" "),a("ul",e._l(e.item.messageMedias,(function(t,i){return a("li",{staticClass:"display-flex"},[a("span",[e._v("：")]),e._v(" "),a("p",{staticClass:"text-over-2"},[e._v(e._s("text"==t.msgType?t.content:t.fileName+e.chatContentType[t.msgType]))])])})),0),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.item,expression:"item"}],staticClass:"show-more",on:{click:function(t){return e.handleClickViewMore(e.item)}}},[e._v("查看更多")])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticClass:"chat-record-title"},[e._v(e._s(e.item.title)+"的聊天记录")]),e._v(" "),a("ul",e._l(e.item.messageMedias,(function(t,i){return a("li",{staticClass:"display-flex"},[a("span",[e._v("：")]),e._v(" "),a("p",{staticClass:"text-over-2"},[e._v(e._s("text"==t.msgType?t.content:t.fileName+e.chatContentType[t.msgType]))])])})),0),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.item,expression:"item"}],staticClass:"show-more",on:{click:function(t){return e.handleClickViewMore(e.item)}}},[e._v("查看更多")])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},ht=[],pt={name:"TextComponent",props:{item:Object,toUserId:String,fromUserId:String},computed:Object(s["a"])({},Object(r["c"])({chatContentType:function(e){return e.enum.chatContentType}})),mounted:function(){},methods:{handleClickViewMore:function(e){this.$emit("handleClickViewMore",e)}}},gt=pt,vt=(a("61a7"),Object(f["a"])(gt,ft,ht,!1,null,"e2cc709c",null)),bt=vt.exports,yt=a("fbcb"),_t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"voice-component"},[e.item.toUser==e.toUserId?a("div",{staticClass:"left-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex"},[a("el-avatar",{attrs:{src:e.item.fromAvatar}}),e._v(" "),a("div",{staticClass:"left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticStyle:{height:"42px","background-color":"#fff"}},[a("audio",{staticClass:"audio-warp",attrs:{controls:"",src:e.item.messageMedias[0].file}},[e._v("您的浏览器不支持 audio 元素。")])])])],1)]):e._e(),e._v(" "),e.item.fromUser==e.toUserId?a("div",{staticClass:"right-warp"},[a("p",[e._v(e._s(e.item.msgTime))]),e._v(" "),a("div",{staticClass:"display-flex justify-content-flex-end"},[a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.item.revokeType,expression:"item.revokeType"}],staticClass:"revoke-content"},[e._v("你撤回了一条消息：")]),e._v(" "),a("div",{staticStyle:{height:"42px","background-color":"#fff"}},[a("audio",{staticClass:"audio-warp",attrs:{controls:"",src:e.item.messageMedias[0].file}},[e._v("您的浏览器不支持 audio 元素。")])])]),e._v(" "),a("el-avatar",{attrs:{src:e.item.fromAvatar}})],1)]):e._e()])},Ct=[],xt={name:"VoiceComponent",props:{item:Object,toUserId:String,fromUserId:String},data:function(){return{isPlayAudio:!1}},methods:{playAudio:function(e){var t=this,a=this,i=new be.a;i.initWithUrl(e).then((function(){i.isPlaying()?(a.isPlayAudio=!1,i.stop()):(i.play(),a.isPlayAudio=!0)})),i.onEnded((function(){t.isPlayAudio=!1}))}}},$t=xt,kt=(a("952a"),Object(f["a"])($t,_t,Ct,!1,null,"ac345166",null)),Tt=kt.exports,wt={name:"ListSingleAll",components:{CustomerPagination:X["a"],FormDialog:y,ChatSideBar:A,ChatTabBar:Y,ChatInformation:R,ChatSearch:G,textComponent:ae,imageComponent:oe,emotionComponent:he,voiceComponent:xe,videoComponent:De,agreeComponent:Oe,cardComponent:ze,linkComponent:We,weappComponent:Qe,fileComponent:rt,docmsgComponent:mt,chatrecordComponent:bt,locationComponent:yt["a"],meeting_voice_callComponent:Tt},data:function(){return{currentView:"locationComponent",pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,fromUserId:"",msgType:"all",toUserId:"",content:"",startTime:"",endTime:""},currnetMember:{},chatMembers:[],singleListAllData:[],sideTabActiveName:"1",currentActiveName:"",sideBarTabs:[{label:"全部",name:"1"},{label:"单聊",name:"2"},{label:"群聊",name:"3"}],sideBarsearchValue:"",active:"",chatSideData:[],toUserId:"",fromUserId:"",activeIdx:0,chatActiveName:"all",chatTypeTabs:[{label:"全部",name:"all"},{label:"文件",name:"file"},{label:"链接",name:"link"},{label:"图片",name:"image"},{label:"视频",name:"video"},{label:"语音",name:"voice"},{label:"视频语音通话",name:"meeting_voice_call"}]}},computed:Object(s["a"])({},Object(r["c"])({singleLastListAll:function(e){return e.message.singleLastListAll},singleLastListPage:function(e){return e.message.singleLastListPage},singleListAll:function(e){return e.message.singleListAll},singleListPage:function(e){return e.message.singleListPage},chatContentType:function(e){return e.enum.chatContentType}})),created:function(){var e={type:"externalUser",uuid:this.$route.query.uuid};this.initDataList(e)},mounted:function(){},methods:{initDataList:function(e){var t=this;this.$store.dispatch("message/getMessageSingleLastListAll",e).then((function(e){e&&(t.chatSideData=e.allMessageList,e.allMessageList.forEach((function(e,a){t.$route.query.userId==e._id&&(t.activeIdx=a,t.currnetMember=e)})),t.query.fromUserId=t.singleLastListAll.userId,t.query.toUserId=t.$route.query.userId,t.getsinglelist(t.query).then((function(){})).catch((function(e){console.log(e)})))})).catch((function(e){}))},getsinglelist:function(e){var t=this;this.$store.dispatch("message/getMessageSingleListAll",e).then((function(e){t.singleListAllData=e.item,t.pageConfig.pageNumber=t.singleListPage.pageNumber+1,t.pageConfig.total=t.singleListPage.total})).catch((function(e){console.log(e)}))},handleClickSearch:function(){console.log("搜索s")},handleClickViewMore:function(e){console.log(e,"val===="),this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="showMoreTemplate",this.$refs["formDialog"].eventType="showMore",this.$refs["formDialog"].transfer=e},handleClickSideBarTab:function(e){var t=this;console.log(e.label,"点击侧边栏tab切换"),this.activeIdx=0,this.currentActiveName!=this.sideTabActiveName&&(this.currentActiveName=this.sideTabActiveName,this.$nextTick((function(){t.chatActiveName="all"}))),"全部"==e.label&&this.getChangeSideTabMemberChatData(this.singleLastListAll.allMessageList),"单聊"==e.label&&this.getChangeSideTabMemberChatData(this.singleLastListAll.singleMessageList),"群聊"==e.label&&this.getChangeSideTabMemberChatData(this.singleLastListAll.groupMessageList)},getChangeSideTabMemberChatData:function(e){var t=this;e.length>0?(this.chatSideData=e,e.forEach((function(e,a){t.activeIdx==a&&(t.query.toUserId=e._id,t.currnetMember=e)})),this.query.msgType="all",this.chatActiveName="all",this.query.page=0,this.getsinglelist(this.query)):(this.chatSideData=[],this.singleListAllData=[])},handleSidebarItem:function(e,t,a){var i=this,n={type:"externalUser",uuid:this.$route.query.uuid};this.$store.dispatch("message/getMessageSingleLastListAll",n).then((function(n){n&&("全部"==a.label&&(i.chatSideData=n.allMessageList),"单聊"==a.label&&(i.chatSideData=n.singleMessageList),"群聊"==a.label&&(i.chatSideData=n.groupMessageList),console.log(e,"点击侧边栏用户",t,a),i.activeIdx=t,i.currnetMember=e,i.query.toUserId=e._id,i.getsinglelist(i.query))})).catch((function(e){}))},handleClickChatType:function(){var e=this;if(console.log("点击右侧类型",this.chatActiveName),this.chatSideData.length>0){console.log("有");var t={type:"externalUser",uuid:this.$route.query.uuid};this.$store.dispatch("message/getMessageSingleLastListAll",t).then((function(t){t&&(console.log("3233"),"1"==e.sideTabActiveName&&(e.chatSideData=t.allMessageList),"2"==e.sideTabActiveName&&(e.chatSideData=t.singleMessageList),"3"==e.sideTabActiveName&&(e.chatSideData=t.groupMessageList),e.query.msgType=e.chatActiveName,e.query.page=0,e.getsinglelist(e.query))})).catch((function(e){}))}},handleSearch:function(e){var t=e.content,a=e.startTime,i=e.endTime;this.query.content=t||"",this.query.startTime=a||"",this.query.endTime=i||"",console.log(e,"点击搜索"),this.getsinglelist(this.query)},handleRefresh:function(){console.log("刷新"),this.query=this.$options.data().query,this.getsinglelist(this.query)},resetForm:function(){console.log("重置"),this.searchFrom={keyword:"",planStatu:null}},changeSize:function(e){this.query.size=e,this.getsinglelist(this.query)},changePage:function(e){console.log(e,"点击分页"),this.query.page=e-1,this.pageConfig.pageNumber=e-1;this.chatActiveName;this.getsinglelist(this.query)}}},St=wt,Dt=(a("0143"),a("8885"),Object(f["a"])(St,i,n,!1,null,"a5cc296e",null));t["default"]=Dt.exports},"07d6":function(e,t,a){"use strict";var i=a("5be5"),n=a.n(i);n.a},"0923":function(e,t,a){},"0990":function(e,t,a){},"09cd":function(e,t,a){"use strict";var i=a("f0ec"),n=a.n(i);n.a},"09ed":function(e,t,a){},"0a57":function(e,t,a){"use strict";var i=a("6742"),n=a.n(i);n.a},"0b55":function(e,t,a){"use strict";var i=a("ddfc"),n=a.n(i);n.a},"0c5b":function(e,t,a){},"0cb8":function(e,t,a){},"0e0f1":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditTagConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="access")}}},[e._v("批量通过")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditTagConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="reject")}}},[e._v("批量拒绝")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","default-sort":e.sortConfig,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:e.selectable}}),e._v(" "),a("el-table-column",{attrs:{width:"85",align:"left",label:"提交人"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["UPDATE_ARTICLE"===i.mediaOperationType?a("div",[e._v(e._s(i.approvedOperator.name))]):a("div",[e._v(e._s(i.submitOperator.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"提交时间",prop:"createdAt",sortable:"","sort-orders":["descending","ascending"]}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"素材类型"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.auditAddMedia?a("span",[e._v(e._s(e.mediaType[i.auditAddMedia[0].type]))]):a("span",[e._v(e._s(e.mediaType[i.toMedis[0].type]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"缩略图/内容"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.auditAddMedia?a("div",{staticClass:"thumb-container"},["IMAGE"===i.auditAddMedia[0].type?a("div",{staticClass:"thumb",on:{click:function(t){return e.handleView(e.type="IMAGE",i.auditAddMedia)}}},[a("el-image",{attrs:{fit:"contain",src:"/api/public/file/"+i.auditAddMedia[0].localId}})],1):e._e(),e._v(" "),"VIDEO"===i.auditAddMedia[0].type?a("div",{staticClass:"thumb",on:{click:function(t){return e.handleView(e.type="VIDEO",i.auditAddMedia)}}},[a("video-cover",{attrs:{url:i.auditAddMedia[0].localId}})],1):e._e(),e._v(" "),"TEXT"===i.auditAddMedia[0].type?a("div",{staticClass:"font-no-wrap"},[e._v(e._s(i.auditAddMedia[0].textContents))]):e._e(),e._v(" "),"ARTICLE"===i.auditAddMedia[0].type?a("div",[e._v("《"+e._s(i.auditAddMedia[0].title)+"》")]):e._e(),e._v(" "),"FILE"===i.auditAddMedia[0].type?a("div",[e._v(e._s(i.auditAddMedia[0].fileName))]):e._e()]):a("div",{staticClass:"thumb-container"},["IMAGE"===i.toMedis[0].type?a("div",{staticClass:"thumb",on:{click:function(t){return e.handleView(e.type="IMAGE",i.toMedis)}}},[a("el-image",{attrs:{fit:"contain",src:"/api/public/file/"+i.toMedis[0].localId}})],1):e._e(),e._v(" "),"VIDEO"===i.toMedis[0].type?a("div",{staticClass:"thumb",on:{click:function(t){return e.handleView(e.type="VIDEO",i.toMedis)}}},[a("video-cover",{attrs:{url:i.toMedis[0].localId}})],1):e._e(),e._v(" "),"TEXT"===i.toMedis[0].type?a("div",{staticClass:"font-no-wrap"},[e._v(e._s(i.toMedis[0].content))]):e._e(),e._v(" "),"ARTICLE"===i.toMedis[0].type?a("div",[e._v("《"+e._s(i.toMedis[0].title)+"》")]):e._e(),e._v(" "),"FILE"===i.toMedis[0].type?a("div",[e._v(e._s(i.toMedis[0].fileName))]):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"新增/删除"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",["UPDATE_ARTICLE"===i.mediaOperationType?a("span",{staticClass:"color-primary"},[e._v("修改")]):e._e(),e._v(" "),"ADD_MEDIA"===i.mediaOperationType?a("span",{staticClass:"color-success"},[e._v("新增")]):e._e(),e._v(" "),"DELETE_MEDIA"===i.mediaOperationType?a("span",{staticClass:"color-danger"},[e._v("删除")]):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"leeft",label:"状态",sortable:"",prop:"auditState","sort-method":e.sortMethod,"sort-orders":["ascending","descending",null]},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",["TO_BE_REVIEWED"===i.auditState?a("span",{staticClass:"color-primary"},[e._v("审核中")]):"AUDIT_FAILED"===i.auditState?a("span",{staticClass:"color-danger"},[e._v("已拒绝")]):a("span",{staticClass:"color-success"},[e._v("已通过")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAudit(i.uuid)}}},[e._v("审核")])],1)]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,width:e.width,center:"","destroy-on-close":""},on:{"update:visible":function(t){e.dialogVisible=t}}},["IMAGE"===e.viewMode?a("el-image",{attrs:{src:"/api/public/file/"+e.imageUrl},on:{load:e.onLoad}}):e._e(),e._v(" "),"VIDEO"===e.viewMode?a("video",{ref:"videoPlay",attrs:{width:"600",height:"400",controls:"",src:"/api/public/file/"+e.videoUrl},on:{canplay:e.onCanplay}}):e._e()],1),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("ac6a"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"审批人："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.handlerId,callback:function(t){e.$set(e.query,"handlerId",t)},expression:"query.handlerId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审批状态："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.auditConfirmation,callback:function(t){e.$set(e.query,"auditConfirmation",t)},expression:"query.auditConfirmation"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"提起人："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.submitterId,callback:function(t){e.$set(e.query,"submitterId",t)},expression:"query.submitterId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{handlerId:"",auditConfirmation:"",submitterId:""}}},computed:Object(s["a"])({},Object(o["c"])({userListSelect:function(e){return e.user.listSelect}})),methods:{handleChangeFirst:function(e){this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){this.$emit("handleSearch",this.query)},handleChangeThird:function(e){this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=(a("9daa"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"3746ffc4",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),"destroy-on-close":"",visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},p=[],g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{"label-width":"150px","label-position":"left"}},[e.detail.submitOperator?a("el-form-item",{attrs:{label:"提交人："}},[a("div",{staticClass:"submit-item"},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:e.detail.submitOperator.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n        "+e._s(e.detail.submitOperator.name)+"\n      ")])],1),e._v(" "),a("div",{staticClass:"submit-item"},["TO_BE_REVIEWED"===e.detail.auditState?a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"APPROVED"===e.detail.auditState?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"AUDIT_FAILED"===e.detail.auditState?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e()],1),e._v(" "),a("div",{staticClass:"sumbit-item"},[a("span",{staticClass:"color-info font-exs"},[e._v(e._s(e.detail.updatedAt))])])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"素材："}},["UPDATE_ARTICLE"===e.detail.mediaOperationType?a("div",{staticClass:"media-container"},["ARTICLE"===e.detail.auditAddMedia[0].type?a("div",{staticClass:"article-container"},[a("h3",[e._v(e._s(e.detail.auditAddMedia[0].title))]),e._v(" "),a("div",{staticClass:"font-es",domProps:{innerHTML:e._s(e.detail.articleContent)}})]):e._e()]):e._e(),e._v(" "),"ADD_MEDIA"===e.detail.mediaOperationType?a("div",{staticClass:"media-container"},["IMAGE"===e.detail.auditAddMedia[0].type?a("el-image",{attrs:{fit:"contain",src:"/api/public/file/"+e.detail.auditAddMedia[0].localId}}):e._e(),e._v(" "),"VIDEO"===e.detail.auditAddMedia[0].type?a("video",{staticStyle:{width:"400px",height:"300px"},attrs:{controls:"",src:"/api/public/file/"+e.detail.auditAddMedia[0].localId}}):e._e(),e._v(" "),"TEXT"===e.detail.auditAddMedia[0].type?a("div",{staticClass:"text-container"},[e._v(e._s(e.detail.auditAddMedia[0].textContents))]):e._e(),e._v(" "),"ARTICLE"===e.detail.auditAddMedia[0].type?a("div",{staticClass:"article-container"},[a("h3",[e._v(e._s(e.detail.auditAddMedia[0].title))]),e._v(" "),a("div",{staticClass:"font-es",domProps:{innerHTML:e._s(e.detail.articleContent)}})]):e._e(),e._v(" "),"FILE"===e.detail.auditAddMedia[0].type?a("div",{staticClass:"file-container"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleDownload}},[a("i",{staticClass:"el-icon-document"}),e._v("\n          "+e._s(e.detail.auditAddMedia[0].fileName)+" \n          "),a("i",{staticClass:"el-icon-download"})])],1):e._e()],1):e._e(),e._v(" "),"DELETE_MEDIA"===e.detail.mediaOperationType?a("div",{staticClass:"media-container"},["IMAGE"===e.detail.toMedis[0].type?a("el-image",{attrs:{fit:"contain",src:"/api/public/file/"+e.detail.toMedis[0].localId}}):e._e(),e._v(" "),"VIDEO"===e.detail.toMedis[0].type?a("video",{staticStyle:{width:"400px",height:"300px"},attrs:{controls:"",src:"/api/public/file/"+e.detail.toMedis[0].localId}}):e._e(),e._v(" "),"TEXT"===e.detail.toMedis[0].type?a("div",{staticClass:"text-container"},[e._v(e._s(e.detail.toMedis[0].textContents))]):e._e(),e._v(" "),"ARTICLE"===e.detail.toMedis[0].type?a("div",{staticClass:"article-container"},[a("h3",[e._v(e._s(e.detail.toMedis[0].title))]),e._v(" "),a("div",{staticClass:"font-es",domProps:{innerHTML:e._s(e.detail.articleContent)}})]):e._e(),e._v(" "),"FILE"===e.detail.toMedis[0].type?a("div",{staticClass:"file-container"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleDownload}},[a("i",{staticClass:"el-icon-document"}),e._v("\n          "+e._s(e.detail.toMedis[0].fileName)+" \n          "),a("i",{staticClass:"el-icon-download"})])],1):e._e()],1):e._e()]),e._v(" "),a("el-form-item",{attrs:{label:"标签配置："}},[e.detail.auditAddMedia?a("div",[e.tags.length?a("span",{staticClass:"color-primary font-exs"},[e._v(e._s(e.matchFormat[e.detail.auditAddMedia[0].matchFormat]))]):a("span",{staticClass:"color-primary font-exs"},[e._v("未配置标签")]),e._v(" "),a("icon-tooltip",[a("div",[a("div",{staticClass:"font-exs color-info"},[e._v("包含任意：至少包含一个标签。")]),e._v(" "),a("div",{staticClass:"font-exs color-info"},[e._v("完全匹配：包含全部标签。")])])])],1):e._e(),e._v(" "),e.tags.length?a("tags-drawer",{attrs:{tags:e.tags}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"审批流程："}},[a("div",[a("el-timeline",e._l(e.detail.auditUsers,(function(t){return a("el-timeline-item",{key:t.level},[a("h5",[e._v("\n            "+e._s(t.range?"会签":"或签")+"·\n            "),"finished"===e.checkState(t)?a("span",[e._v("已完成")]):a("span",{staticClass:"color-primary"},[e._v("进行中")])]),e._v(" "),e._l(t.userList,(function(t){return a("div",{key:t.uuid},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n              "+e._s(t.name)+"\n            ")])],1)}))],2)})),1)],1)]),e._v(" "),a("div",{staticClass:"text-align-center"},["TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleAudit(e.action="reject")}}},[e._v("拒绝")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleAudit(e.action="access")}}},[e._v("通过")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]):e._e()],1)],1)},v=[],b=(a("7514"),a("456d"),a("fba9")),y=a("550c8"),_=a("6424"),C=a("1882"),x={inject:["reload"],props:{transfer:{type:Object,default:function(){return{}}}},components:{AsyncUserTag:b["a"],VideoCover:y["a"],TagsDrawer:_["a"],IconTooltip:C["a"]},data:function(){return{form:{name:"",code:"",org:""},detail:{},tags:[],rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{transfer:{handler:function(e,t){this.initData(e.uuid)},immediate:!0,deep:!0}},computed:Object(s["a"])({},Object(o["c"])({auditState:function(e){return e.enum.auditState},matchFormat:function(e){return e.enum.matchFormat},currentUserUuid:function(e){return e.user.uuid}})),mounted:function(){},methods:{initData:function(e){var t=this;this.$store.dispatch("audit/getDetail",e).then((function(e){var a,i;"ADD_MEDIA"===e.mediaOperationType&&(t.detail=Object(s["a"])(Object(s["a"])({},e),{},{auditAddMedia:t.parse(e.auditAddMedia),auditUsers:t.parse(e.auditUsers)}),a=Object.keys(e.toTags).length?e.toTags:t.parse(e.auditAddMedia)[0].tagsDto||[],console.log(a,e.toTags),t.tags=t.grouping(a));if("DELETE_MEDIA"===e.mediaOperationType){t.detail=Object(s["a"])(Object(s["a"])({},e),{},{auditUsers:t.parse(e.auditUsers)}),console.log(e.toMedis);var n=e.toMedis[0].toTags;console.log(n),t.tags=t.groupingDelete(n)}"UPDATE_ARTICLE"===e.mediaOperationType&&(t.detail=Object(s["a"])(Object(s["a"])({},e),{},{auditAddMedia:t.parse(e.auditAddMedia),auditUsers:t.parse(e.auditUsers)}),i=Object.keys(e.toTags).length?e.toTags:t.parse(e.auditAddMedia)[0].tagsDto||[],console.log(i,e.toTags),t.tags=t.grouping(i))})).catch((function(e){console.error(e),t.$message({type:"error",message:e})}))},parse:function(e){return JSON.parse(e)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},grouping:function(e){if(Object.keys(e).length){var t=e.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{groupName:e.tagGroupName,groupId:e.tagGroupId})}));return t.reduce((function(e,t){var a=e.find((function(e){return t.groupId===e.groupId}));if(a)a.tags.push(t);else{var i={groupId:t.tagGroupId,groupName:t.tagGroupName,tags:[t]};e.push(i)}return e}),[])}return[]},groupingDelete:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.groupId===e.groupId}));if(a)a.tags.push(t);else{var i={groupId:t.groupId,groupName:t.groupName,tags:[t]};e.push(i)}return e}),[]):[]},handleAudit:function(e){var t=this,a=this.transfer.uuid,i=null;i="reject"===e?{auditConfirmation:"AUDIT_FAILED",uuids:[a]}:{auditConfirmation:"APPROVED",uuids:[a]},console.log(i),this.$store.dispatch("audit/batchAuditMediaConfirmation",i).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.handleCancel(),t.handleRefresh()}})})).catch((function(e){t.$confirm(e,"错误",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){})).catch((function(e){}))}))},handleRefresh:function(){this.$bus.$emit("handleRefresh")},checkState:function(e){return e.range?e.userList.some((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished":e.userList.every((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished"},currentUserState:function(e){var t=this,a=!1;return e.forEach((function(e){e.userList.forEach((function(e){e.uuid===t.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(a=!0))}))})),a},handleDownload:function(){var e=this.detail.auditAddMedia[0].localId;window.location.href="/api/public/file/".concat(e)}}},$=x,k=(a("e28e"),Object(d["a"])($,g,v,!1,null,"694ecc5f",null)),T=k.exports,w={components:{AuditTemplate:T},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("audit"===this.eventType)return"审核详情"}}},S=w,D=Object(d["a"])(S,h,p,!1,null,null,null),E=D.exports,L=a("8690"),A=a("ecfe"),U={components:{ListHeader:f,FormDialog:E,ToolBar:L["a"],VideoCover:y["a"],CustomerPagination:A["a"]},data:function(){return{width:"",viewMode:"",imageUrl:"",videoUrl:"",dialogVisible:!1,pageConfig:{total:0,pageNumber:0,pageSize:10},sortConfig:{prop:"auditState",order:"ascending"},query:{page:0,size:10,auditConfirmation:"",auditType:"MEDIA",handlerId:"",submitterId:""},selects:[]}},watch:{},computed:Object(s["a"])({},Object(o["c"])({auditStateEnum:function(e){return e.enum.auditState},permissionMap:function(e){return e.permission.permissionMap},auditState:function(e){return e.emnu.auditState},mediaType:function(e){return e.enum.mediaType},loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.auditMediaList},page:function(e){return e.sensitive.auditMediaPage},currentUserUuid:function(e){return e.user.uuid}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/auditMediaListAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleSearch:function(e){var t=e.auditConfirmation,a=e.handlerId,i=e.submitterId;this.query.auditConfirmation=t||this.query.auditConfirmation,this.query.handlerId=a||this.query.handlerId,this.query.submitterId=i||this.query.submitterId,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){console.log(e),this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleView:function(e,t){var a=t[0].localId;"IMAGE"===e?this.imageUrl=a:this.videoUrl=a,this.viewMode=e,this.dialogVisible=!0},parse:function(e){return JSON.parse(e)},handleAudit:function(e){this.$refs["formDialog"].event="AuditTemplate",this.$refs["formDialog"].eventType="audit",this.$refs["formDialog"].transfer={uuid:e},this.$refs["formDialog"].dialogVisible=!0},onLoad:function(e){var t=e.target,a=0;(t.fileSize>0||t.width>1&&t.height>1)&&(a=t.width+40),this.width=a+"px"},onCanplay:function(e){this.width="640px"},selectable:function(e,t){var a=this,i=!1;return e.auditUsers.forEach((function(e){e.userList.forEach((function(e){e.uuid===a.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(i=!0))}))})),"TO_BE_REVIEWED"===e.auditState&&!i},handleBatch:function(e){if(this.selects.length){var t=this.selects,a=null;"reject"===e?(t=this.selects,a={auditConfirmation:"AUDIT_FAILED",uuids:t}):(t=this.selects,a={auditConfirmation:"APPROVED",uuids:t}),this.batchAudit(a)}else this.$message({type:"warning",message:"请至少选择一项"})},batchAudit:function(e){var t=this;this.$store.dispatch("audit/batchAuditMediaConfirmation",e).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.initDataList(t.query)}})})).catch((function(e){t.$message({type:"error",message:e})}))},sortMethod:function(e,t){return"TO_BE_REVIEWED"===e.auditState?-1:"TO_BE_REVIEWED"===t.auditState?1:e.auditState===t.auditState?0:void 0},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},q=U,O=(a("03c4"),a("d6ee"),Object(d["a"])(q,i,n,!1,null,"157cab2a",null));t["default"]=O.exports},"0f9d":function(e,t,a){"use strict";var i=a("1f36"),n=a.n(i);n.a},"0fa3":function(e,t,a){"use strict";var i=a("efe7"),n=a.n(i);n.a},"0fa7":function(e,t,a){},"0fc1":function(e,t,a){"use strict";var i=a("f6bc"),n=a.n(i);n.a},"125c":function(e,t,a){},1267:function(e,t,a){"use strict";var i=a("c6a7"),n=a.n(i);n.a},1396:function(e,t,a){"use strict";var i=a("add0"),n=a.n(i);n.a},"13ec":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"group-sent-message-warp app-container"},[a("el-card",{staticClass:"content-spacing"},[a("div",{staticClass:"group-sent-message-detail"},[a("h4",[e._v("群发详情")]),e._v(" "),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"创建者："}},[a("el-tag",[a("i",{staticClass:"el-icon-user-solid"}),e._v(" "),a("span",[e._v("程开元")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"群发消息1："}},[a("span",[e._v("超盈产品测试01")])]),e._v(" "),a("el-form-item",{attrs:{label:"群发消息2："}},[a("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[a("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.defaultAvatar}}),e._v(" "),a("el-image",{staticStyle:{"max-height":"80px","max-width":"80px"},attrs:{slot:"reference",src:e.defaultAvatar,alt:""},slot:"reference"})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"群发类型："}},[a("span",[e._v("企业微信群发")])]),e._v(" "),a("el-form-item",{attrs:{label:"发送状态："}},[a("span",[e._v("发送成功")])]),e._v(" "),a("el-form-item",{attrs:{label:"发送时间："}},[a("span",[e._v("2020-07-20 10:13:29")])]),e._v(" "),a("p"),e._v(" "),a("el-form-item",{attrs:{label:"群发对象："}},[a("span",[e._v("在陈开元、陆浩然里2个客户")])])],1)],1)]),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",{staticClass:"data-statistics"},[a("h4",[e._v("数据统计")]),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{staticClass:"data-box flex-between-alinecenter text-align-center",attrs:{span:8}},[a("div",{staticClass:"flex-1 border-right"},[a("span",{staticClass:"blod"},[e._v("1 人")]),e._v(" "),a("p",{staticClass:"desc"},[e._v("已发送成员")])]),e._v(" "),a("div",{staticClass:"flex-1"},[a("span",{staticClass:"blod"},[e._v("2 人")]),e._v(" "),a("p",{staticClass:"desc"},[e._v("送达用户")])])]),e._v(" "),a("el-col",{staticClass:"data-box flex-between-alinecenter text-align-center",staticStyle:{margin:"0 20px"},attrs:{span:8}},[a("div",{staticClass:"flex-1 border-right"},[a("span",{staticClass:"blod"},[e._v("0 人")]),e._v(" "),a("p",{staticClass:"desc"},[e._v("未发送成员")])]),e._v(" "),a("div",{staticClass:"flex-1"},[a("span",{staticClass:"blod"},[e._v("0人")]),e._v(" "),a("p",{staticClass:"desc"},[e._v("\n              未送达客户\n              "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",{staticClass:"font-exs"},[e._v("未发送的成员所拥有的所有客户数。")])]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)])]),e._v(" "),a("el-col",{staticClass:"data-box flex-between-alinecenter text-align-center",attrs:{span:8}},[a("div",{staticClass:"flex-1 border-right"},[a("span",{staticClass:"blod"},[e._v("0 人")]),e._v(" "),a("p",{staticClass:"desc"},[e._v("\n              客户接收已达上限\n              "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",{staticClass:"font-exs"},[e._v("单客户一周只能接受任意客服的一条群发，如果超出则发送不成功，记为客户接受已达上限")])]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)]),e._v(" "),a("div",{staticClass:"flex-1"},[a("span",{staticClass:"blod"},[e._v("0 人")]),e._v(" "),a("p",{staticClass:"desc"},[e._v("因不是好友发送失败")])])])],1)],1)]),e._v(" "),a("div",{staticClass:"info-detail-warp display-flex justify-content-space-between"},[a("el-card",{staticClass:"content-spacing flex-1",staticStyle:{"margin-right":"10px"}},[a("div",{staticClass:"member-warp"},[a("h4",[e._v("成员详情")]),e._v(" "),a("div",[a("el-tabs",{on:{"tab-click":e.handleClickMember},model:{value:e.memberActiveName,callback:function(t){e.memberActiveName=t},expression:"memberActiveName"}},e._l(e.memberTabs,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t.label,name:t.name}},[a("div",{staticClass:"total-warp display-flex align-items-center"},[a("i",{staticClass:"el-icon-s-comment",staticStyle:{"margin-right":"5px",color:"#555"}}),e._v(" "),a("strong",[e._v("共"+e._s(e.memberData.length)+"位")])]),e._v(" "),a("member-component",{attrs:{memberData:e.memberData}})],1)})),1)],1)])]),e._v(" "),a("el-card",{staticClass:"content-spacing flex-1"},[a("div",{staticClass:"client-warp"},[a("h4",[e._v("客户详情")]),e._v(" "),a("el-tabs",{on:{"tab-click":e.handleClickClient},model:{value:e.clientActiveName,callback:function(t){e.clientActiveName=t},expression:"clientActiveName"}},e._l(e.clientTabs,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t.label,name:t.name}},[a("div",{staticClass:"total-warp display-flex align-items-center"},[a("i",{staticClass:"el-icon-s-comment",staticStyle:{"margin-right":"5px",color:"#555"}}),e._v(" "),a("strong",[e._v("共"+e._s(e.clientData.length)+"位")])]),e._v(" "),a("client-component",{attrs:{clientData:e.clientData}})],1)})),1)],1)])],1)],1)},n=[],s=a("5530"),r=a("2f62"),l=a("a263"),o=a.n(l),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},m=[],f={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(r["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},h=f,p=a("2877"),g=Object(p["a"])(h,d,m,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},y=[],_=(a("ac6a"),a("456d"),a("7f7f"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(r["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},T=[],w={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(r["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},S=w,D=Object(p["a"])(S,k,T,!1,null,null,null),E=D.exports,L={components:{CreateTemplate:v,EditTemplate:$,DistributeTemplate:E},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(r["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},A=L,U=Object(p["a"])(A,c,u,!1,null,null,null),q=U.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"member-detail-content detail-content flex-col"},[e.memberData.length>0?a("div",e._l(e.memberData,(function(t,i){return a("div",{key:i,staticClass:"detail-content-inner"},[a("div",{staticClass:"no-send-box member-detail-item detail-item"},[a("div",{staticClass:"left display-flex"},[a("img",{staticClass:"avatar-img",attrs:{src:t.img}}),e._v(" "),a("div",{staticClass:"nickname-friends"},[a("div",{staticClass:"nickname display-flex"},[a("h5",[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"fail-send-box display-flex align-items-center"})]),e._v(" "),a("div",{staticClass:"friends"},[a("p",[e._v("共"+e._s(t.length)+"个好友")])])])])])])})),0):a("div",{staticClass:"flex-column-center-alinecenter"},[a("img",{staticStyle:{width:"136px",height:"136px"},attrs:{src:e.noMember,alt:""}}),e._v(" "),a("div",{staticClass:"font-s",staticStyle:{"line-height":"28px"}},[e._v("没有相关客户哦~")])])])},I=[],j={props:{memberData:Array},data:function(){return{noMember:o.a}}},R=j,N=(a("f926"),Object(p["a"])(R,O,I,!1,null,"9d0a857e",null)),M=N.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"client-detail-content"},[e.clientData.length>0?a("div",e._l(e.clientData,(function(t,i){return a("div",{key:i,staticClass:"detail-content-inner"},[a("div",{staticClass:"client-detail-item detail-item flex-between-alinecenter"},[a("div",{staticClass:"left display-flex"},[a("img",{staticClass:"avatar-img",attrs:{src:t.img}}),e._v(" "),a("div",{staticClass:"nickname-friends"},[a("div",{staticClass:"nickname display-flex"},[a("h5",[e._v(e._s(t.name))])]),e._v(" "),a("div",{staticClass:"friends"},[a("el-tag",[e._v("已送达")])],1)])]),e._v(" "),a("div",{staticClass:"send-by-member"},[e._v("通过陈开元发送")])])])})),0):a("div",{staticClass:"flex-column-center-alinecenter"},[a("img",{staticStyle:{width:"136px",height:"136px"},attrs:{src:e.noMember,alt:""}}),e._v(" "),a("div",{staticClass:"font-s",staticStyle:{"line-height":"28px"}},[e._v("没有相关客户哦~")])])])},P=[],F={props:{clientData:Array},data:function(){return{noMember:o.a}}},V=F,B=(a("6adf"),Object(p["a"])(V,z,P,!1,null,"b604f182",null)),G=B.exports,W={components:{EventDialog:q,memberComponent:M,clientComponent:G},data:function(){return{defaultAvatar:o.a,ruleForm:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},pageConfig:{total:0,pageNumber:0,pageSize:10},query:{uuid:""},memberActiveName:"all",memberTabs:[{label:"本次推送全部成员",name:"all"},{label:"已发送成员",name:"1"},{label:"未发送成员",name:"2"},{label:"发送失败",name:"3"}],memberData:[{name:"陈开元",img:"http://wework.qpic.cn/bizmail/VcUTR8AmXd8Eoeicj9SUOGCj7IBTQy5AkgaHzeBJh8jaicxVvicg0v77w/0",length:"13"}],clientActiveName:"all",clientTabs:[{label:"本次推送全部客户",name:"all"},{label:"已送达",name:"1"},{label:"未送达客户",name:"2"},{label:"客户接收达上限",name:"3"},{label:"已不是好友客户",name:"4"}],clientData:[{name:"陈开元",img:"http://wework.qpic.cn/bizmail/VcUTR8AmXd8Eoeicj9SUOGCj7IBTQy5AkgaHzeBJh8jaicxVvicg0v77w/0",length:"13"},{name:"陆浩然",img:" http://wework.qpic.cn/wwhead/duc2TvpEgSTPk74IwG7Bs1CTrX18wQ9JrSmyhm8dh60HicOr3bNBoHaM1mB9iaNXrY99mCXfrFNBE/0",length:"21"}]}},watch:{},computed:Object(s["a"])({},Object(r["c"])({batchSendTaskListAllDetail:function(e){return e.batchSendTask.batchSendTaskListAllDetail},batchAddTaskState:function(e){return e.enum.batchAddTaskState}})),created:function(){this.query.uuid=this.$route.params.uuid,this.initDetail(this.query.uuid)},mounted:function(){console.log(this.batchSendTaskListAllDetail,"batchSendTaskListAllDetail")},beforeUpdate:function(){},updated:function(){},methods:{initDetail:function(e){var t=this;this.$store.dispatch("batchSendTask/getBatchSendTaskDetail",e).then((function(){})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},initBatchSendTaskResult:function(e){var t=this;this.$store.dispatch("getListBatchSendTaskResult",e).then((function(){})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},handleClickMember:function(e,t){console.log(this.memberActiveName,"memberActiveName"),"all"==this.memberActiveName&&(this.memberData=[{name:"陈开元",img:"http://wework.qpic.cn/bizmail/VcUTR8AmXd8Eoeicj9SUOGCj7IBTQy5AkgaHzeBJh8jaicxVvicg0v77w/0",length:"13"}]),1==this.memberActiveName&&(this.memberData=[{name:"陈开元",img:"http://wework.qpic.cn/bizmail/VcUTR8AmXd8Eoeicj9SUOGCj7IBTQy5AkgaHzeBJh8jaicxVvicg0v77w/0",length:"13"}]),2==this.memberActiveName&&(this.memberData=[]),3==this.memberActiveName&&(this.memberData=[])},handleClickClient:function(){"all"==this.clientActiveName&&(this.clientData=[{name:"陈开元",img:"http://wework.qpic.cn/bizmail/VcUTR8AmXd8Eoeicj9SUOGCj7IBTQy5AkgaHzeBJh8jaicxVvicg0v77w/0",length:"13"},{name:"陆浩然",img:" http://wework.qpic.cn/wwhead/duc2TvpEgSTPk74IwG7Bs1CTrX18wQ9JrSmyhm8dh60HicOr3bNBoHaM1mB9iaNXrY99mCXfrFNBE/0",length:"21"}]),1==this.clientActiveName&&(this.clientData=[{name:"陈开元",img:"http://wework.qpic.cn/bizmail/VcUTR8AmXd8Eoeicj9SUOGCj7IBTQy5AkgaHzeBJh8jaicxVvicg0v77w/0",length:"13"},{name:"陆浩然",img:" http://wework.qpic.cn/wwhead/duc2TvpEgSTPk74IwG7Bs1CTrX18wQ9JrSmyhm8dh60HicOr3bNBoHaM1mB9iaNXrY99mCXfrFNBE/0",length:"21"}]),2==this.clientActiveName&&(this.clientData=[]),3==this.clientActiveName&&(this.clientData=[]),4==this.clientActiveName&&(this.clientData=[])}}},H=W,J=(a("fefc"),Object(p["a"])(H,i,n,!1,null,"f589313e",null));t["default"]=J.exports},1409:function(e,t,a){},"142f":function(e,t,a){},"14e8":function(e,t,a){},"15fe":function(e,t,a){},"16c5":function(e,t,a){},1808:function(e,t,a){},1952:function(e,t,a){"use strict";var i=a("8139"),n=a.n(i);n.a},1968:function(e,t,a){"use strict";var i=a("de008"),n=a.n(i);n.a},"19a6":function(e,t,a){},"19f8":function(e,t,a){},"1a10":function(e,t,a){"use strict";var i=a("348f"),n=a.n(i);n.a},"1a2d2":function(e,t,a){"use strict";var i=a("61c2"),n=a.n(i);n.a},"1a6c":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"role-drawer"},[e._l(e.alterRoles,(function(t){return a("el-tag",{key:t.uuid,staticStyle:{"margin-right":"3px"},attrs:{size:"small",type:"info"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v(" "),a("span",{staticClass:"font-exs"},[e._v(e._s(t.name))])])})),e._v(" "),a("div",{staticClass:"text-align-center"},[a("span",{staticClass:"font-exs color-info"},[e._v("共"+e._s(e.total)+"个角色")]),e._v(" "),e.roles.length>2?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.curly=!e.curly}}},[e._v("\n      "+e._s(e.curly?"展开":"收起")+"\n      "),a("i",{class:[e.curly?"el-icon-caret-bottom":"el-icon-caret-top"]})]):e._e()],1)],2)},n=[],s={props:{roles:{type:Array,default:function(){return[]}}},data:function(){return{curly:!1}},watch:{roles:{handler:function(e,t){this.curly=e.length>2},immediate:!0}},computed:{total:function(){return this.roles.length},alterRoles:function(){return this.curly?this.roles.slice(0,2):this.roles}}},r=s,l=(a("3dec"),a("2877")),o=Object(l["a"])(r,i,n,!1,null,"7041a5f7",null);t["a"]=o.exports},"1aa6":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\menu\\listMy\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"1acb":function(e,t,a){"use strict";var i=a("d5a5"),n=a.n(i);n.a},"1b58":function(e,t,a){"use strict";var i=a("839e"),n=a.n(i);n.a},"1b78":function(e,t,a){},"1b90":function(e,t,a){},"1bb4":function(e,t,a){"use strict";var i=a("f04c"),n=a.n(i);n.a},"1ce2":function(e,t,a){"use strict";var i=a("f552"),n=a.n(i);n.a},"1ce7":function(e,t,a){},"1d1a":function(e,t,a){"use strict";var i=a("6238"),n=a.n(i);n.a},"1dad":function(e,t,a){"use strict";var i=a("f5a7"),n=a.n(i);n.a},"1e53":function(e,t,a){},"1e55":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!1}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["media"]["media_addMediaIsAudit"]},on:{click:e.handleCreate}},[e._v("新建文章")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"文章标题",align:"left",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"上传时间",align:"left",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"文章描述",align:"left",prop:"description"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{size:"mini",type:"text",popAuth:!0,auth:e.permissionMap["media"]["media_article_update"]},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.$index)}}},[e._v("编辑")]),e._v(" "),a("el-t-button",{attrs:{size:"mini",type:"text",popAuth:!0,auth:e.permissionMap["media"]["media_browsing_Records"]},on:{click:function(a){return a.stopPropagation(),e.handleRecords(t.$index)}}},[e._v("记录")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)])],1)},n=[],s=(a("96cf"),a("1da1")),r=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"文章名："}},[a("el-input",{model:{value:e.query.title,callback:function(t){e.$set(e.query,"title","string"===typeof t?t.trim():t)},expression:"query.title"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{query:{title:""}}},computed:Object(r["a"])({},Object(c["c"])({})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},d=u,m=(a("721d"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"e66a87c4",null),h=f.exports,p=a("8690"),g=a("ecfe"),v={inject:["reload"],components:{CustomerPagination:g["a"],ListHeader:h,ToolBar:p["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,title:""}}},watch:{},computed:Object(r["a"])({},Object(c["c"])({loading:function(e){return e.media.loading},listAll:function(e){return e.media.articleList},page:function(e){return e.media.page},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query)},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("batchSendTask/getListMy").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getAllUserList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("media/getArticleList",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.title;this.query.title=t||this.query.title,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleCreate:function(){this.$router.push({path:"/media/article/detail/0"})},handleEdit:function(e){var t=this.listAll[e].uuid;this.$router.push({path:"/media/article/detail/"+t})},handleDelete:function(e){var t=this,a=this.listAll[e].uuid;this.$confirm("是否删除当前动态","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("media/deleteMedia",{uuid:a}).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)}))},handleRecords:function(e){var t=this.listAll[e].uuid;this.$router.push({path:"/media/browsingRecords/"+t})},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},b=v,y=(a("b64b"),a("1dad"),Object(m["a"])(b,i,n,!1,null,"76d72f91",null));t["default"]=y.exports},"1f36":function(e,t,a){},"1f7a":function(e,t,a){"use strict";var i=a("ee58"),n=a.n(i);n.a},"213b":function(e,t,a){},"21b1":function(e,t,a){"use strict";var i=a("6970"),n=a.n(i);n.a},"220a":function(e,t,a){"use strict";var i=a("7460"),n=a.n(i);n.a},2243:function(e,t,a){"use strict";var i=a("351f"),n=a.n(i);n.a},"230d":function(e,t,a){"use strict";var i=a("1ce7"),n=a.n(i);n.a},"24c4":function(e,t,a){},"24ec":function(e,t,a){},2522:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!1,msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["batchSendTask"]["batchSendTask_add"],type:"primary"}},[e._v("新建群发")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"id",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.externalUser?a("div",{staticClass:"user-card"},[a("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px"},attrs:{src:t.row.externalUser.avatar,lazy:""}}),e._v(" "),a("span",[e._v(e._s(t.row.externalUser.name))])],1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发送者",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"群发类型",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"内容",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",[a("div",[a("img",{attrs:{width:"128",height:"128",src:e.userDetail.headimgurl}})])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("div",[e._v(e._s(e.userDetail.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("div",[e._v(e._s(e.sex(e.userDetail.gender)))])]),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("div",[a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.isEmpty(e.userDetail.state)?"未指定":e.userDetail.state.name))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("div",[e._v("\n            "+e._s(e.userDetail.role&&e.userDetail.role.name)+"\n          ")])]),e._v(" "),a("el-form-item",{attrs:{label:"公司"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.org)?"未指定":e.userDetail.org.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.department)?"未指定":e.userDetail.department.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"可用"}},[a("div",[e.userDetail.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):a("el-tag",{attrs:{type:"danger"}},[e._v("不可用")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("div",[e._v(e._s(e.userDetail.userinfo&&e.userDetail.userinfo.mobile))])]),e._v(" "),a("el-form-item",{attrs:{label:"国家/地区"}},[e._v(e._s(e.isEmpty(e.userDetail.country)&&e.isEmpty(e.userDetail.city)&&e.isEmpty(e.userDetail.province)?"未设置":e.userDetail.country+e.userDetail.city+e.userDetail.province))]),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},e._l(e.userDetail.events,(function(t){return a("el-button",{key:t,attrs:{type:"primary"},on:{click:function(a){return e.handleEvents(t)}}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作历史",name:"logs",disabled:!e.userDetail.logs.length}},[a("el-scrollbar",[a("el-timeline",{staticClass:"py-3"},e._l(e.userDetail.logs,(function(t){return a("el-timeline-item",{key:t.uuid,attrs:{timestamp:t.createdAt}},[a("div",[e._v("\n                "+e._s(t.operator.nickname)+"\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#E6A23C"}},[e._v("@"+e._s(t.org.name))]),e._v(" "),a("span",{staticClass:"font-sm"},[e._v("执行了")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.event))])])])})),1)],1)],1)],1),e._v(" "),a("EventDialog",{ref:"eventDialog"})],1)},l=[],o=(a("6b54"),a("2f62")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},m=[],f={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},h=f,p=a("2877"),g=Object(p["a"])(h,d,m,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},y=[],_=(a("ac6a"),a("456d"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},T=[],w={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},S=w,D=Object(p["a"])(S,k,T,!1,null,null,null),E=D.exports,L={components:{CreateTemplate:v,EditTemplate:$,DistributeTemplate:E},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},A=L,U=Object(p["a"])(A,c,u,!1,null,null,null),q=U.exports,O={components:{EventDialog:q},data:function(){return{activeType:"detail"}},watch:{},computed:Object(s["a"])({},Object(o["c"])({eventsMap:function(e){return e.stateSettings.eventsMap},userDetail:function(e){return e.userManage.userDetail}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{sex:function(e){return"Gender_Type_Unknown"!=e&&e?"Gender_Type_Female"==e?"女":"Gender_Type_Male"==e?"男":void 0:"未知"},initHandleEvents:function(){},isEmpty:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isEmpty(e)})),handleClose:function(){this.$store.commit("component/TOGGLE_PANEL",!1)},handleEvents:function(e){console.log(this.$refs,e);var t=e;switch(e){case"enable":e="EventEnable";break;case"kick":e="EventKick";break;case"disable":e="EventDisable";break;default:return!1}this.$refs["eventDialog"].event=e,this.$refs["eventDialog"].eventType=t,this.$refs["eventDialog"].dialogVisible=!0},handleConfirm:function(){},initData:function(){}}},I=O,j=Object(p["a"])(I,r,l,!1,null,null,null),R=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"搜索活码名称"}},[a("el-input",{model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},M=[],z={data:function(){return{value:"",query:{name:"",tagIds:"",userId:""}}},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},userListAll:function(e){return e.user.userListAll}})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},P=z,F=Object(p["a"])(P,N,M,!1,null,null,null),V=F.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},G=[],W={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},H=W,J=(a("fd1d"),Object(p["a"])(H,B,G,!1,null,"1ccf6880",null)),Y=J.exports,X={components:{ListHeader:V,UserDetail:R,FormDialog:q,ToolBar:Y},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.batchSendTask.loading},listAll:function(e){return e.batchSendTask.list},page:function(e){return e.batchSendTask.listAllPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query)},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getAllUserList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("batchSendTask/getListMy",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.tagIds,a=e.name;this.query.tagIds=t||this.query.tagIds,this.query.name=a||this.query.name,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)}}},K=X,Q=(a("4f01"),a("c9e8"),Object(p["a"])(K,i,n,!1,null,"33e54a26",null));t["default"]=Q.exports},"25b1":function(e,t,a){"use strict";a.r(t);var i,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"property-listAll app-container"},[a("el-card",[a("div",{staticClass:"basic-information"},[a("h5",[e._v("\n        基本信息\n        "),a("span",{on:{click:e.handleEditBasicInformation}},[a("i",{staticClass:"el-icon-edit-outline"}),e._v(" 修改\n        ")])]),e._v(" "),a("div",{staticClass:"show-info"},[a("p",[e._v("显示的基本信息")]),e._v(" "),a("ul",{staticClass:"display-flex align-items-center"},e._l(e.showInformationData,(function(t,i){return a("li",{key:i,staticClass:"show-info-item display-flex justify-content-center align-items-center"},[a("span",{staticClass:"icon-warp"},[a("i",{staticClass:"el-icon-success color-primary"})]),e._v(" "),a("span",[e._v(e._s(t.name))])])})),0)]),e._v(" "),a("div",{staticClass:"unshow-info"},[a("p",[e._v("不显示的基本信息")]),e._v(" "),a("ul",{staticClass:"display-flex align-items-center"},e._l(e.unshowInformationData,(function(t,i){return a("li",{key:i,staticClass:"show-info-item display-flex justify-content-center align-items-center"},[a("span",[e._v(e._s(t.name))])])})),0)])]),e._v(" "),a("div",{staticClass:"custom-field"},[a("h5",[e._v("自定义字段")]),e._v(" "),a("div",[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus"},on:{click:e.handleAddField}},[e._v("添加")]),e._v(" "),a("ul",e._l(e.propertyListAll,(function(t,i){return a("li",{key:i,staticClass:"custon-field-item display-flex align-items-center"},[a("div",{staticClass:"field"},[a("span",{staticClass:"icon-warp"},[a("i",{staticClass:"el-icon-success color-primary"}),e._v(" "),a("span",[e._v(e._s(t.label))])])]),e._v(" "),a("div",{staticClass:"tool-menu"},[a("el-button",{staticClass:"button-text",attrs:{type:"text"},on:{click:function(a){return e.editField(t)}}},[a("i",{staticClass:"el-icon-edit"}),e._v("修改\n              ")]),e._v(" "),a("el-button",{staticClass:"button-text",attrs:{type:"text"},on:{click:function(a){return e.deleteField(t)}}},[a("i",{staticClass:"el-icon-delete"}),e._v("删除\n              ")]),e._v(" "),a("el-button",{staticClass:"button-text",class:{disabled:0==i},attrs:{type:"text",disabled:0==i},on:{click:function(a){return e.moveUp(t)}}},[a("i",{staticClass:"el-icon-sort-up"}),e._v("上移\n              ")]),e._v(" "),a("el-button",{staticClass:"button-text",class:{disabled:i==e.propertyListAll.length-1},attrs:{type:"text"},on:{click:function(a){return e.moveDown(t)}}},[a("i",{staticClass:"el-icon-sort-down"}),e._v("下移\n              ")])],1)])})),0)],1)])]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},s=[],r=(a("55dd"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},o=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"margin-bottom":"20px"}},[e._v("\n    确认删除【\n    "),a("span",[e._v(e._s(e.transfer.label))]),e._v(" 】？\n  ")]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)])},u=[],d={props:{transfer:{type:Object,default:function(){}}},data:function(){return{uuid:""}},watch:{transfer:{handler:function(e,t){if(console.log(e,"77777"),e){var a=e.uuid;this.uuid=a}},immediate:!0}},methods:{handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleConfirm:function(){var e=this,t={uuid:this.uuid};this.$store.dispatch("externalUser/propertyDelete",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.reload()})).catch((function(e){console.log(e)}))},reload:function(){var e=this;this.$store.dispatch("externalUser/getPropertyListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}},m=d,f=a("2877"),h=Object(f["a"])(m,c,u,!1,null,"32218100",null),p=h.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"字段名称：",prop:"label",rules:e.labelRules}},[a("el-input",{attrs:{placeholder:"请输入字段名称，不超过5个字",maxlength:"5","show-word-limit":""},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"字段类型："}},[a("el-radio-group",{on:{change:e.handleChangeFiledType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:"TEXT"}},[e._v("文本")]),e._v(" "),a("el-radio",{attrs:{label:"SELECT"}},[e._v("选择")])],1)],1),e._v(" "),"SELECT"==e.form.type?a("div",[e._l(e.form.optionList,(function(t,i){return a("el-form-item",{key:i,attrs:{prop:"optionList."+i+".name",rules:e.inputRules}},[a("div",{staticClass:"option-list"},[a("el-input",{ref:"inputFocus",refInFor:!0,staticStyle:{width:"94%","margin-right":"5px"},attrs:{type:"text",placeholder:"选项"+(i+1),maxlength:"15","show-word-limit":""},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"option.name"}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.form.optionList.length>1,expression:"form.optionList.length>1"}],staticClass:"el-icon-remove-outline",on:{click:function(a){return e.delInput(t)}}})],1)])})),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"text"},on:{click:e.addSelect}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加选项\n      ")])],1)],2):e._e(),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleConfirm("form")}}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleCancel("form")}}},[e._v("取消")])],1)],1)},v=[],b=a("2f62"),y={inject:["reload"],data:function(){var e=function(e,t,a){t.trim()?a():a(new Error("选项不能为空格"))};return{hasParent:!1,form:{label:"",type:"TEXT",text:"",optionList:[{name:"",value:"1"}]},labelRules:[{required:!0,message:"请输入字段名称",trigger:"blur"}],inputRules:[{required:!0,message:"*选项不能为空",trigger:"blur"},{validator:e,trigger:["blur","change"]}]}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(r["a"])({},Object(b["c"])({propertyListAll:function(e){return e.externalUser.propertyListAll}})),mounted:function(){},methods:{handleConfirm:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a=0;t.propertyListAll.length>0&&(a=t.propertyListAll[0].sort);var i={};i.label=t.form.label,i.sort=a+1,i.type=t.form.type,"SELECT"==t.form.type&&(i.optionList=t.form.optionList),t.$store.dispatch("externalUser/propertyAdd",i).then((function(){t.$message({type:"success",message:"操作成功"}),t.refresh(),t.handleCancel("form")})).catch((function(e){t.$message({type:"error",message:e})}))}else t.$message({type:"error",message:"请检查输入"})}))},addSelect:function(){this.form.optionList.push({name:"",value:this.form.optionList.length+1+""}),this.focusInput()},focusInput:function(){var e=this;this.$nextTick((function(){e.$refs.inputFocus[e.$refs.inputFocus.length-1].focus()}))},delInput:function(e){var t=this.form.optionList.indexOf(e);t>-1&&this.form.optionList.splice(t,1)},handleCancel:function(e){this.$parent.$parent.dialogVisible=!1,this.$refs[e].resetFields(),this.form=this.$options.data().form},refresh:function(){var e=this;this.$store.dispatch("externalUser/getPropertyListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))},handleChangeFiledType:function(e){"SELECT"===e&&this.$refs.inputFocus[0].focus()}}},_=y,C=(a("220a"),Object(f["a"])(_,g,v,!1,null,"7914dd94",null)),x=C.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[a("div",{staticClass:"tips display-flex"},[a("span",[e._v("说明：")]),e._v(" "),a("div",{staticClass:"content display-flex align-items-center"},[a("span",{staticClass:"display-flex align-items-center"},[a("span",{staticClass:"icon-wrap"},[a("i",{staticClass:"el-icon-success show-icon",staticStyle:{color:"#1890ff","font-size":"16px","margin-right":"5px"}})]),e._v(" "),a("span",{},[e._v("为显示")])]),e._v(" "),a("span",{staticClass:"display-flex align-items-center ml-20"},[a("i",{staticClass:"circle"}),e._v(" "),a("span",[e._v("为不显示")])])])]),e._v(" "),a("div",{staticClass:"basic-info-warp"},[a("el-checkbox-group",{attrs:{size:"mini"},on:{change:e.handleChecked},model:{value:e.checkboxGroup1,callback:function(t){e.checkboxGroup1=t},expression:"checkboxGroup1"}},e._l(e.basicData,(function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.label,border:"",disabled:e.disabledInfo.includes(t.label)}})})),1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleCancel("form")}}},[e._v("取消")])],1)])},k=[],T={props:{transfer:{type:Object,default:function(){}}},data:function(){return{form:{label:""},checkboxGroup1:["性别","姓名"],disabledInfo:["性别","姓名"],basicData:[{label:"性别",uuid:"1"},{label:"姓名",uuid:"1"},{label:"年龄",uuid:"1"},{label:"地址",uuid:"1"},{label:"QQ",uuid:"1"},{label:"邮箱",uuid:"1"},{label:"微博",uuid:"1"}]}},watch:{transfer:{handler:function(e,t){console.log(e,"77777"),e&&(this.uuid=e.uuid,this.form.label=e.label,this.form.type=e.type,"SELECT"==e.type&&(this.form.optionList=JSON.parse(e.options)))},immediate:!0}},computed:Object(r["a"])({},Object(b["c"])({})),mounted:function(){},methods:{handleChecked:function(){console.log(this.checkboxGroup1,"888")},del:function(e,t){return e.filter((function(e){return-1==t.indexOf(e.label)}))},add:function(e,t){return e.filter((function(e){return-1==t.indexOf(e)}))},handleConfirm:function(){var e=this,t=this.basicData.filter((function(t){return e.checkboxGroup1.indexOf(t.label)})),a=this.del(this.basicData,this.checkboxGroup1);console.log(t,"aaaa",a)},handleCancel:function(e){this.$parent.$parent.dialogVisible=!1,this.form=this.$options.data().form,this.$refs[e].resetFields()}}},w=T,S=(a("0fc1"),Object(f["a"])(w,$,k,!1,null,"221b53df",null)),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"字段名称：",prop:"label",rules:e.labelRules}},[a("el-input",{attrs:{placeholder:"请输入字段名称，不超过5个字",maxlength:"5","show-word-limit":""},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"字段类型："}},[a("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{class:{disabled:"TEXT"!=e.form.type},attrs:{label:"TEXT",disabled:"TEXT"!=e.form.type}},[e._v("文本")]),e._v(" "),a("el-radio",{class:{disabled:"SELECT"!=e.form.type},attrs:{label:"SELECT",disabled:"SELECT"!=e.form.type}},[e._v("选择")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"SELECT"==e.form.type,expression:"form.type == 'SELECT'"}]},[e._l(e.form.optionList,(function(t,i){return a("el-form-item",{key:i,attrs:{prop:"optionList."+i+".name",rules:e.inputRules}},[a("div",{staticClass:"option-list"},[a("el-input",{ref:"inputFocus",refInFor:!0,staticStyle:{width:"94%","margin-right":"5px"},attrs:{type:"text",placeholder:"选项"+(i+1),maxlength:"15","show-word-limit":""},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"option.name"}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.form.optionList.length>1,expression:"form.optionList.length>1"}],staticClass:"el-icon-remove-outline",on:{click:function(a){return e.delInput(t)}}})],1)])})),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"text"},on:{click:e.addSelect}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加选项\n      ")])],1)],2),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleCancel("form")}}},[e._v("取消")])],1)],1)},L=[],A={props:{transfer:{type:Object,default:function(){}}},data:function(){var e=function(e,t,a){t.trim()?a():a(new Error("选项不能为空格"))};return{hasParent:!1,form:{label:"",type:"TEXT",optionList:[{name:"",value:"1"}]},labelRules:[{required:!0,message:"请输入字段名称",trigger:"blur"}],inputRules:[{required:!0,message:"*选项不能为空",trigger:"blur"},{validator:e,trigger:["blur","change"]}]}},watch:{transfer:{handler:function(e,t){console.log(e,"77777"),e&&(this.uuid=e.uuid,this.form.label=e.label,this.form.type=e.type,"SELECT"==e.type&&(this.form.optionList=JSON.parse(e.options)))},immediate:!0}},computed:Object(r["a"])({},Object(b["c"])({propertyListAll:function(e){return e.externalUser.propertyListAll}})),mounted:function(){},methods:{handleConfirm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var a={};a.label=e.form.label,"SELECT"==e.form.type&&(a.optionList=e.form.optionList),a.uuid=e.uuid,e.$store.dispatch("externalUser/propertyUpdate",a).then((function(){e.$message({type:"success",message:"操作成功"}),e.refresh(),e.handleCancel("form")})).catch((function(t){e.$message({type:"error",message:t})}))}else e.$message({type:"error",message:"请检查输入"})}))},addSelect:function(){this.form.optionList.push({name:"",value:this.form.optionList.length+1+""}),this.focusInput()},focusInput:function(){var e=this;this.$nextTick((function(){e.$refs.inputFocus[e.$refs.inputFocus.length-1].focus()}))},delInput:function(e){var t=this.form.optionList.indexOf(e);t>-1&&this.form.optionList.splice(t,1)},handleCancel:function(e){this.$parent.$parent.dialogVisible=!1,this.form=this.$options.data().form,this.$refs[e].resetFields()},refresh:function(){var e=this;this.$store.dispatch("externalUser/getPropertyListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}},U=A,q=(a("1968"),Object(f["a"])(U,E,L,!1,null,"176f61f1",null)),O=q.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"字段名称：",prop:"lable",rules:e.labelRules}},[a("el-input",{attrs:{placeholder:"请输入字段名称，不超过5个字",maxlength:"5","show-word-limit":""},model:{value:e.form.lable,callback:function(t){e.$set(e.form,"lable",t)},expression:"form.lable"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"字段类型："}},[a("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:"TEXT"}},[e._v("文本")]),e._v(" "),a("el-radio",{attrs:{label:"SELECT"}},[e._v("选择")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"SELECT"==e.form.type,expression:"form.type == 'SELECT'"}]},[e._l(e.form.optionList,(function(t,i){return a("el-form-item",{key:i,attrs:{prop:"optionList."+i+".value",rules:e.inputRules}},[a("div",{staticClass:"option-list"},[a("el-input",{ref:"inputFocus",refInFor:!0,staticStyle:{width:"94%","margin-right":"5px"},attrs:{type:"text",placeholder:"选项"+(i+1),maxlength:"15","show-word-limit":""},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"option.name"}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.form.optionList.length>1,expression:"form.optionList.length>1"}],staticClass:"el-icon-remove-outline",on:{click:function(a){return e.delInput(t)}}})],1)])})),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"text"},on:{click:e.addSelect}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加选项\n      ")])],1)],2),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleCancel("form")}}},[e._v("取消")])],1)],1)},j=[],R=a("ade3"),N=(i={props:{transfer:{type:Object,default:function(){}}},inject:["reload"],watch:{transfer:{handler:function(e,t){if(console.log(e,"77777"),e){var a=e.uuid;this.uuid=a}},immediate:!0}},data:function(){var e=function(e,t,a){console.log(t,"88888"),t.trim()?a():a(new Error("标签不能为空格"))};return{hasParent:!1,form:{lable:"",type:"TEXT",text:"",optionList:[{name:"",value:"1"}]},labelRules:[{required:!0,message:"请输入字段名称",trigger:"blur"}],inputRules:[{required:!0,message:"*选项不能为空",trigger:"blur"},{validator:e,trigger:["blur","change"]}]}}},Object(R["a"])(i,"watch",{hasParent:{handler:function(e,t){},immediate:!0}}),Object(R["a"])(i,"computed",Object(r["a"])({},Object(b["c"])({}))),Object(R["a"])(i,"mounted",(function(){})),Object(R["a"])(i,"methods",{handleConfirm:function(){var e=this,t=0;this.propertyListAll.length>0&&(t=this.propertyListAll[0].sort);var a={};a.lable=this.form.lable,a.sort=t+1,a.type=this.form.type,"SELECT"==this.form.type&&(a.optionList=this.form.optionList),console.log(a,"payload"),this.$refs["form"].validate((function(t){t?(console.log(a,"77ddd"),e.$store.dispatch("externalUser/propertyAdd",a).then((function(){e.$message({type:"success",message:"操作成功"}),e.refresh(),e.handleCancel()})).catch((function(e){}))):e.$message({type:"error",message:"请检查输入"})}))},addSelect:function(){console.log(this.form.optionList),this.form.optionList.push({name:"",value:this.form.optionList.length+1+""})},delInput:function(e){var t=this.form.optionList.indexOf(e);t>-1&&this.form.optionList.splice(t,1)},handleCancel:function(e){this.$parent.$parent.dialogVisible=!1,this.form=this.$options.data().form,this.$refs[e].resetFields()},refresh:function(){var e=this;this.$store.dispatch("externalUser/getPropertyListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}),i),M=N,z=(a("7f52"),Object(f["a"])(M,I,j,!1,null,null,null)),P=z.exports,F={components:{CreateTemplate:x,EditTemplate:O,DistributeTemplate:P,ConfirmTemplate:p,EditBasicTemplate:D},data:function(){return{dialogVisible:!1,event:"EditTemplate",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(b["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"create"===this.eventType?"添加字段":"edit"===this.eventType?"修改字段":"editBasic"===this.eventType?"基本信息设置":"confirm"===this.eventType?"提示":void 0},close:function(){this.event=""}}},V=F,B=Object(f["a"])(V,l,o,!1,null,null,null),G=B.exports,W={name:"propertyListAll",components:{FormDialog:G},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},showInformationData:[{name:"电话",id:"1"},{name:"地址",id:"2"}],unshowInformationData:[{name:"电话",id:"1"},{name:"地址",id:"2"}],isShow:!1}},computed:Object(r["a"])({},Object(b["c"])({propertyListAll:function(e){return e.externalUser.propertyListAll},propertyListAllPage:function(e){return e.externalUser.propertyListAllPage}})),created:function(){this.initDataList()},methods:{initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getPropertyListAll").then((function(){})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleEditBasicInformation:function(){this.$refs["formDialog"].eventType="editBasic",this.$refs["formDialog"].event="EditBasicTemplate",this.$refs["formDialog"].dialogVisible=!0},handleAddField:function(){this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].dialogVisible=!0},editField:function(e){console.log(e,"item"),this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=e},moveUp:function(e){var t=this,a=this.propertyListAll.indexOf(e);if(console.log(a,"333",e),this.propertyListAll.length>1&&a!=this.propertyListAll.length-1){var i=this.propertyListAll[a-1];console.log(e,"temp",i);var n={sortList:[{propertyUuid:i.uuid,sort:e.sort},{propertyUuid:e.uuid,sort:i.sort}]};this.$store.dispatch("externalUser/propertyUpdatePropertySort",n).then((function(){t.initDataList()})).catch((function(e){console.log(e)}))}},moveDown:function(e){var t=this,a=this.propertyListAll.indexOf(e);if(console.log(a,"333",e),this.propertyListAll.length>1&&a!=this.propertyListAll.length-1){var i=this.propertyListAll[a+1];console.log(e,"temp",i);var n={sortList:[{propertyUuid:i.uuid,sort:e.sort},{propertyUuid:e.uuid,sort:i.sort}]};this.$store.dispatch("externalUser/propertyUpdatePropertySort",n).then((function(){t.initDataList()})).catch((function(e){console.log(e)}))}},deleteField:function(e){console.log(e,"item"),this.$refs["formDialog"].eventType="confirm",this.$refs["formDialog"].event="ConfirmTemplate",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=e}}},H=W,J=(a("efbd"),Object(f["a"])(H,n,s,!1,null,"4d3cfc44",null));t["default"]=J.exports},2622:function(e,t,a){"use strict";var i=a("aaec"),n=a.n(i);n.a},26228:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!1,msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["contactWay"]["contactWay_add"]},on:{click:function(t){return t.stopPropagation(),e.newChannelCode(t)}}},[e._v("新建活码")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"",fit:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"二维码",align:"left"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"40px",height:"40px","margin-right":"10px"},attrs:{src:e.row.qrCode,alt:"",id:"qrcode"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"remark",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"添加好友人数",prop:"joinNumber",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"使用成员",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.serviceUsers,(function(t,i){return a("el-tag",{key:i,staticStyle:{"margin-right":"5px","margin-bottom":"5px"}},[t?a("span",[e._v(e._s(t.name))]):e._e()])}))}}])}),e._v(" "),a("el-table-column",{attrs:{label:"标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.servicesTags,(function(t,i){return a("el-tag",{key:i,staticStyle:{"margin-right":"5px","margin-bottom":"5px"}},[t?a("span",[e._v(e._s(t.tagName))]):e._e()])}))}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{staticClass:"button-s",attrs:{popAuth:!0,auth:e.permissionMap["contactWay"]["contactWay_detail"],type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index,t.row)}}},[e._v("详情")]),e._v(" "),a("el-t-button",{staticClass:"button-s",attrs:{type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.downLoad(t.row)}}},[e._v("下载")]),e._v(" "),a("el-t-button",{staticClass:"button-s",attrs:{popAuth:!0,auth:e.permissionMap["contactWay"]["contactWay_update"],type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-t-button",{staticClass:"button-s",attrs:{popAuth:!0,auth:e.permissionMap["contactWay"]["contactWay_delete"],type:"danger",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"活码名称："}},[a("el-input",{model:{value:e.query.remark,callback:function(t){e.$set(e.query,"remark","string"===typeof t?t.trim():t)},expression:"query.remark"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{query:{remark:""}}},computed:Object(r["a"])({},Object(c["c"])({})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},d=u,m=(a("3a19"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"348916c9",null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","destroy-on-close":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"dialog-detail display-flex"},[a("div",{staticClass:"detail-left"},[a("img",{attrs:{src:e.contactWayDetailRow.qrCode,alt:""}}),e._v(" "),a("p",[e._v(e._s(e.contactWayDetailRow.remark))]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.downLoad(e.contactWayDetailRow)}}},[e._v("下载活码")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(e.contactWayDetailRow)}}},[e._v("修改")])],1),e._v(" "),a("div",{staticClass:"detail-right"},[a("div",{staticClass:"detail-item-title"},[a("span",{staticClass:"item-title"},[e._v("创建时间：")]),e._v(" "),a("span",{staticClass:"date"},[e._v(e._s(e.contactWayDetailRow.createdAt))])]),e._v(" "),a("div",{staticClass:"detail-item-title"},[a("span",{staticClass:"item-title"},[e._v("使用成员：")]),e._v(" "),a("ul",{staticClass:"owner-list"},e._l(e.contactWayDetailRow.serviceUsers,(function(t,i){return a("li",{key:i,staticClass:"owner"},[e._v(e._s(t.name))])})),0)]),e._v(" "),a("div",{staticClass:"detail-item-title"},[a("span",{staticClass:"item-title"},[e._v("客户标签：")]),e._v(" "),a("ul",{staticClass:"tag-list"},e._l(e.contactWayDetailRow.servicesTags,(function(t,i){return a("li",{key:i,staticClass:"tag"},[e._v(e._s(t.tagName))])})),0)]),e._v(" "),a("div",{staticClass:"detail-item-title"},[a("span",{staticClass:"item-title"},[e._v("自动通过好友：")]),e._v(" "),a("span",[e._v(e._s(e.contactWayDetailRow.skipVerify?"全天开启":"时间段"))])])])])])},b=[],y={components:{},data:function(){return{}},watch:{},computed:Object(r["a"])({},Object(c["c"])({contactWayDetailRow:function(e){return e.contactWay.contactWayDetailRow}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{handleEdit:function(e){this.$router.push({path:"/contactWay/detail",query:{way:"edit",uuid:e.uuid}})},downLoad:function(e){console.log(e,"下载"),this.downloadIamge(e.qrCode,e.remark)},downloadIamge:function(e,t){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var i=e.getContext("2d");i.drawImage(a,0,0,a.width,a.height);var n=e.toDataURL("image/png"),s=document.createElement("a"),r=new MouseEvent("click");s.download=t||"photo",s.href=n,s.dispatchEvent(r)},a.src=e}}},_=y,C=(a("dc31"),Object(m["a"])(_,v,b,!1,null,"389f3392",null)),x=C.exports,$={components:{DetailTemplate:x},data:function(){return{dialogVisible:!1,event:"",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"distribute"===this.eventType?"分配部门":"detail"===this.eventType?"渠道详情":void 0}}},k=$,T=Object(m["a"])(k,p,g,!1,null,null,null),w=T.exports,S=a("8690"),D=a("ecfe"),E={components:{ListHeader:h,FormDialog:w,ToolBar:S["a"],CustomerPagination:D["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,remark:""}}},watch:{},computed:Object(r["a"])({},Object(c["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.contactWay.loading},listAll:function(e){return e.contactWay.list},page:function(e){return e.contactWay.listPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query)},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))},initDataList:function(e){var t=this;this.$store.dispatch("contactWay/getList",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total,console.log(t.pageConfig,"pageconfig")})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e,t){this.$refs["formDialog"].event="DetailTemplate",this.$refs["formDialog"].eventType="detail",this.$refs["formDialog"].dialogVisible=!0,this.$store.commit("contactWay/SAVE_CONTACTWAYDETAILROW",t)},downLoad:function(e){console.log(e,"下载"),this.downloadIamge(e.qrCode,e.remark)},downloadIamge:function(e,t){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var i=e.getContext("2d");i.drawImage(a,0,0,a.width,a.height);var n=e.toDataURL("image/png"),s=document.createElement("a"),r=new MouseEvent("click");s.download=t||"photo",s.href=n,s.dispatchEvent(r)},a.src=e},handleSearch:function(e){var t=e.remark;this.query.remark=t||this.query.remark,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},newChannelCode:function(){this.$router.push({path:"/contactWay/detail"})},handleEdit:function(e){this.$router.push({path:"/contactWay/detail",query:{uuid:e.uuid}})},handleDelete:function(e){var t=this;this.$confirm("删除后不可恢复, 确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i={configId:e.configId},t.$store.dispatch("contactWay/deleteContactWay",i).then((function(){t.$message({type:"success",message:"删除成功!"}),t.initDataList(t.query)})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消"})}))},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},L=E,A=(a("03ec"),a("09cd"),Object(m["a"])(L,i,n,!1,null,"45c04502",null));t["default"]=A.exports},2783:function(e,t,a){},2792:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!0,hasImport:!1,hasRefresh:!0,msg:"共条"+e.total+"数据"},on:{handleRefresh:e.initDataList}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{size:"small",popAuth:!0,type:"primary",auth:e.permissionMap["department"]["department_add"]},on:{click:e.handleCreate}},[e._v("创建部门")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.departmentList,"row-key":"uuid",lazy:"","default-expand-all":"","tree-props":{children:"children"},"header-row-class-name":"el-table-header"},on:{"row-click":e.handleDetail}},[a("el-table-column",{attrs:{label:"名称",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n              "+e._s(i.name)+"\n              "),a("span",{staticStyle:{"margin-left":"20px"}},[a("el-tag",{attrs:{size:"small",type:"info"}},[e._v(e._s(e.orgType[i.type]))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",auth:e.permissionMap["department"]["department_update"],popAuth:!0},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("el-t-button",{attrs:{type:"text",auth:e.permissionMap["department"]["department_delete"],popAuth:!0,size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",[a("div",[a("img",{attrs:{width:"128",height:"128",src:e.userDetail.headimgurl}})])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("div",[e._v(e._s(e.userDetail.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("div",[e._v(e._s(e.sex(e.userDetail.gender)))])]),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("div",[a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.isEmpty(e.userDetail.state)?"未指定":e.userDetail.state.name))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("div",[e._v("\n            "+e._s(e.userDetail.role&&e.userDetail.role.name)+"\n          ")])]),e._v(" "),a("el-form-item",{attrs:{label:"公司"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.org)?"未指定":e.userDetail.org.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.department)?"未指定":e.userDetail.department.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"可用"}},[a("div",[e.userDetail.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):a("el-tag",{attrs:{type:"danger"}},[e._v("不可用")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("div",[e._v(e._s(e.userDetail.userinfo&&e.userDetail.userinfo.mobile))])]),e._v(" "),a("el-form-item",{attrs:{label:"国家/地区"}},[e._v(e._s(e.isEmpty(e.userDetail.country)&&e.isEmpty(e.userDetail.city)&&e.isEmpty(e.userDetail.province)?"未设置":e.userDetail.country+e.userDetail.city+e.userDetail.province))]),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},e._l(e.userDetail.events,(function(t){return a("el-button",{key:t,attrs:{type:"primary"},on:{click:function(a){return e.handleEvents(t)}}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作历史",name:"logs",disabled:!e.userDetail.logs.length}},[a("el-scrollbar",[a("el-timeline",{staticClass:"py-3"},e._l(e.userDetail.logs,(function(t){return a("el-timeline-item",{key:t.uuid,attrs:{timestamp:t.createdAt}},[a("div",[e._v("\n                "+e._s(t.operator.nickname)+"\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#E6A23C"}},[e._v("@"+e._s(t.org.name))]),e._v(" "),a("span",{staticClass:"font-sm"},[e._v("执行了")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.event))])])])})),1)],1)],1)],1),e._v(" "),a("EventDialog",{ref:"eventDialog"})],1)},o=[],c=(a("6b54"),a("2f62")),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,center:"","append-to-body":"",width:"600px","destroy-on-close":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},d=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"process-container"},["COMPLEX"==e.mode?a("el-steps",{attrs:{active:e.process[e.mode],"align-center":""}},[a("el-step",{attrs:{title:"基础信息",description:""}}),e._v(" "),a("el-step",{attrs:{title:"关联企微",description:""}}),e._v(" "),a("el-step",{attrs:{title:"角色配置",description:""}}),e._v(" "),a("el-step",{attrs:{title:"审核通知人",description:""}})],1):e._e(),e._v(" "),"SIMPLE"==e.mode?a("el-steps",{attrs:{active:e.process[e.mode],"align-center":""}},[a("el-step",{attrs:{title:"基础信息",description:""}}),e._v(" "),a("el-step",{attrs:{title:"角色配置",description:""}}),e._v(" "),a("el-step",{attrs:{title:"审核通知人",description:""}})],1):e._e(),e._v(" "),"NONE"==e.mode?a("el-steps",{attrs:{active:e.process[e.mode],"align-center":""}},[a("el-step",{attrs:{title:"基础信息",description:""}}),e._v(" "),a("el-step",{attrs:{title:"审核通知人",description:""}})],1):e._e()],1),e._v(" "),a("transition-group",{attrs:{name:"fade-transform"}},[1==e.process[e.mode]?a("el-form",{key:"form",ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},["DEPT"!==e.form.type?a("el-form-item",{attrs:{label:"新建方式"}}):e._e(),e._v(" "),"DEPT"!==e.form.type?a("div",{staticStyle:{"margin-bottom":"20px"}},[a("div",{staticClass:"radio-container"},[a("div",{staticClass:"radio-item"},[a("el-radio",{attrs:{label:"SIMPLE"},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},[a("span",{staticClass:"title"},[e._v("上级所在的企业微信中添加")]),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"radio-tips"},[e._v("在上级所在的企业微信中，直接创建新的组织或部门")])])],1),e._v(" "),a("div",{staticClass:"radio-item"},[a("el-radio",{attrs:{label:"COMPLEX"},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},[a("span",{staticClass:"title"},[e._v("以新的企业微信号关联")]),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"radio-tips"},[e._v("若新建的组织或部门已有自己的企业微信账号，请选择该方式进行关联。同时该企业微信管理员需要参考文档对该企业微信后台进行配置。")])])],1)])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"上级",prop:"parentUuid"}},[a("el-select-tree",{attrs:{"default-expand-all":!0,multiple:!1,placeholder:"请选择组织/部门","popover-min-width":100,data:e.departmentList,props:{value:"uuid",children:"children",label:"name"},"check-strictly":!0},model:{value:e.form.parentUuid,callback:function(t){e.$set(e.form,"parentUuid",t)},expression:"form.parentUuid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"创建类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.orgTypes,(function(e){return a("el-option",{key:e.code,attrs:{label:e.label,value:e.code}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1)],1):e._e(),e._v(" "),2==e.process["COMPLEX"]?a("el-form",{key:"formNext",ref:"formNext",attrs:{model:e.formNext,rules:e.rulesNext,"label-width":"150px","label-position":"left"}},[a("el-form-item",{attrs:{label:"通讯录EncodingAESKey"}},[a("el-input",{model:{value:e.formNext.addressBookEncodingAESKey,callback:function(t){e.$set(e.formNext,"addressBookEncodingAESKey","string"===typeof t?t.trim():t)},expression:"formNext.addressBookEncodingAESKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"通讯录应用secret"}},[a("el-input",{model:{value:e.formNext.addressBookSecret,callback:function(t){e.$set(e.formNext,"addressBookSecret","string"===typeof t?t.trim():t)},expression:"formNext.addressBookSecret"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"通讯录token"}},[a("el-input",{model:{value:e.formNext.addressBookToken,callback:function(t){e.$set(e.formNext,"addressBookToken","string"===typeof t?t.trim():t)},expression:"formNext.addressBookToken"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主应用id"}},[a("el-input",{model:{value:e.formNext.chaoyingAgentId,callback:function(t){e.$set(e.formNext,"chaoyingAgentId","string"===typeof t?t.trim():t)},expression:"formNext.chaoyingAgentId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主应用secret"}},[a("el-input",{model:{value:e.formNext.chaoyingAgentSecret,callback:function(t){e.$set(e.formNext,"chaoyingAgentSecret","string"===typeof t?t.trim():t)},expression:"formNext.chaoyingAgentSecret"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"CorpId"}},[a("el-input",{model:{value:e.formNext.corpId,callback:function(t){e.$set(e.formNext,"corpId","string"===typeof t?t.trim():t)},expression:"formNext.corpId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"外部联系人EncodingAESKey"}},[a("el-input",{model:{value:e.formNext.externalUserEncodingAESKey,callback:function(t){e.$set(e.formNext,"externalUserEncodingAESKey","string"===typeof t?t.trim():t)},expression:"formNext.externalUserEncodingAESKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户应用secret"}},[a("el-input",{model:{value:e.formNext.externalUserSecret,callback:function(t){e.$set(e.formNext,"externalUserSecret","string"===typeof t?t.trim():t)},expression:"formNext.externalUserSecret"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"外部联系人token"}},[a("el-input",{model:{value:e.formNext.externalUserToken,callback:function(t){e.$set(e.formNext,"externalUserToken","string"===typeof t?t.trim():t)},expression:"formNext.externalUserToken"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"会话存档secret"}},[a("el-input",{model:{value:e.formNext.messageArchiveSecret,callback:function(t){e.$set(e.formNext,"messageArchiveSecret","string"===typeof t?t.trim():t)},expression:"formNext.messageArchiveSecret"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"消息加密"}},[a("el-input",{model:{value:e.formNext.msgSeq,callback:function(t){e.$set(e.formNext,"msgSeq","string"===typeof t?t.trim():t)},expression:"formNext.msgSeq"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级的uuid"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formNext.parentUuid,callback:function(t){e.$set(e.formNext,"parentUuid","string"===typeof t?t.trim():t)},expression:"formNext.parentUuid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"会话存档私钥"}},[a("el-input",{model:{value:e.formNext.privateKey,callback:function(t){e.$set(e.formNext,"privateKey","string"===typeof t?t.trim():t)},expression:"formNext.privateKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"侧边栏url"}},[a("el-input",{model:{value:e.formNext.sidebarUrl,callback:function(t){e.$set(e.formNext,"sidebarUrl","string"===typeof t?t.trim():t)},expression:"formNext.sidebarUrl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预设超级管理员的userid"}},[a("el-input",{model:{value:e.formNext.superUserId,callback:function(t){e.$set(e.formNext,"superUserId","string"===typeof t?t.trim():t)},expression:"formNext.superUserId"}})],1)],1):e._e(),e._v(" "),2==e.process["NONE"]||3==e.process["SIMPLE"]||4==e.process["COMPLEX"]?a("el-form",{key:"formNext",ref:"formNext",attrs:{model:e.formNext,rules:e.rulesNext,"label-width":"150px","label-position":"left"}},[a("el-form-item",{attrs:{label:"通知审核人"}}),e._v(" "),a("complex-select",{attrs:{options:e.departmentList},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1):e._e(),e._v(" "),2==e.process["SIMPLE"]||3==e.process["COMPLEX"]?a("el-form",{key:"formRole",ref:"formRole",attrs:{model:e.formRole,roles:e.rulesRole,"label-position":"left","label-width":"150px"}},[a("el-form-item",{attrs:{label:"角色模板"}},[a("el-select",{attrs:{multiple:""},model:{value:e.formRole.roleUuidSet,callback:function(t){e.$set(e.formRole,"roleUuidSet",t)},expression:"formRole.roleUuidSet"}},e._l(e.roleTemplates,(function(e){return a("el-option",{key:e.uuid,attrs:{value:e.uuid,label:e.name}})})),1)],1)],1):e._e()],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handlePrev}},[e._v(e._s(1==e.process[e.mode]?"取消":"返回"))]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfirm}},[e._v(e._s(4==e.process["COMPLEX"]||3==e.process["SIMPLE"]||2==e.process["NONE"]?"确定":"下一步"))])],1)],1)},f=[],h=a("8cbb"),p={inject:["reload"],components:{ComplexSelect:h["a"]},data:function(){return{process:{SIMPLE:1,COMPLEX:1,NONE:1},mode:"NONE",orgTypes:[{code:"BRANCH",label:"分公司"},{code:"BUSINESS",label:"营业部"},{code:"DEPT",label:"普通部门"}],selects:[],form:{name:"",orgNode:!1,parentUuid:"",type:"DEPT"},formNext:{addressBookEncodingAESKey:"",addressBookSecret:"",addressBookToken:"",chaoyingAgentId:"",chaoyingAgentSecret:"",corpId:"",externalUserEncodingAESKey:"",externalUserSecret:"",externalUserToken:"",messageArchiveSecret:"",msgSeq:"",parentUuid:"",privateKey:"",sidebarUrl:"",superUserId:""},formRole:{roleUuidSet:[]},rulesNext:{},type:"WX",types:[{code:"WX",label:"分公司/营业部"},{code:"NORMAL",label:"部门"}],rulesRole:{},rules:{parentUuid:[{required:!0,message:"请选择上级部门",trigger:"blur"}],name:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{"form.type":{handler:function(e,t){console.log(e),"DEPT"==e&&(this.form.orgNode=!1,this.mode="NONE"),"BRANCH"==e&&(this.form.orgNode=!0,this.mode="SIMPLE"),"BUSINESS"==e&&(this.form.orgNode=!0,this.mode="SIMPLE")},immediate:!0},parentUuid:{handler:function(e,t){this.formNext.parentUuid=e},immediate:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({listSelect:function(e){return e.department.listSelect},departmentList:function(e){return e.department.departmentList},roleTemplates:function(e){return e.roleTemplate.listAll}})),{},{parentUuid:function(){return this.form.parentUuid}}),created:function(){this.initData()},mounted:function(){},methods:{initData:function(){this.$store.dispatch("roleTemplate/getListAll").then((function(){})).catch((function(e){console.error(e)}))},handlePrev:function(){1==this.process[this.mode]&&this.handleCancel(),1==this.process["COMPLEX"]&&1==this.process["SIMPLE"]&&1==this.process["NONE"]||this.process[this.mode]--},handleConfirm:function(){var e=this;if(4==this.process["COMPLEX"]||3==this.process["SIMPLE"]||2==this.process["NONE"]){if("NONE"==this.mode){var t=Object(r["a"])({},this.form);console.log("create normal department"),this.$store.dispatch("department/addDepartment",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}if("SIMPLE"==this.mode){var a=this.formRole.roleUuidSet,i=Object(r["a"])(Object(r["a"])({},this.form),{},{roleUuidSet:a});this.$store.dispatch("department/addDepartment",i).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.reload()})).catch((function(t){e.$message({type:"error",message:t})})),console.log("create nomal branch & business")}if("COMPLEX"==this.mode){var n=this.formRole.roleUuidSet,s=this.form,l=s.type,o=s.parentUuid,c=Object(r["a"])({type:l,parentUuid:o,roleUuidSet:n},this.formNext);console.log(c),this.$store.dispatch("department/addWxDepartment",c).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.reload()})).catch((function(t){e.$message({type:"error",message:t})})),console.log("create new wx branch & business")}}4!=this.process["COMPLEX"]&&3!=this.process["SIMPLE"]&&2!=this.process["NONE"]&&(1==this.process[this.mode]?this.$refs["form"].validate((function(t){t?e.process[e.mode]++:e.$message({type:"error",message:"请检查输入"})})):this.process[this.mode]++)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleConfirmNext:function(){var e=this,t=this.formNext;this.$refs["formNext"].validate((function(a){a?(console.log(t),e.$store.dispatch("department/addWxDepartment",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.reload()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},refresh:function(){var e=this;this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}},g=p,v=(a("86b5"),a("2877")),b=Object(v["a"])(g,m,f,!1,null,"5447030e",null),y=b.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-select-tree",{attrs:{"default-expand-all":!0,multiple:!1,placeholder:"请选择组织/部门","popover-min-width":100,data:e.departmentList,props:{value:"uuid",children:"children",label:"name"},"check-strictly":!0},model:{value:e.form.parentUuid,callback:function(t){e.$set(e.form,"parentUuid",t)},expression:"form.parentUuid"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},C=[],x=(a("7f7f"),{data:function(){return{form:{name:"",parentUuid:1,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currentDepartment:{handler:function(e,t){e&&(console.log(e),this.initData())},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({currentDepartment:function(e){return e.department.currentDepartment},listSelect:function(e){return e.department.listSelect},departmentList:function(e){return e.department.departmentList}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment,t=e.name,a=e.uuid,i=this.currentDepartment.parent.uuid;this.form.name=t,this.form.parentUuid=i,this.form.uuid=a},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("department/updateDepartment",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新");var t=this.$route.params.org;this.$store.dispatch("department/getDepartmentListAll",t).then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}}),$=x,k=Object(v["a"])($,_,C,!1,null,null,null),T=k.exports,w={components:{CreateTemplate:y,EditTemplate:T},data:function(){return{dialogVisible:!1,event:"CreateTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"create"===this.eventType?"创建模板":"edit"===this.eventType?"编辑模板":void 0}}},S=w,D=Object(v["a"])(S,u,d,!1,null,null,null),E=D.exports,L={components:{EventDialog:E},data:function(){return{activeType:"detail"}},watch:{},computed:Object(r["a"])({},Object(c["c"])({eventsMap:function(e){return e.stateSettings.eventsMap},userDetail:function(e){return e.userManage.userDetail}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{sex:function(e){return"Gender_Type_Unknown"!=e&&e?"Gender_Type_Female"==e?"女":"Gender_Type_Male"==e?"男":void 0:"未知"},initHandleEvents:function(){},isEmpty:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isEmpty(e)})),handleClose:function(){this.$store.commit("component/TOGGLE_PANEL",!1)},handleEvents:function(e){console.log(this.$refs,e);var t=e;switch(e){case"enable":e="EventEnable";break;case"kick":e="EventKick";break;case"disable":e="EventDisable";break;default:return!1}this.$refs["eventDialog"].event=e,this.$refs["eventDialog"].eventType=t,this.$refs["eventDialog"].dialogVisible=!0},handleConfirm:function(){},initData:function(){}}},A=L,U=Object(v["a"])(A,l,o,!1,null,null,null),q=U.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"员工姓名"}},[a("el-input",{model:{value:e.query.userName,callback:function(t){e.$set(e.query,"userName","string"===typeof t?t.trim():t)},expression:"query.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在部门"}},[a("el-select",{on:{change:e.handleChangeSecond},model:{value:e.query.departments,callback:function(t){e.$set(e.query,"departments",t)},expression:"query.departments"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"员工角色"}},[a("el-select",{on:{change:e.handleChangeThird},model:{value:e.query.roleUuid,callback:function(t){e.$set(e.query,"roleUuid",t)},expression:"query.roleUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},I=[],j={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{userName:"",departmentsUuid:"",roleUuid:""}}},computed:Object(r["a"])({},Object(c["c"])({userListAll:function(e){return e.user.userListAll},roleList:function(e){return e.role.roleList},departments:function(e){return e.department.departments}})),methods:{handleChangeFirst:function(e){this.$bus.$emit("changeSelect",{handlerId:e})},handleChangeSecond:function(e){this.$bus.$emit("changeSelect",{auditConfirmation:e})},handleChangeThird:function(e){this.$bus.$emit("changeSelect",{submitterId:e})},handleSearch:function(){this.$bus.$emit("handleSearch")},handleRefresh:function(){this.$bus.$emit("handleRefresh"),this.query=this.$options.data().query}}},R=j,N=Object(v["a"])(R,O,I,!1,null,null,null),M=N.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},P=[],F={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},V=F,B=(a("07d6"),Object(v["a"])(V,z,P,!1,null,"534c657e",null)),G=B.exports,W=a("0a9e"),H={components:{ListHeader:M,UserDetail:q,FormDialog:E,ToolBar:G,Cascader:W["a"]},data:function(){return{total:0}},watch:{},computed:Object(r["a"])({},Object(c["c"])({departmentList:function(e){return e.department.departmentList},loading:function(e){return e.department.loading},orgType:function(e){return e.enum.orgType},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList()},mounted:function(){var e=this;this.$bus.$on("showFormDialog",(function(t){e.$refs["formDialog"].event="CreateTemplate",e.$refs["formDialog"].eventType="create",e.$refs["formDialog"].dialogVisible=!0}))},beforeDestroy:function(){this.$bus.$off("showFormDialog")},methods:{handleClick:function(e,t){t.stopPropagation(),this.handleDelete(e.uuid),alert("点击")},handleRowClick:function(e){this.$store.commit("department/SAVE_DETAIL",e),this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0},sortChange:function(e){this.initDataList()},pageChange:function(){this.initDataList()},initFilter:function(){var e=this;this.$store.dispatch("department/getDepartmentListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))},initDataList:function(){var e=this;this.$store.dispatch("department/getDepartmentListAll").then((function(t){var a=t.total;e.total=a})).catch((function(t){e.$message({type:"error",message:t})}))},handleEdit:function(e,t){this.$store.commit("department/SAVE_DETAIL",t),this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0},handleDelete:function(e){var t=this;console.log(e.uuid);var a=e.uuid,i={uuid:a};this.$confirm("是否删除当前部门","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("department/deleteDepartment",i).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleDetail:function(){},handleCreate:function(){this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].dialogVisible=!0}}},J=H,Y=(a("b94e"),Object(v["a"])(J,i,n,!1,null,null,null));t["default"]=Y.exports},2836:function(e,t,a){},"294b":function(e,t,a){},"2a60":function(e,t,a){"use strict";var i=a("2c9a"),n=a.n(i);n.a},"2b10":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!0,hasImport:!1},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("span",{staticClass:"font-l"},[e._v(e._s(e.corpInfo.name))]),e._v(" "),a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["role"]["role_add"],size:"small",type:"text"}},[e._v("切换企业")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"moduleName",label:"审核类型",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"审批角色",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[0===i.auditUsers.length?a("span",[e._v("--")]):a("auditor-drawer",{attrs:{levels:i.auditUsers}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"开启状态",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[i.openState?a("span",{staticClass:"font-exs color-success"},[e._v("开启")]):a("span",{staticClass:"font-exs color-danger"},[e._v("关闭")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["role"]["role_update"]},on:{click:function(t){return e.handleDetail(i)}}},[e._v("详情")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["role"]["role_update"]},on:{click:function(t){return e.handleSetting(i)}}},[e._v("设置流程")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["role"]["role_delete"]},on:{click:function(t){return e.handleChange(i)}}},[i.openState?a("span",{staticClass:"color-danger"},[e._v("关闭")]):a("span",{staticClass:"color-success"},[e._v("开启")])])]}}])})],1)],1),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=(a("ac6a"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),"destroy-on-close":"",visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},o=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-container"},[a("div",{staticClass:"setting-item-container"},[e._l(e.listAll,(function(t,i){return a("div",{key:i,staticClass:"setting-item"},[a("div",{staticClass:"col-item"},[a("div",{staticClass:"left-container"},[a("h4",[e._v("第"+e._s(t.level)+"层审批流程")])])]),e._v(" "),a("div",{staticClass:"col-item"},[a("div",{staticClass:"audit-type"},[a("el-radio",{attrs:{disabled:"",label:1},model:{value:t.range,callback:function(a){e.$set(t,"range",a)},expression:"item.range"}},[e._v("会签")]),e._v(" "),a("el-radio",{attrs:{disabled:"",label:0},model:{value:t.range,callback:function(a){e.$set(t,"range",a)},expression:"item.range"}},[e._v("或签")])],1),e._v(" "),a("div",{staticClass:"user-tag"},e._l(t.userList,(function(t){return a("async-user-tag",{key:t.uuid,attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n            "+e._s(t.name)+"\n          ")])})),1)])])})),e._v(" "),a("el-divider")],2),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)])},u=[],d=a("2f62"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.alterValue.map((function(t){return e.genParse(t)})),(function(t,i){return a("div",{key:t.uuid,staticClass:"user-tag-container"},[a("el-tag",{attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleClose(i)}}},[e._v(e._s(t.name))])],1)})),e._v(" "),e.inputVisible?a("el-select",{ref:"saveTagInput",attrs:{size:"small",filterable:"",multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.alterValue,callback:function(t){e.alterValue=t},expression:"alterValue"}},e._l(e.listAll,(function(t){return a("el-option",{key:t.userId,attrs:{label:t.name,value:e.genStringify(t)}})})),1):a("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:e.showInput}},[e._v("添加用户")])],2)},f=[],h={props:{value:{type:Array,default:function(){return[]}}},model:{prop:"value",event:"change"},data:function(){return{inputVisible:!1,inputValue:[],alterValue:this.value}},computed:Object(r["a"])({},Object(d["c"])({listAll:function(e){return e.user.listSelect}})),created:function(){this.initFilter()},methods:{initFilter:function(){this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(e){console.error(e)}))},handleClose:function(e){this.alterValue.splice(e,1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this.inputValue;e&&this.value.push(e),this.inputVisible=!1,this.inputValue=""},handleChange:function(e){var t=e.map((function(e){return JSON.parse(e)}));this.$emit("change",t)},genStringify:function(e){return JSON.stringify(e)},genParse:function(e){return JSON.parse(e)}}},p=h,g=(a("1f7a"),a("2877")),v=Object(g["a"])(p,m,f,!1,null,"557a010e",null),b=v.exports,y=a("fba9"),_={props:{transfer:{type:Object,default:function(){return{}}}},components:{AddTag:b,AsyncUserTag:y["a"]},data:function(){return{value:[],query:{startTime:"",endTime:"",word:""},form:{auditUserList:[{level:1,range:1,userList:[]}],uuid:""},levels:1,listAll:[]}},created:function(){var e;this.initData(null===(e=this.transfer)||void 0===e?void 0:e.uuid)},computed:{},methods:{initData:function(e){var t=this;this.$store.dispatch("sensitive/auditDetail",e).then((function(e){t.listAll=t.parse(e.auditUsers)})).catch((function(e){t.$message({type:"error",message:e})}))},parse:function(e){return JSON.parse(e)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1}}},C=_,x=(a("8015"),Object(g["a"])(C,c,u,!1,null,"6a42c91f",null)),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-container"},[a("div",{staticClass:"setting-item-container"},[e._l(e.form.auditUserList,(function(t,i){return a("div",{key:i,staticClass:"setting-item"},[a("div",{staticClass:"col-item"},[a("div",{staticClass:"left-container"},[a("h4",[e._v("第"+e._s(t.level)+"层审批流程")]),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{type:"text"},on:{click:e.handleAddLevel}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("\n              添加流程\n            ")])],1)])]),e._v(" "),a("div",{staticClass:"col-item"},[a("div",{staticClass:"audit-type"},[a("el-radio",{attrs:{label:1},model:{value:t.range,callback:function(a){e.$set(t,"range",a)},expression:"item.range"}},[e._v("会签")]),e._v(" "),a("el-radio",{attrs:{label:0},model:{value:t.range,callback:function(a){e.$set(t,"range",a)},expression:"item.range"}},[e._v("或签")])],1),e._v(" "),a("add-tag",{model:{value:t.userList,callback:function(a){e.$set(t,"userList",a)},expression:"item.userList"}})],1)])})),e._v(" "),a("el-divider")],2),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)])},T=[],w=(a("7f7f"),{props:{transfer:{type:Object,default:function(){return{}}}},components:{AddTag:b},data:function(){return{value:[],query:{startTime:"",endTime:"",word:""},form:{auditUserList:[{level:1,range:1,userList:[]}],uuid:""},levels:1}},watch:{transfer:{handler:function(e,t){var a=e.uuid;this.form.uuid=a},immediate:!0}},computed:{},methods:{handleAddUser:function(){},handleAddLevel:function(){var e=++this.levels,t={level:e,range:1,userList:[]};this.form.auditUserList.push(t)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleConfirm:function(){var e=this,t=this.form.auditUserList.every((function(e){return 0!=e.userList.length}));if(t){var a=this.form.auditUserList.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{userList:e.userList.map((function(e){return{name:e.name,userId:e.userId,uuid:e.uuid,auditState:"TO_BE_REVIEWED"}}))})})),i=this.form,n=Object(r["a"])(Object(r["a"])({},i),{},{auditUserList:a});this.$store.dispatch("sensitive/setAuditUser",n).then((function(){e.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){e.handleRefresh(),e.handleCancel()}})})).catch((function(t){console.error(t),e.$message({type:"error",message:errw})}))}else this.$confirm("是否放弃设置审批人","warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)}))},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}}),S=w,D=(a("ce101"),Object(g["a"])(S,k,T,!1,null,"d926f286",null)),E=D.exports,L={components:{SettingTemplate:E,DetailTemplate:$},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"setting"===this.eventType?"设置审批人员":"detail"===this.eventType?"审批流程":void 0}}},A=L,U=Object(g["a"])(A,l,o,!1,null,null,null),q=U.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.handleRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},I=[],j={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},R=j,N=(a("d436"),Object(g["a"])(R,O,I,!1,null,"4354f207",null)),M=N.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.alterAuditUsers,(function(t){return a("div",{key:t.level},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div")]),e._v(" "),a("el-col",{attrs:{span:12}},e._l(t.userList,(function(t){return a("async-user-tag",{key:t.uuid,attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n          "+e._s(t.name)+"\n        ")])})),1)],1)],1)})),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.alterAuditUsers.length<1,expression:"alterAuditUsers.length<1"}],staticClass:"text-align-center"},[e.users.length>2?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.curly=!e.curly}}},[a("i",{class:[e.curly?"el-icon-caret-bottom":"el-icon-caret-top"]})]):e._e()],1)],2)},P=[],F=a("cf45"),V={props:{auditUsers:{type:Array,default:function(){return[]}}},components:{AsyncUserTag:y["a"]},data:function(){return{curly:!1}},watch:{auditUsers:{handler:function(e,t){e.length>2?this.curly=!0:this.curly=!1},immediate:!0}},computed:{alterAuditUsers:function(){return this.curly?this.auditUsers.slice(0,2):this.auditUsers}},methods:{toChinesNum:function(e){return Object(F["default"])(e)}}},B=V,G=Object(g["a"])(B,z,P,!1,null,null,null),W=G.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.alterLevels,(function(t){return a("el-row",{key:t.level,staticStyle:{"margin-bottom":"3px"}},[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"font-ex color-info"},[e._v("第"+e._s(e.toChineseNum(t.level))+"层")]),e._v(" "),a("span",{staticClass:"font-exs color-primary"},[e._v(e._s(t.range?"会签":"或签"))])]),e._v(" "),a("el-col",{attrs:{span:16}},e._l(t.userList,(function(t){return a("async-user-tag",{key:t.uuid,attrs:{uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n        "+e._s(t.name)+"\n      ")])})),1)],1)})),e._v(" "),a("div",{staticClass:"text-align-center"},[e.levels.length>2?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.curly=!e.curly}}},[a("span",{staticClass:"font-exs"},[e._v(e._s(e.curly?"展开":"收起"))]),e._v(" "),a("i",{class:[e.curly?"el-icon-caret-bottom":"el-icon-caret-top"]})]):e._e()],1)],2)},J=[],Y={props:{levels:{type:Array,default:function(){return[]}}},components:{AsyncUserTag:y["a"]},data:function(){return{curly:!1}},watch:{levels:{handler:function(e,t){e.length>2?this.curly=!0:this.curly=!1},immediate:!0}},computed:{alterLevels:function(){return this.curly?this.levels.slice(0,2):this.levels}},methods:{alterUsers:function(e){return this.curly?this.arr.slice(0,2):this.arr},toChineseNum:function(e){return Object(F["h"])(e)}}},X=Y,K=Object(g["a"])(X,H,J,!1,null,null,null),Q=K.exports,Z=a("1b32"),ee=a("6424"),te=a("1a6c"),ae={name:"AuditPropertyListAll",components:{FormDialog:q,ToolBar:M,AsyncUserTag:y["a"],AsyncUserDrawer:Z["a"],AuditorDrawer:Q,RoleDrawer:te["a"],TagsDrawer:ee["a"],AuditUser:W},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10},form:{},rowSelects:[]}},watch:{},computed:Object(r["a"])({},Object(d["c"])({loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.propertyListAll},page:function(e){return e.sensitive.propertyPage},corpInfo:function(e){return e.auth.corpInfo},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query)},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(){},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/auditPropertylistAll",e).then((function(){t.listAll.forEach((function(e){t.$set(t.form,e.moduleName,e.openState)})),t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleChange:function(e){var t=this,a=e.openState,i=e.moduleName,n=e.uuid;this.$confirm("是否".concat(a?"关闭":"开启").concat(i,"审核？"),"Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function i(){var r,l;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=!!e.auditUsers.length,r?(l={openState:!a,uuid:n},t.$store.dispatch("sensitive/setAuditCloseOrOpen",l).then((function(){t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}))):t.$confirm("请先设置审批流程","warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)}));case 2:case"end":return i.stop()}}),i)})))).catch((function(e){console.error(e),t.$message({type:"error",message:e})}))},handleSetting:function(e){var t=e.uuid;this.$refs["formDialog"].event="SettingTemplate",this.$refs["formDialog"].eventType="setting",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer={uuid:t}},handleDetail:function(e){var t=e.uuid;console.log(e),this.$refs["formDialog"].event="DetailTemplate",this.$refs["formDialog"].eventType="detail",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer={uuid:t}},parse:function(e){var t;return(null===(t=JSON.parse(e)[0])||void 0===t?void 0:t.userList)||[]}}},ie=ae,ne=(a("1a2d2"),Object(g["a"])(ie,i,n,!1,null,"48ba928b",null));t["default"]=ne.exports},"2b97":function(e,t,a){},"2c9a":function(e,t,a){},"2dff":function(e,t,a){"use strict";var i=a("5d17"),n=a.n(i);n.a},3:function(e,t){},3179:function(e,t,a){},"31a5":function(e,t,a){},"327a":function(e,t,a){"use strict";var i=a("24c4"),n=a.n(i);n.a},"330d":function(e,t,a){"use strict";var i=a("b9f2"),n=a.n(i);n.a},3448:function(e,t,a){"use strict";var i=a("fdeb"),n=a.n(i);n.a},"347c":function(e,t,a){},"348f":function(e,t,a){},"351f":function(e,t,a){},"36c3d":function(e,t,a){},"377b":function(e,t,a){},3909:function(e,t,a){"use strict";var i=a("c156"),n=a.n(i);n.a},"390c":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("\n    src\\views\\batchSendTask\\addBatchSendTask\\index.vue\n")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"39b1":function(e,t,a){"use strict";var i=a("24ec"),n=a.n(i);n.a},"3a19":function(e,t,a){"use strict";var i=a("5129"),n=a.n(i);n.a},"3b29":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("sensitive/auditList")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"3ca3":function(e,t,a){"use strict";var i=a("cf83"),n=a.n(i);n.a},"3cd7":function(e,t,a){"use strict";var i=a("76e2"),n=a.n(i);n.a},"3d46":function(e,t,a){},"3d4d":function(e,t,a){"use strict";var i=a("bc19"),n=a.n(i);n.a},"3d64":function(e,t,a){},"3dd5":function(e,t,a){},"3dd6":function(e,t,a){"use strict";var i=a("8de8"),n=a.n(i);n.a},"3dec":function(e,t,a){"use strict";var i=a("f4d4"),n=a.n(i);n.a},"3ec7":function(e,t,a){},4:function(e,t){},"405a":function(e,t,a){e.exports=a.p+"static/img/2.96c28e86.jpg"},"412d":function(e,t,a){"use strict";var i=a("09ed"),n=a.n(i);n.a},4166:function(e,t,a){},"41b3":function(e,t,a){},"42b7":function(e,t,a){},"42fb":function(e,t,a){"use strict";var i=a("fe26"),n=a.n(i);n.a},4361:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listGroup,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{prop:"name",label:"群名称",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"群主",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.owner?a("div",[e._v(e._s(t.row.owner.name))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"countNum",label:"群人数",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"昨日入群",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.countNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"昨日退群",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.countNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_groupDetail"]},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)])],1)},n=[],s=a("5530"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"搜索群名称："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.externalUuid,callback:function(t){e.$set(e.query,"externalUuid","string"===typeof t?t.trim():t)},expression:"query.externalUuid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"全部群主："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.userId,callback:function(t){e.$set(e.query,"userId",t)},expression:"query.userId"}},e._l(e.listOwner,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.userId}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{query:{externalUuid:"",userId:""}}},computed:Object(s["a"])({},Object(o["c"])({listOwner:function(e){return e.externalUser.listOwner}})),methods:{handleChangeFirst:function(e){this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){this.$emit("handleSearch",this.query)},handleChangeThird:function(e){this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=(a("3448"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"61a251bc",null),f=m.exports,h=a("8690"),p=a("ecfe"),g={components:{ListHeader:f,ToolBar:h["a"],CustomerPagination:p["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,externalUuid:"",userId:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({listOwner:function(e){return e.externalUser.departmentList},loading:function(e){return e.externalUser.loading},listGroup:function(e){return e.externalUser.listGroup},listGroupPage:function(e){return e.externalUser.listGroupPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){},beforeDestroy:function(){},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("externalUser/getListOwner").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getListGroup",e).then((function(){t.pageConfig.pageNumber=t.listGroupPage.pageNumber+1,t.pageConfig.total=t.listGroupPage.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.listGroup[e].chatId;this.$router.push({path:"/externalUser/groupDetail",query:{chatId:t}})},handleSearch:function(e){var t=e.externalUuid,a=e.userId;this.query.externalUuid=t||this.query.externalUuid,this.query.userId=a||this.query.userId,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},v=g,b=(a("48fa"),Object(d["a"])(v,i,n,!1,null,"593fdfed",null));t["default"]=b.exports},"45d8":function(e,t,a){},"461d":function(e,t,a){},4791:function(e,t,a){"use strict";var i=a("817b"),n=a.n(i);n.a},"47b1":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["batchSendTask"]["batchSendTask_add"]},on:{click:e.actionDepartment}},[e._v("新建群发")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.batchSendTaskListAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"id",align:"left",prop:"msgId"}}),e._v(" "),a("el-table-column",{attrs:{label:"发送者",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.sender.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"群发类型",align:"left",prop:"sendType"}}),e._v(" "),a("el-table-column",{attrs:{label:"内容",align:"left",prop:"textContent"}}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",align:"left",prop:"updatedAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"left",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"群发状态："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.query.value1,callback:function(t){e.$set(e.query,"value1",t)},expression:"query.value1"}},e._l(e.state,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"群发类型："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.query.value2,callback:function(t){e.$set(e.query,"value2",t)},expression:"query.value2"}},e._l(e.state,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"创建员工："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.query.value3,callback:function(t){e.$set(e.query,"value3",t)},expression:"query.value3"}},e._l(e.state,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"发送时间"}},[a("el-date-picker",{attrs:{disabled:"",type:"daterange","value-format":"yyyy-MM-dd HH-mm-ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:e.query.value4,callback:function(t){e.$set(e.query,"value4",t)},expression:"query.value4"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{state:[{value:1,label:"a"},{value:2,label:"b"},{value:3,label:"c"}],query:{value1:"",value2:"",value3:"",value4:""}}},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},userListAll:function(e){return e.user.userListAll}})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=a("2877"),m=Object(d["a"])(u,r,l,!1,null,null,null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:e.dialogWidth,center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},p=[],g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("section",{staticClass:"contact-way-detail app-container"},[a("div",{staticClass:"contact-way-detail-warp"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("div",[a("h5",[e._v("基本信息")]),e._v(" "),a("el-form-item",{attrs:{label:"选择群发类型："}},[a("el-radio-group",{model:{value:e.form.sendType,callback:function(t){e.$set(e.form,"sendType",t)},expression:"form.sendType"}},[a("el-radio",{attrs:{label:"WX"}},[e._v("\n                企业微信群发\n                "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("添加成为用户后，将自动打上预设标签")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1),e._v(" "),a("el-radio",{attrs:{label:"MY"}},[e._v("\n                超盈群发\n                "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("添加成为用户后，将自动打上预设标签")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:" "}},[a("span",[e._v("同一个企业每个自然月内仅可针对一个客户/客户群发4条消息，超过限制的用户将会被忽略。")])]),e._v(" "),a("el-form-item",{attrs:{label:"选择群发账号：",prop:"userUuid"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:""},on:{change:e.changeUser},model:{value:e.form.userUuid,callback:function(t){e.$set(e.form,"userUuid",t)},expression:"form.userUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",{staticClass:"run-way-list-all-header"},[a("el-form-item",{attrs:{label:"客户标签："}},[a("div",{staticClass:"tag-border"},[a("el-select",{attrs:{size:"mini",multiple:""},on:{change:e.initDataList},model:{value:e.query.tagIds,callback:function(t){e.$set(e.query,"tagIds",t)},expression:"query.tagIds"}},e._l(e.tagListSelect,(function(t){return a("el-option-group",{key:t.groupId,attrs:{label:t.groupName}},e._l(t.tagList,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.tagName,value:e.uuid}})})),1)})),1),e._v(" "),a("span",{staticClass:"tag-warp"},[a("el-radio-group",{on:{change:e.initDataList},model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:!0}},[e._v("包含任一")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("完全匹配")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                      包含任一：有任意一个选择的标签的用户;\n                      "),a("br"),e._v("完全匹配：必须拥有全部选择的标签的用户。\n                    ")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1)],1)]),e._v(" "),a("el-form-item",{attrs:{label:" "}},[e._v("将发送给"+e._s(e.form.batchTaskNumber)+"位客户")])],1),e._v(" "),a("h5",[e._v("编辑群发消息")]),e._v(" "),a("div",{staticClass:"set-welcome-message"},[a("el-form-item",{attrs:{label:"文字消息："}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"insert-btn"},[a("el-button",{staticClass:"clickable no-select",attrs:{type:"text",disabled:!e.insertName},on:{click:function(t){return e.insertionMemberName(e.memberNick)}}},[e._v("[插入客户昵称]")])],1),e._v(" "),a("inputEdit",{ref:"chatInput",staticStyle:{height:"200px"},model:{value:e.form.text,callback:function(t){e.$set(e.form,"text",t)},expression:"form.text"}})],1)])],1),e._v(" "),a("div",{staticClass:"set-welcome-message"},[a("el-form-item",{attrs:{label:"图片/文章/链接:"}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"message-box-content"},[a("el-radio-group",{model:{value:e.form.tempMediaType,callback:function(t){e.$set(e.form,"tempMediaType",t)},expression:"form.tempMediaType"}},[a("el-radio",{attrs:{label:"IMAGE"}},[e._v("图片")]),e._v(" "),a("el-radio",{attrs:{label:"VIDEO"}},[e._v("视频")]),e._v(" "),a("el-radio",{attrs:{label:"FILE"}},[e._v("文件")]),e._v(" "),a("el-radio",{attrs:{label:"ARTICLE"}},[e._v("文章")])],1),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"IMAGE"==e.form.tempMediaType,expression:"form.tempMediaType == 'IMAGE'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleSetMessageImage,"before-upload":e.beforeUploadImage}},[e.messageImage?a("el-image",{staticClass:"avatar",attrs:{fit:"contain",src:e.messageImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),e._v(" "),e.messageImage?a("i",{staticClass:"el-icon-circle-close close",on:{click:function(t){return t.stopPropagation(),e.handleDelMessageImage(t)}}}):e._e()],1)]),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"VIDEO"==e.form.tempMediaType,expression:"form.tempMediaType == 'VIDEO'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleSetMessageVideo,"before-upload":e.beforeUploadVideo}},[e.messageVideo?a("video",{staticClass:"avatar",attrs:{controls:"controls",src:e.messageVideo}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),e.messageVideo?a("i",{staticClass:"el-icon-circle-close close",on:{click:function(t){return t.stopPropagation(),e.handleDelMessageVideo(t)}}}):e._e()],1)]),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"FILE"==e.form.tempMediaType,expression:"form.tempMediaType == 'FILE'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","on-success":e.handleSetMessageFile,"before-upload":e.beforeUploadFile,"before-remove":e.beforeRemoveFile,"on-remove":e.removeFile}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.messageFile,expression:"!messageFile"}],attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"ARTICLE"==e.form.tempMediaType,expression:"form.tempMediaType == 'ARTICLE'"}],staticClass:"message-content"},[a("el-select",{staticClass:"label-warp",staticStyle:{width:"80%"},attrs:{"popper-append-to-body":!1,clearable:"",placeholder:"请选择","popper-class":"selectinfo"},on:{change:e.handleChoseLink,clear:e.handleClear},model:{value:e.form.mediaUuid,callback:function(t){e.$set(e.form,"mediaUuid",t)},expression:"form.mediaUuid"}},[e.form.mediaUuid?a("div",{staticClass:"display-flex align-items-center label-input",attrs:{slot:"prefix"},slot:"prefix"},[a("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:"/api/public/file/"+e.welcomecontentT.imgId,alt:""}}),e._v(" "),a("div",{staticClass:"input-title"},[a("span",[e._v(e._s(e.welcomecontentT.title))]),e._v(" "),a("div",{staticClass:"input-content text-over"},[e._v(e._s(e.welcomecontentT.description))])])]):e._e(),e._v(" "),e._l(e.articleListSelect,(function(t,i){return a("el-option",{key:i,attrs:{label:t.title,value:t.uuid}},[a("div",{staticClass:"option-warp flex-between-alinecenter"},[a("div",{staticClass:"link-img"},[a("img",{staticClass:"option-img",attrs:{src:"/api/public/file/"+t.imgId}})]),e._v(" "),a("div",{staticClass:"option-content flex-1"},[a("p",[e._v(e._s(t.title))]),e._v(" "),a("p",[e._v(e._s(t.description))])])])])}))],2)],1)],1)])])],1),e._v(" "),a("el-form-item",{attrs:{label:"群发时间："}},[a("el-radio",{attrs:{label:!0},model:{value:e.isSendImmediately,callback:function(t){e.isSendImmediately=t},expression:"isSendImmediately"}},[e._v("立即发送")]),e._v(" "),a("el-radio",{attrs:{label:!1},model:{value:e.isSendImmediately,callback:function(t){e.isSendImmediately=t},expression:"isSendImmediately"}},[e._v("定时发送")]),e._v(" "),a("el-date-picker",{attrs:{disabled:e.isSendImmediately,type:"datetime",placeholder:"选择日期时间","default-time":["00:00:00","23:59:59"]},model:{value:e.form.sendTime,callback:function(t){e.$set(e.form,"sendTime",t)},expression:"form.sendTime"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)])],1)])])},v=[],b=(a("7514"),a("6b54"),a("12e3")),y=a("f6e6"),_=a("bc0e"),C={inject:["reload"],components:{inputEdit:b["a"],TagMultiSelect:y["a"]},data:function(){return{isSendImmediately:!0,rules:{userUuid:[{required:!0,message:"请选择群发账号",trigger:"change"}]},query:{flag:!0,tagIds:[],size:500,userId:""},form:{batchTaskNumber:0,externalUserUuids:[],mediaUuid:null,sendType:"MY",tagNames:"",tagUuids:[],tempMediaKey:"",tempMediaType:"IMAGE",text:"",userUuid:"",matchFormat:"CONTAINS_ANY",sendTime:""},insertName:!0,messageImage:"",messageVideo:"",messageFile:"",mediaId:"",welcomecontentT:{},memberNick:"客户昵称"}},created:function(){var e=this;this.$store.dispatch("media/getArticleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))},watch:{"form.text":{handler:function(e,t){e.indexOf('<span class="nickName">客户昵称</span>')>-1?this.insertName=!1:this.insertName=!0},immediate:!0},"query.tagIds":{handler:function(e,t){this.form.tagUuids=e},immediate:!0},"query.flag":{handler:function(e,t){this.form.matchFormat=e?"CONTAINS_ANY":"PERFECT_MATCH"},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({tagListSelect:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect},articleListSelect:function(e){return e.media.articleListSelect}})),methods:{changeUser:function(e){for(var t=0;t<this.userListAll.length;t++)if(this.userListAll[t].uuid==e){this.query.userId=this.userListAll[t].userId;break}this.initDataList()},initDataList:function(){var e=this,t=Object(s["a"])(Object(s["a"])({},this.query),{},{tagIds:this.query.tagIds.toString()});this.form.batchTaskNumber=0,this.form.externalUserUuids=[],Object(_["d"])(t).then((function(t){e.form.batchTaskNumber=t.total,t.items.map((function(t){e.form.externalUserUuids.push(t.externalUuid)}))}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("batchSendTask/getBatchSendTaskListAll").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},submit:function(){var e=this;this.$refs["form"].validate((function(t){t?e.$store.dispatch("batchSendTask/addBatchSendTask",e.form).then((function(t){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.handleRefresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})})):e.$message({type:"error",message:"请检查输入"})}))},handleSetMessageImage:function(e,t){this.messageImage=URL.createObjectURL(t.raw),this.form.tempMediaKey=e.id},handleSetMessageVideo:function(e,t){this.messageVideo=URL.createObjectURL(t.raw),this.form.tempMediaKey=e.id},handleSetMessageFile:function(e,t){this.messageFile=URL.createObjectURL(t.raw),this.form.tempMediaKey=e.id},beforeUploadImage:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},beforeUploadVideo:function(e){var t="video/mp4"===e.type,a=e.size/1024/1024<50;return t||this.$message.error("上传视频只能是 MP4 格式!"),a||this.$message.error("上传视频大小不能超过 50MB!"),t&&a},beforeUploadFile:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("上传视频大小不能超过 50MB!"),t},beforeRemoveFile:function(e){return this.$confirm("确定移除 ".concat(e.name,"？"))},removeFile:function(e){this.messageFile="",this.form.tempMediaKey=null},handleDelMessageImage:function(){this.messageImage="",this.form.tempMediaKey=null},handleDelMessageVideo:function(){this.messageVideo="",this.form.tempMediaKey=null},handleDelMessageFile:function(){this.messageFile="",this.form.tempMediaKey=null},handleChoseLink:function(e){this.welcomecontentT=this.articleListSelect.find((function(t){return t.uuid===e})),this.welcomecontentT&&this.welcomecontentT.uuid&&(this.form.mediaUuid=this.welcomecontentT.uuid)},handleClear:function(){this.form.mediaUuid="",this.welcomecontentT={}},insertionMemberName:function(e){this.insertName=!1,this.form.text=this.form.text+'<span class="nickName">'.concat(e,"</span>&#8203;")},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},x=C,$=(a("1acb"),a("230d"),Object(d["a"])(x,g,v,!1,null,"06a17efc",null)),k=$.exports,T={components:{addBatchSendTaskTemplate:k},data:function(){return{dialogVisible:!1,event:"",eventType:"",dialogWidth:"600px"}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"distribute"===this.eventType?"分配部门":"addBatchSendTask"==this.eventType?"新建群发消息":void 0}}},w=T,S=Object(d["a"])(w,h,p,!1,null,null,null),D=S.exports,E=a("8690"),L=a("ecfe"),A={components:{ListHeader:f,FormDialog:D,ToolBar:E["a"],CustomerPagination:L["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.batchSendTask.loading},batchSendTaskListAll:function(e){return e.batchSendTask.batchSendTaskListAll},page:function(e){return e.batchSendTask.listAllPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getAllUserList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("batchSendTask/getBatchSendTaskListAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){this.$router.push("/batchSendTask/detail/".concat(e.uuid))},handleSearch:function(e){var t=e.tagIds,a=e.name;this.query.tagIds=t||this.query.tagIds,this.query.name=a||this.query.name,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},actionDepartment:function(){this.$refs.formDialog.dialogVisible=!0,this.$refs.formDialog.event="addBatchSendTaskTemplate",this.$refs.formDialog.eventType="addBatchSendTask",this.$refs.formDialog.dialogWidth="70%"},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},U=A,q=(a("e974f"),a("3dd6"),Object(d["a"])(U,i,n,!1,null,"b39b3d0e",null));t["default"]=q.exports},4806:function(e,t,a){},"48fa":function(e,t,a){"use strict";var i=a("014b6"),n=a.n(i);n.a},4952:function(e,t,a){},"4a37":function(e,t,a){"use strict";var i=a("ce29"),n=a.n(i);n.a},"4a60":function(e,t,a){"use strict";var i=a("de8f"),n=a.n(i);n.a},"4b12":function(e,t,a){},"4b1b":function(e,t,a){},"4bf8d":function(e,t,a){"use strict";a.r(t),a.d(t,"export_table_to_excel",(function(){return m})),a.d(t,"export_json_to_excel",(function(){return f}));a("6b54"),a("ac6a");var i=a("2909"),n=(a("34ef"),a("21a6")),s=a("1146"),r=a.n(s);function l(e){for(var t=[],a=e.querySelectorAll("tr"),i=[],n=0;n<a.length;++n){for(var s=[],r=a[n],l=r.querySelectorAll("td"),o=0;o<l.length;++o){var c=l[o],u=c.getAttribute("colspan"),d=c.getAttribute("rowspan"),m=c.innerText;if(""!==m&&m==+m&&(m=+m),i.forEach((function(e){if(n>=e.s.r&&n<=e.e.r&&s.length>=e.s.c&&s.length<=e.e.c)for(var t=0;t<=e.e.c-e.s.c;++t)s.push(null)})),(d||u)&&(d=d||1,u=u||1,i.push({s:{r:n,c:s.length},e:{r:n+d-1,c:s.length+u-1}})),s.push(""!==m?m:null),u)for(var f=0;f<u-1;++f)s.push(null)}t.push(s)}return[t,i]}function o(e,t){t&&(e+=1462);var a=Date.parse(e);return(a-new Date(Date.UTC(1899,11,30)))/864e5}function c(e,t){for(var a={},i={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=0;n!=e.length;++n)for(var s=0;s!=e[n].length;++s){i.s.r>n&&(i.s.r=n),i.s.c>s&&(i.s.c=s),i.e.r<n&&(i.e.r=n),i.e.c<s&&(i.e.c=s);var l={v:e[n][s]};if(null!=l.v){var c=r.a.utils.encode_cell({c:s,r:n});"number"===typeof l.v?l.t="n":"boolean"===typeof l.v?l.t="b":l.v instanceof Date?(l.t="n",l.z=r.a.SSF._table[14],l.v=o(l.v)):l.t="s",a[c]=l}}return i.s.c<1e7&&(a["!ref"]=r.a.utils.encode_range(i)),a}function u(){if(!(this instanceof u))return new u;this.SheetNames=[],this.Sheets={}}function d(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),i=0;i!=e.length;++i)a[i]=255&e.charCodeAt(i);return t}function m(e){var t=document.getElementById(e),a=l(t),i=a[1],s=a[0],o="SheetJS",m=new u,f=c(s);f["!merges"]=i,m.SheetNames.push(o),m.Sheets[o]=f;var h=r.a.write(m,{bookType:"xlsx",bookSST:!1,type:"binary"});Object(n["saveAs"])(new Blob([d(h)],{type:"application/octet-stream"}),"test.xlsx")}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.multiHeader,a=void 0===t?[]:t,s=e.header,l=e.data,o=e.filename,m=e.merges,f=void 0===m?[]:m,h=e.autoWidth,p=void 0===h||h,g=e.bookType,v=void 0===g?"xlsx":g;o=o||"excel-list",l=Object(i["a"])(l),l.unshift(s);for(var b=a.length-1;b>-1;b--)l.unshift(a[b]);var y="SheetJS",_=new u,C=c(l);if(f.length>0&&(C["!merges"]||(C["!merges"]=[]),f.forEach((function(e){C["!merges"].push(r.a.utils.decode_range(e))}))),p){for(var x=l.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}}))})),$=x[0],k=1;k<x.length;k++)for(var T=0;T<x[k].length;T++)$[T]["wch"]<x[k][T]["wch"]&&($[T]["wch"]=x[k][T]["wch"]);C["!cols"]=$}_.SheetNames.push(y),_.Sheets[y]=C;var w=r.a.write(_,{bookType:v,bookSST:!1,type:"binary"});Object(n["saveAs"])(new Blob([d(w)],{type:"application/octet-stream"}),"".concat(o,".").concat(v))}},"4c05":function(e,t,a){},"4c15":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\potentialCustomer\\detail\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"4c88":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",[a("div",[a("el-form",[a("el-form-item",{attrs:{label:"封面图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.onSuccess,"before-upload":e.beforeUpload}},[e.form.imgId?a("el-image",{staticClass:"avatar",attrs:{fit:"contain",src:"/api/public/file/"+e.form.imgId}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"选择分类",rules:[{required:!0,message:"*分类不能为空",trigger:["blur","change"]}]}},[a("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.groupUuid,callback:function(t){e.groupUuid=t},expression:"groupUuid"}},e._l(e.mediaGroupListAll,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.groupName,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"符合标签"}},[a("div",[a("el-radio",{attrs:{label:"CONTAINS_ANY"},model:{value:e.form.matchFormat,callback:function(t){e.$set(e.form,"matchFormat",t)},expression:"form.matchFormat"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"PERFECT_MATCH"},model:{value:e.form.matchFormat,callback:function(t){e.$set(e.form,"matchFormat",t)},expression:"form.matchFormat"}},[e._v("完全匹配")])],1),e._v(" "),a("div",{staticClass:"select-zoom"},[a("tag-multi-select",{model:{value:e.form.tagUuids,callback:function(t){e.$set(e.form,"tagUuids",t)},expression:"form.tagUuids"}})],1)]),e._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"24px"}},[a("MDinput",{attrs:{maxlength:20,name:"name"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}},[e._v("文章标题")]),e._v(" "),a("MDinput",{attrs:{maxlength:100,name:"name"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}},[e._v("文章描述")])],1)],1)],1),e._v(" "),a("div",{staticClass:"fix"},[a("el-t-button",{attrs:{size:"small",popAuth:!0,auth:e.permissionMap["media"]["media_add"],type:"primary",throat:5e3},on:{click:e.handleConfirm}},[e._v("保存文章")])],1),e._v(" "),a("div",[a("Tinymce",{ref:"editor",attrs:{height:400},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)])],1)},n=[],s=(a("6762"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tinymce-container",class:{fullscreen:e.fullscreen},style:{width:e.containerWidth}},[a("textarea",{staticClass:"tinymce-textarea",attrs:{id:e.tinymceId}}),e._v(" "),a("div",{staticClass:"editor-custom-btn-container"})])},l=[],o=(a("ac6a"),a("c5f6"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-container"},[a("el-button",{style:{background:e.color,borderColor:e.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("\n    upload\n  ")]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":e.fileList,"show-file-list":!0,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"before-upload":e.beforeUpload,action:"https://httpbin.org/post","list-type":"picture-card"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("\n        Click upload\n      ")])],1),e._v(" "),a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n      Cancel\n    ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n      Confirm\n    ")])],1)],1)}),c=[],u=(a("456d"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var e=this;return Object.keys(this.listObj).every((function(t){return e.listObj[t].hasSuccess}))},handleSubmit:function(){var e=this,t=Object.keys(this.listObj).map((function(t){return e.listObj[t]}));this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("Please wait for all images to be uploaded successfully. If there is a network problem, please refresh the page and upload again!")},handleSuccess:function(e,t){for(var a=t.uid,i=Object.keys(this.listObj),n=0,s=i.length;n<s;n++)if(this.listObj[i[n]].uid===a)return this.listObj[i[n]].url=e.files.file,void(this.listObj[i[n]].hasSuccess=!0)},handleRemove:function(e){for(var t=e.uid,a=Object.keys(this.listObj),i=0,n=a.length;i<n;i++)if(this.listObj[a[i]].uid===t)return void delete this.listObj[a[i]]},beforeUpload:function(e){var t=this,a=window.URL||window.webkitURL,i=e.uid;return this.listObj[i]={},new Promise((function(n,s){var r=new Image;r.src=a.createObjectURL(e),r.onload=function(){t.listObj[i]={hasSuccess:!1,uid:e.uid,width:this.width,height:this.height}},n(!0)}))}}}),d=u,m=(a("9ff3"),a("2877")),f=Object(m["a"])(d,o,c,!1,null,"14e3f6e8",null),h=f.exports,p=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],g=p,v=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],b=v,y=a("b85c"),_=[];function C(){return window.tinymce}var x=function(e,t){var a=document.getElementById(e),i=t||function(){};if(!a){var n=document.createElement("script");n.src=e,n.id=e,document.body.appendChild(n),_.push(i);var s="onload"in n?r:l;s(n)}function r(t){t.onload=function(){this.onerror=this.onload=null;var e,a=Object(y["a"])(_);try{for(a.s();!(e=a.n()).done;){var i=e.value;i(null,t)}}catch(n){a.e(n)}finally{a.f()}_=null},t.onerror=function(){this.onerror=this.onload=null,i(new Error("Failed to load "+e),t)}}function l(e){e.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var t,a=Object(y["a"])(_);try{for(a.s();!(t=a.n()).done;){var i=t.value;i(null,e)}}catch(n){a.e(n)}finally{a.f()}_=null}}}a&&i&&(C()?i(null,a):_.push(i))},$=x,k="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",T={name:"Tinymce",components:{editorImage:h},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var e=this.width;return/^[\d]+(\.[\d]+)?$/.test(e)?"".concat(e,"px"):e}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(t.tinymceId).setContent(e||"")}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var e=this;$(k,(function(t){t?e.$message.error(t.message):e.initTinymce()}))},initTinymce:function(){var e=this,t=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:this.languageTypeList["zh"],height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:b,menubar:this.menubar,plugins:g,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(a){t.value&&a.setContent(t.value),t.hasInit=!0,a.on("NodeChange Change KeyUp SetContent",(function(){e.hasChange=!0,e.$emit("input",a.getContent())}))},setup:function(e){e.on("FullscreenStateChanged",(function(e){t.fullscreen=e.state}))},convert_urls:!1})},destroyTinymce:function(){var e=window.tinymce.get(this.tinymceId);this.fullscreen&&e.execCommand("mceFullScreen"),e&&e.destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach((function(e){window.tinymce.get(t.tinymceId).insertContent('<img class="wscnph" src="'.concat(e.url,'" >'))}))}}},w=T,S=(a("1bb4"),Object(m["a"])(w,r,l,!1,null,"e70e3742",null)),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"material-input__component",class:e.computedClasses},[a("div",{class:{iconClass:e.icon}},[e.icon?a("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+e.icon]}):e._e(),e._v(" "),"email"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"email"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"url"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"url"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"number"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,step:e.step,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"number"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"password"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,required:e.required,type:"password"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"tel"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"tel"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"text"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"text"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),a("span",{staticClass:"material-input-bar"}),e._v(" "),a("label",{staticClass:"material-label"},[e._t("default")],2)])])},L=[],A={name:"MdInput",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(e){this.currentValue=e}},methods:{handleModelInput:function(e){var t=e.target.value;this.$emit("input",t),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[t]),this.$emit("change",t)},handleMdFocus:function(e){this.focus=!0,this.$emit("focus",e),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(e){this.focus=!1,this.$emit("blur",e),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}},U=A,q=(a("1ce2"),Object(m["a"])(U,E,L,!1,null,"9f2538ae",null)),O=q.exports,I=a("9d29"),j=a("f6e6"),R=a("405a"),N=a.n(R),M=a("2f62"),z={components:{Tinymce:D,MDinput:O,TagSelect:I["a"],TagMultiSelect:j["a"]},data:function(){return{mode:"CREATE",coverUrl:null,form:{title:"",description:"",content:"",imgId:"",matchFormat:"CONTAINS_ANY",tagUuids:[]},tagSelects:[],groupUuid:"",flag:!1,type:"ARTICLE"}},watch:{$route:{handler:function(e,t){var a=e.params.uuid;-a?(this.mode="UPDATE",this.$set(this.form,"uuid",a),this.initDetail(a)):this.mode="CREATE"},immediate:!0}},computed:Object(s["a"])(Object(s["a"])({},Object(M["c"])({articleDetail:function(e){return e.media.articleDetail},mediaGroupListAll:function(e){return e.media.mediaGroupListAll},permissionMap:function(e){return e.permission.permissionMap},auditSetting:function(e){return e.sensitive.auditSetting}})),{},{defaultCover:function(){return N()()}}),created:function(){this.initFilter()},mounted:function(){},methods:{initDetail:function(e){var t=this;this.$store.dispatch("media/getArticleDetail",e).then((function(e){var a,i=e.imgId,n=e.imgUrl,s=e.articleContent,r=e.description,l=e.title;e.matchFormat,e.toTags;t.form.tagUuids=e.toTags.map((function(e){return e.uuid}));var o=null===e||void 0===e||null===(a=e.mediaGroup)||void 0===a?void 0:a.uuid;t.form.imgId=i,t.coverUrl=n,t.form.content=s,t.form.description=r,t.form.title=l,t.groupUuid=o})).catch((function(e){console.error(e),t.$message({type:"error",message:"初始化失败"})}))},initFilter:function(){var e=this;this.$store.dispatch("media/getMediaGroupListAll").then((function(){})).catch((function(t){console.error(t),e.$message({type:"error",message:"初始化失败"})}))},beforeUpload:function(){},onSuccess:function(e,t){this.form.imgId=e.id,this.coverUrl=URL.createObjectURL(t.raw)},beforeup:function(e){var t=["image/jpeg","image/gif","image/png"],a=t.includes(e.type),i=e.size/1024/1024<5;return a?!!i||(this.$message({message:"大小不能超过2M！",type:"error"}),!1):(this.$message({message:"只能上传JPG,GIF,PNG格式的图片！",type:"error"}),!1)},handleConfirm:function(){if("UPDATE"===this.mode){var e=this.form,t=this.groupUuid,a=this.$route.params.uuid,i=this.form.tagUuids;this.auditSetting["media"]?this.handleUpdate({data:Object(s["a"])(Object(s["a"])({},e),{},{uuid:a,tagUuids:i,groupUuid:t,auditState:"TO_BE_REVIEWED"})}):this.handleUpdate({data:Object(s["a"])(Object(s["a"])({},e),{},{uuid:a,tagUuids:i,groupUuid:t})})}if("CREATE"===this.mode){var n=this.form,r=this.type,l=this.groupUuid,o=this.form.tagUuids.join(",");this.handleCreate({data:Object(s["a"])(Object(s["a"])({},n),{},{tagUuids:o}),params:{type:r,groupUuid:l}})}this.flag=!0},handleUpdate:function(e){var t=this,a=this.auditSetting["media"]?"已提交审核":"已完成";this.$store.dispatch("media/updataArticle",e).then((function(){t.$message({type:"success",message:a,duration:1e3,onClose:function(){t.$router.go(-1),t.flag=!1}})})).catch((function(e){console.error(e),t.$message({type:"error",message:e})}))},handleCreate:function(e){var t=this;this.$store.dispatch("media/addArticleIsAudit",e).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.$router.go(-1),t.flag=!1}})})).catch((function(e){console.error(e),t.$message({type:"error",message:e})}))}}},P=z,F=(a("6527"),Object(m["a"])(P,i,n,!1,null,"0f3d4e2a",null));t["default"]=F.exports},"4da5":function(e,t,a){"use strict";var i=a("31a5"),n=a.n(i);n.a},"4eae":function(e,t,a){},"4f01":function(e,t,a){"use strict";var i=a("5781"),n=a.n(i);n.a},"4f58":function(e,t,a){"use strict";var i=a("6e6a"),n=a.n(i);n.a},"4f74":function(e,t,a){"use strict";var i=a("1409"),n=a.n(i);n.a},5:function(e,t){},5027:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditTagConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="access")}}},[e._v("批量通过")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditTagConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="reject")}}},[e._v("批量拒绝")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","default-sort":e.sortConfig,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:e.selectable}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"提交人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.submitOperator.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"提交时间",prop:"createdAt",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"添加/删除的标签内容"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",{staticClass:"tag-container"},[a("div",{staticStyle:{width:"60px"}},[e._v(e._s(e.tagOperationType[i.tagOperationType]))]),e._v("  \n              "),"DELETE_TAG_GROUP"===i.tagOperationType?a("div",[a("span",{staticClass:"font-exs color-info"},[e._v(e._s(i.tagChangeContent[0].groupName))])]):e._e(),e._v(" "),"ADD_TAG"===i.tagOperationType?a("div",[a("span",{staticClass:"font-exs color-info"},[e._v(e._s(i.tagChangeContent[0].groupName))])]):e._e(),e._v(" "),"UPDATE_TAG"===i.tagOperationType?a("div"):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"状态",sortable:"",prop:"auditState","sort-method":e.sortMethod,"sort-orders":["ascending","descending",null]},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",["TO_BE_REVIEWED"===i.auditState?a("span",{staticClass:"color-primary"},[e._v("审核中")]):"AUDIT_FAILED"===i.auditState?a("span",{staticClass:"color-danger"},[e._v("已拒绝")]):a("span",{staticClass:"color-success"},[e._v("已通过")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAudit(i.uuid)}}},[e._v("审核")])],1)]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("ac6a"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"审批人："}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.query.handlerId,callback:function(t){e.$set(e.query,"handlerId",t)},expression:"query.handlerId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审批状态："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.auditConfirmation,callback:function(t){e.$set(e.query,"auditConfirmation",t)},expression:"query.auditConfirmation"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"提起人："}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.query.submitterId,callback:function(t){e.$set(e.query,"submitterId",t)},expression:"query.submitterId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{handlerId:"",auditConfirmation:"",submitterId:""}}},computed:Object(s["a"])({},Object(o["c"])({userListSelect:function(e){return e.user.listSelect}})),methods:{handleChangeFirst:function(e){this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=(a("011c"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"e5b7ff3a",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),"destroy-on-close":"",visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},p=[],g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{"label-width":"150px","label-position":"left"}},[e.detail.submitOperator?a("el-form-item",{attrs:{label:"提交人："}},[a("div",{staticClass:"submit-item"},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:e.detail.submitOperator.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n        "+e._s(e.detail.submitOperator.name)+"\n      ")])],1),e._v(" "),a("div",{staticClass:"submit-item"},["TO_BE_REVIEWED"===e.detail.auditState?a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"APPROVED"===e.detail.auditState?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"AUDIT_FAILED"===e.detail.auditState?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e()],1),e._v(" "),a("div",{staticClass:"sumbit-item"},[a("span",{staticClass:"color-info font-exs"},[e._v(e._s(e.detail.updatedAt))])])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"权限："}},e._l(e.permissionList,(function(t){return a("div",{key:t.module},[a("span",{staticClass:"font-es font-weight-700"},[e._v(e._s(e.permissionEnum[t.module])+"：")]),e._v(" "),a("span",{domProps:{textContent:e._s(e.format(t.permissions))}})])})),0),e._v(" "),a("el-form-item",{attrs:{label:"审批流程："}},[a("div",[a("el-timeline",e._l(e.detail.auditUsers,(function(t){return a("el-timeline-item",{key:t.level},[a("h5",[e._v("\n            "+e._s(t.range?"会签":"或签")+"·\n            "),"finished"===e.checkState(t)?a("span",[e._v("已完成")]):a("span",{staticClass:"color-primary"},[e._v("进行中")])]),e._v(" "),e._l(t.userList,(function(t){return a("div",{key:t.uuid},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n              "+e._s(t.name)+"\n            ")])],1)}))],2)})),1)],1)]),e._v(" "),a("div",{staticClass:"text-align-center"},["TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleAudit(e.action="reject")}}},[e._v("拒绝")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleAudit(e.action="access")}}},[e._v("通过")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]):e._e()],1)],1)},v=[],b=(a("7514"),a("456d"),a("fba9")),y=a("550c8"),_=a("6424"),C=a("1882"),x={inject:["reload"],props:{transfer:{type:Object,default:function(){return{}}}},components:{AsyncUserTag:b["a"],VideoCover:y["a"],TagsDrawer:_["a"],IconTooltip:C["a"]},data:function(){return{form:{name:"",code:"",org:""},detail:{},permissionList:[],tags:[],rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},computed:Object(s["a"])({},Object(o["c"])({auditState:function(e){return e.enum.auditState},matchFormat:function(e){return e.enum.matchFormat},permissionEnum:function(e){return e.enum.roleDetail},auditSetting:function(e){return e.sensitive.auditSetting},currentUserUuid:function(e){return e.user.uuid}})),watch:{transfer:{handler:function(e,t){this.initData(e.uuid)},immediate:!0,deep:!0}},created:function(){},mounted:function(){},methods:{initData:function(e){var t=this;this.$store.dispatch("audit/getDetail",e).then((function(e){t.detail=Object(s["a"])(Object(s["a"])({},e),{},{auditUsers:t.parse(e.auditUsers),tagBeforeChangeContent:e.tagBeforeChangeContent?t.groupingTags(t.parse(e.tagBeforeChangeContent)):[],tagChangeContent:e.tagChangeContent?t.groupingTags(t.parse(e.tagChangeContent)):[]}),t.permissionList=t.grouping(e.toPermissions)})).catch((function(e){t.$message({type:"error",message:e})}))},parse:function(e){return JSON.parse(e)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleAudit:function(e){var t=this,a=this.transfer.uuid,i=null;i="reject"===e?{auditConfirmation:"AUDIT_FAILED",uuids:[a]}:{auditConfirmation:"APPROVED",uuids:[a]},this.$store.dispatch("audit/batchAuditTagConfirmation",i).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.handleCancel(),t.handleRefresh()}})})).catch((function(e){t.$message({type:"error",message:e})}))},handleRefresh:function(){this.$bus.$emit("handleRefresh")},checkState:function(e){return e.range?e.userList.some((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished":e.userList.every((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished"},grouping:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.module===e.module}));if(a)a.permissions.push(t);else{var i={module:t.module,permissions:[t]};e.push(i)}return e}),[]):[]},groupingTags:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.groupId===e.groupId}));if(a)a.tags.push(t);else{var i={groupId:t.groupId,groupName:t.groupName,tags:[t]};e.push(i)}return e}),[]):[]},format:function(e){var t=[];return t=e.map((function(e){return e.title})),t.join("、")},currentUserState:function(e){var t=this,a=!1;return e.forEach((function(e){e.userList.forEach((function(e){e.uuid===t.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(a=!0))}))})),a}}},$=x,k=(a("eda8"),Object(d["a"])($,g,v,!1,null,"33c231a2",null)),T=k.exports,w={components:{AuditTemplate:T},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},S=w,D=Object(d["a"])(S,h,p,!1,null,null,null),E=D.exports,L=a("8690"),A={components:{ListHeader:f,FormDialog:E,ToolBar:L["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,auditConfirmation:"",auditType:"TAG",handlerId:"",submitterId:""},sortConfig:{prop:"auditState",order:"ascending"},selects:[]}},watch:{},computed:Object(s["a"])({},Object(o["c"])({auditStateEnum:function(e){return e.enum.auditState},permissionMap:function(e){return e.permission.permissionMap},loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.auditTaglist},page:function(e){return e.sensitive.auditTagPage},tagOperationType:function(e){return e.enum.tagOperationType}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/getAuditTaglistAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.auditConfirmation,a=e.handlerId,i=e.submitterId;this.query.auditConfirmation=t||this.query.auditConfirmation,this.query.handlerId=a||this.query.handlerId,this.query.submitterId=i||this.query.submitterId,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleBatch:function(e){if(this.selects.length){var t=this.selects,a=null;"reject"===e?(t=this.selects,a={auditConfirmation:"AUDIT_FAILED",uuids:t}):(t=this.selects,a={auditConfirmation:"APPROVED",uuids:t}),this.batchAudit(a)}else this.$message({type:"warning",message:"请至少选择一项"})},batchAudit:function(e){var t=this;this.$store.dispatch("audit/batchAuditTagConfirmation",e).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.initDataList(t.query)}})})).catch((function(e){t.$message({type:"error",message:e})}))},handleAudit:function(e){this.$refs["formDialog"].event="AuditTemplate",this.$refs["formDialog"].eventType="audit",this.$refs["formDialog"].transfer={uuid:e},this.$refs["formDialog"].dialogVisible=!0},selectable:function(e,t){var a=this,i=!1;return e.auditUsers.forEach((function(e){e.userList.forEach((function(e){e.uuid===a.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(i=!0))}))})),"TO_BE_REVIEWED"===e.auditState&&!i},sortMethod:function(e,t){return"TO_BE_REVIEWED"===e.auditState?-1:"TO_BE_REVIEWED"===t.auditState?1:e.auditState===t.auditState?0:void 0},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},U=A,q=(a("d9fb"),a("f37f"),Object(d["a"])(U,i,n,!1,null,"72bdfc6e",null));t["default"]=q.exports},5085:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"条记录"},on:{handleExport:e.doExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"所属模块",align:"left",prop:"entity"}}),e._v(" "),a("el-table-column",{attrs:{label:"事件",align:"left",prop:"event"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.operator.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"时间",align:"left",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"}},[a("el-button",{attrs:{size:"mini",disabled:""}},[e._v("详情")])],1)],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("7f7f"),a("5530")),r=a("ecfe"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"发生时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH-mm-ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleChangeTime},model:{value:e.datePicker,callback:function(t){e.datePicker=t},expression:"datePicker"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{datePicker:[],query:{name:"",tagIds:"",userId:"",startTime:"",endTime:""}}},computed:Object(s["a"])({},Object(c["c"])({tagListAll:function(e){return e.tag.tagListAll},userListAll:function(e){return e.user.userListAll}})),methods:{handleChangeTime:function(e){e?(this.query.startTime=e[0],this.query.endTime=e[1]):(this.query.startTime="",this.query.endTime="")},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.$emit("handleRefresh")}}},d=u,m=(a("622a"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"0c154390",null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},b=[],y={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(c["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},_=y,C=Object(m["a"])(_,v,b,!1,null,null,null),x=C.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},k=[],T=(a("ac6a"),a("456d"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(c["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),w=T,S=Object(m["a"])(w,$,k,!1,null,null,null),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},L=[],A={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(c["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},U=A,q=Object(m["a"])(U,E,L,!1,null,null,null),O=q.exports,I={components:{CreateTemplate:x,EditTemplate:D,DistributeTemplate:O},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},j=I,R=Object(m["a"])(j,p,g,!1,null,null,null),N=R.exports,M=a("8690"),z={components:{ListHeader:h,FormDialog:N,ToolBar:M["a"],CustomerPagination:r["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,startTime:"",endTime:""}}},watch:{},computed:Object(s["a"])({},Object(c["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.logRecords.loading},listAll:function(e){return e.logRecords.logListAll},page:function(e){return e.logRecords.logListPage}})),created:function(){this.initDataList(this.query)},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getAllUserList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("logRecords/getLogListAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.tagIds,a=e.name,i=e.endTime,n=e.startTime;this.query.tagIds=t||this.query.tagIds,this.query.name=a||this.query.name,this.query.endTime=i||this.query.endTime,this.query.startTime=n||this.query.startTime,console.log(this.query),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList()},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},P=z,F=(a("960b"),a("caa7"),Object(m["a"])(P,i,n,!1,null,"1719550a",null));t["default"]=F.exports},"50bd":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABdCAYAAABtnm46AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAdtSURBVHgB7Z1NbttGFMffDEV9WHKqbdECoRdtYaBApEUbFF1EPUGcE8Q5gZ0TSDpB7BPEPkGdE8RZFC3aAlJWabIRsygKtEAr13b1QXKm74lyYif6oGKJXzM/wKAlUYLI+b//G74ZcRgoQqvVKg+gsM0Yu8MAKviUNX6pC8DaQoonEuTRN9VNGxSCQcqhhnd5aUdKsYsPy/PfwQ486TVVEUKqBfBL60VNMv4Y3kZ7ULqM8b2vbn3WhJSTSgFQ1A/Z2mM8uC24HrYjnXvfVr9sQ0pJnQB+fv5qB6RswGy7t/HQbf9facFch0hvWkiNAHy7N+rYoLUZux1gRO+/G9E/tF5VMuDtou3fn/FeG6Rofl3dPIAUkXgB+J28Yl1KuTtjt7YnxUOM4ONZn/Vj68W2wTiKaKYj2PhZ36XFDRItgAB238Xe//7t6mYDAtJqdcpD6JMb1GftJxnbE8LbT7oQEikAsmyTwaPZds+OMW8/+NAGQjew0A2+B79mMI3Ep4VECSCg3ZNFP5hn90EJkhYkwJHwU4wNCSMxAvi19XJLjKJ+akOM7D4L/b1qtdqFJUJuwAEaczqJgK83klY7iL0AfCs2Hq/S7hf7LvwpzOkkJiktxFYAAUu4GPXw4Hb1iyMIkZ9av+1yxuows9aQjNpBZALodDqWA2Zt2uu9vlPH5GpN/QAGdi5r7nMOS7X7oHiutIaOs4NfZFbBqZszjQOe4c/ffUGC6DLg9ucbn0ZaZQxdAK86f1Y48yiX10CDQpBtV7J7mxsf2xABoQrgZef3rQzmczzoAKNyaoFXLve+2Pgk1FRGhCaAF50/rCyDp3LxkTlFYN1T2duobmyEmtI4hITJeV03/ixkuQTZXQiZDIQEk15FzjAcwzDwL4PX0mmdoiDA8wS4rjt1D+7XGRoQIqEJABt/YkmVGjybzWHjh2ZGEcHxGNEJTRP6/QEOYYj39ojCISM969T4+XxegcZ/i3/Mudg4XaRnnqIhvZY/Hd/1TIgDkQmATkImE1oGih1x6e9EJgDODVAdzqNPfeok3xiitANo4oEWgOJoASiOFoDiaAEojhaA4mgBKI4WgOJoASiOFoDiaAEoTmKG48yMsdTa+dBxQZMQAZRvFKCQW+74ueN68PfJfyCEBJWJfQrImpmlNz5BjpLLqjsf4YIE9AHUjtBVE3sBDB0PXLTrZeMJMfps1UmEB/71zznksyYwvrxO4GDoKJ//icQkwT42mGb56DqA4mgBKI4WgOJoASiOFoDiaAEoTiIuA4uFLBTXshB3qK5w3hvS/Y0gKcReAAbncKOUhyRAP3IurxewcilGg01JIP6DQQkcsDGM5PziOfYCGAwckDI5JVsaY3BcAUkh9uElsPFpLKC0loNMzG8kQbeAOe8NRtukkAh/pRN6ctoDzfLRl4GKowWgOFoAiqMFoDhaAIqjBaA4WgCKowWgOFoAERKHEndkAph0s2TVUFoAQtDt09X9YQY1Pp2DqIk0BTiOunP9h8MBxIFIBUARMBjE40SEBUX+cDiMzYhhaAJgwCauhUNpoNfrjVbSSNK4/6LQsdGx0mIR01cNYaEvgRfiiiGS1serTXxtHBUE5+lcPyDI7xCxY/wMQiY8AUhoMjZZAJdR+webbA9CZmXhhrZuCcErjHkW55mbKAHr5LS3dXquJ3ZMYr1YgBulAt0Gp43B0sVgaQvhvvY81sZz2C2VSitZYfTaAkD7Lp+d9SuGIbGxM7fwi1cwii3cTlwc8t+zHmgRXOWj9TUorc2f+UziwDNuC+E9I2GUSnkUx/X6DQsLgCIb+zI1wzDujFf0tmBBLubO0dRpqajl070O6DY168X8tW5+NXYMFIZH/YfjQqFgL/T+eTtcRLhpGnfx/y3Qiz/GHRub9Rhd+EmxmJu7FO1UAZye9mqZjHGfGn2anWvijd+XYEeu6x2urxeOJ+3Drr5Blvt9dwf74tugIz1t2NiuTUwRB5effCOA8/PBFudAy7pboEkz9mUhjATQ7w8fYfSHvnCxJkp4o1Awm2wwcOpYk2+ARjkw6B+yXm/QAW37SoKd+y7HnqLu4SsKXSVwzmUTNEqCqf9w1AnE6l4DOwV10CgD5v/9tbX87pvLQBTB9lgEFmjSjI2X+w9zOb9K+F4lUAshtdho+of5fH7v8gDS1FIwCqEmBGwzxu/qUnAyuSgF40DRIRZ+jiftE2gYiqqEqB6sFHIcAdTOEHNszO9PGJNHGO1zh4s/aDgYN+QONXSH0fg/aKLEptE/z/OeGcYKhoPn4Q8g9Su4RSEYI4fQolg+ZOe4sf3xf/c5bYNE+DxWNiXs7OysYhhG2RcGt8gtSCxaHHOx/Qke8jWmXfzfwF67aC8a2UGJZAruOI3QnMEyzRkkgeBXuYlqJsFQh9NKW8dzPM8Po5XZMGpkcUINLARFsNfGYOmuqpFnEes52P70M69MTkKPPQ8srFyiSNjoMefGzfGu1tV3yiuPqdy9qKDeNti7z/mWi0J9878Q3mvaYserSw2KboclVjGybHo+ioYNyv/qLSsCd6wCwAAAAABJRU5ErkJggg=="},"50cd":function(e,t,a){"use strict";var i=a("b997"),n=a.n(i);n.a},5129:function(e,t,a){},5186:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"app-container"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:16}},[i("el-card",{staticClass:"left-top-info"},[e.externalUserDetail.externalUserDetail?i("div",{staticClass:"info-name display-flex align-items-center"},[i("el-image",{staticStyle:{width:"64px",height:"64px","border-radius":"100%"},attrs:{src:e.externalUserDetail.externalUserDetail.externalUserAvatar?e.externalUserDetail.externalUserDetail.externalUserAvatar:e.defaultAvatar,alt:""}}),e._v(" "),i("div",{staticStyle:{"margin-left":"10px"}},[e.externalUserDetail.externalUserDetail?i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v("\n                "+e._s(e.externalUserDetail.externalUserDetail.externalUserName)+"\n              ")]):e._e(),e._v(" "),i("span",{staticClass:"tips"},[e._v(e._s("WX"==e.externalUserDetail.externalUserDetail.wxType?"@微信":"@企业微信"))])])],1):e._e(),e._v(" "),i("div",{staticClass:"tag-container"},[i("h4",[e._v("\n              企业标签\n              "),i("span",{staticClass:"side-title"},[i("span",[e._v("最新更新"+e._s(e.externalUserDetail.updatedAt))]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEditTags(e.externalUserDetail.externalUserDetail.externalUuid)}}},[e._v("编辑")])],1)]),e._v(" "),e.externalUserDetail.externalUserDetailCorpTagsList&&null!=e.externalUserDetail.externalUserDetailCorpTagsList.corpTags?i("div",{staticClass:"tag-line"},e._l(e.externalUserDetail.externalUserDetailCorpTagsList.corpTags,(function(t,a,n){return i("span",{key:n,staticStyle:{display:"inline-block"}},[i("span",{staticClass:"group-name"},[e._v(e._s(a)+"：")]),e._v(" "),e._l(t,(function(t){return i("el-tag",{key:t.tagId,staticStyle:{"margin-right":"5px","margin-bottom":"5px"},attrs:{type:"info",size:"mini"}},[e._v(e._s(t.tagName))])}))],2)})),0):i("span",{staticClass:"no-tag-tip"},[e._v("暂无企业标签")])]),e._v(" "),i("div",{staticClass:"info-container"},[i("h4",[e._v("客户资料")]),e._v(" "),i("div",[i("el-row",e._l(e.externalUserDetail.externalUserDetailPublic,(function(t,a){return i("el-col",{key:a,attrs:{span:8},nativeOn:{click:function(e){e.stopPropagation()}}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between"},on:{mouseenter:function(i){return e.mouseEnter(t,a)}}},[i("span",{staticClass:"label"},[e._v(e._s(t.label)+"：")]),e._v(" "),e.currentInput===t.label?i("el-input",{attrs:{size:"mini",placeholder:t.value},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):i("span",{staticClass:"value"},[e._v(e._s(t.value?t.value:"--"))]),e._v(" "),t.label==e.currentIndex||e.currentInput===t.label?i("span",{staticClass:"edit-info",on:{click:function(i){return i.stopPropagation(),e.editInfo(t,a)}}},[e.currentInput===t.label?i("span",[e._v("保存")]):i("i",{staticClass:"el-icon-edit"})]):e._e()],1)])})),1)],1)])]),e._v(" "),i("el-card",{staticClass:"content-spacing"},[i("h4",{staticStyle:{"font-size":"14px"}},[e._v("所属客服")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.externalUserDetail.externalUserDetailUsersList,stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[i("el-table-column",{attrs:{label:"所属员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"display-flex align-items-center"},[i("el-image",{staticStyle:{width:"24px",height:"24px"},attrs:{src:t.row.avatar,lazy:"",alt:""}}),e._v(" "),i("span",{staticClass:"ml"},[e._v(e._s(t.row.name))])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"来源",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.addWay?e.externalUserAddwayType[t.row.addWay]:"--"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"添加渠道",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.contactWay?i("span",[e._v(e._s(t.row.contactWay.remark?t.row.contactWay.remark:"--"))]):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"对客户的描述",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v(e._s(t.row.description||"--"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"个人标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.individualTags?i("div",e._l(t.row.individualTags,(function(t,a){return i("el-tag",{key:a,staticStyle:{"margin-right":"3px"},attrs:{size:"mini",type:"primary"}},[e._v(e._s(t.tagName))])})),1):i("span",[e._v("--")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"最近联系时间",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v(e._s(t.row.lastMsgTime?t.row.lastMsgTime:"--"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("el-button",{attrs:{size:"mini",type:"primary",disabled:null==t.row.lastMsgTime},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v("聊天记录")])],1)]}}])})],1)],1)],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-card",{staticClass:"group-chart"},[i("h4",{staticClass:"font-es"},[e._v("所在群聊")]),e._v(" "),e.externalUserDetail.externalUserDetailGroupChatsList&&e.limitedListGroup.length>0?i("div",[e._l(e.limitedListGroup,(function(t,a){return i("div",{key:a,staticClass:"has-group flex-between-alinecenter"},[i("div",{staticClass:"group-list flex-between-alinecenter"},[i("div",{staticClass:"group-list-left flex-column-center-alinecenter"},[i("svg-icon",{staticClass:"svg-icon",attrs:{"icon-class":"groupChat"}}),e._v(" "),i("p",{staticStyle:{margin:"0px"}},[e._v("群聊")])],1),e._v(" "),i("div",{staticClass:"group-item-info"},[i("p",{staticStyle:{margin:"0px"}},[e._v(e._s(t.name)+" "+e._s(t.lastGroupChatTime?t.lastGroupChatTime:""))]),e._v(" "),i("div",{staticClass:"group-item-content display-flex align-items-center"},[i("span",[e._v("群主：")]),e._v(" "),i("strong",[e._v(e._s(t.owner?t.owner:"--"))]),e._v(" "),i("i",[e._v("|")]),e._v(" "),i("span",[e._v("共 "+e._s(t.number)+" 位成员")])])])]),e._v(" "),i("span",{staticClass:"check-chatting-detail",on:{click:function(a){return e.handleGroupRouter(t)}}},[e._v("查看")])])})),e._v(" "),i("div",{staticClass:"open-all",on:{click:e.unlimited}},[e.limited?i("span",[e._v("展开全部 "+e._s(e.externalUserDetail.externalUserDetailGroupChatsList.length)+"个群聊")]):i("span",[e._v("收起")])])],2):i("div",{staticClass:"no-group"},[i("div",{staticClass:"no-group-view"},[i("img",{attrs:{src:a("5c7f"),alt:""}}),e._v(" "),i("p",[e._v("该客户不在任何群聊内")])])])]),e._v(" "),i("el-card",{staticClass:"content-spacing"},[i("div",{staticClass:"flex-between-alinecenter"},[i("h4",{staticClass:"font-es"},[e._v("客户动态")]),e._v(" "),i("el-t-button",{staticStyle:{margin:"auto 0"},attrs:{type:"primary",popAuth:!0,size:"mini",auth:e.permissionMap["externalUserTrends"]["externalUserTrends_add"]},on:{click:e.handleCreate}},[e._v("添加动态")])],1),e._v(" "),i("div",{staticClass:"member-status-content margin-top-20"},[e.externalUserTrendsListAll.length>0?i("div",[i("el-timeline",e._l(e.externalUserTrendsListAll,(function(t,a){return i("el-timeline-item",{key:a,attrs:{timestamp:"发布于"+t.updatedAt,placement:"top"}},[i("el-card",[i("div",{staticClass:"word-break"},[e._v(e._s(t.remark))]),e._v(" "),i("p",{staticStyle:{margin:"0px","text-align":"right"}},[i("el-t-button",{directives:[{name:"show",rawName:"v-show",value:t.editable,expression:"item.editable"}],staticClass:"ml-10",attrs:{popAuth:!0,auth:e.permissionMap["externalUserTrends"]["externalUserTrends_update"],type:"text"},on:{click:function(a){return e.handleEditTrend(t)}}},[e._v("编辑")]),e._v(" "),i("el-t-button",{directives:[{name:"show",rawName:"v-show",value:t.editable,expression:"item.editable"}],staticClass:"ml-10",attrs:{popAuth:!0,auth:e.permissionMap["externalUserTrends"]["externalUserTrends_delete"],type:"text"},on:{click:function(a){return e.handleDeleteTrend(t)}}},[e._v("删除")])],1)])],1)})),1),e._v(" "),i("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1):i("div",{staticClass:"no-member-status"},[e._v("暂无动态")])])])],1)],1),e._v(" "),i("form-dialog",{ref:"formDialog"})],1)])},n=[],s=(a("96cf"),a("1da1")),r=a("5530"),l=a("405a"),o=a.n(l),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"","min-width":"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer,uuid:e.uuid}})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"自定义动态"}},[a("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":""},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark","string"===typeof t?t.trim():t)},expression:"form.remark"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-t-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},m=[],f=a("2f62"),h={inject:["reload"],data:function(){return{hasParent:!1,form:{remark:"",externalUserId:""}}},computed:Object(r["a"])({},Object(f["c"])({externalUserDetail:function(e){return e.externalUser.externalUserDetail}})),mounted:function(){var e,t;this.form.externalUserId=null===(e=this.externalUserDetail)||void 0===e||null===(t=e.externalUserDetail)||void 0===t?void 0:t.externalUserId},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("externalUser/addExTrends",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){this.reload(),console.log("刷新")}}},p=h,g=a("2877"),v=Object(g["a"])(p,d,m,!1,null,null,null),b=v.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"自定义动态"}},[a("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":""},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark","string"===typeof t?t.trim():t)},expression:"form.remark"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-t-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},_=[],C={props:{transfer:{type:Object,default:function(){}}},inject:["reload"],data:function(){return{hasParent:!1,form:{remark:"",externalUserId:"",uuid:0}}},computed:Object(r["a"])({},Object(f["c"])({externalUserDetail:function(e){return e.externalUser.externalUserDetail}})),watch:{transfer:{handler:function(e,t){console.log(e),this.form.uuid=e.uuid,this.form.remark=e.remark},immediate:!0}},mounted:function(){var e,t;this.form.externalUserId=null===(e=this.externalUserDetail)||void 0===e||null===(t=e.externalUserDetail)||void 0===t?void 0:t.externalUserId},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("externalUser/updateExTrends",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){this.reload(),console.log("刷新")}}},x=C,$=Object(g["a"])(x,y,_,!1,null,null,null),k=$.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form"},[a("tags-selected",{attrs:{tagListSelect:e.tagListSelect,checkboxGroup:e.checkboxGroup},on:{change:e.handleCheckedTagsChange}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-t-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},w=[],S=a("fbff"),D={props:{uuid:{type:String}},components:{TagsSelected:S["a"]},data:function(){return{checkboxGroup:[],delTags:[],addTags:[],newTagsList:[]}},computed:Object(r["a"])({},Object(f["c"])({tagListSelect:function(e){return e.tag.tagListSelect},editTagsUuid:function(e){return e.externalUser.editTagsUuid}})),watch:{},created:function(){this.checkboxGroup=this.editTagsUuid,console.log(this.checkboxGroup,"ffff")},mounted:function(){},methods:{handleCheckedTagsChange:function(e,t){console.log(e,"tag"),this.checkboxGroup=e},del:function(e,t){return e.filter((function(e){return-1==t.indexOf(e)}))},add:function(e,t){return e.filter((function(e){return-1==t.indexOf(e)}))},handleConfirm:function(){var e=this;this.delTags=this.del(this.editTagsUuid,this.checkboxGroup),this.addTags=this.add(this.checkboxGroup,this.editTagsUuid),console.log("删除",this.delTags,"新增",this.addTags);var t={addTags:this.addTags,externalUserUuid:this.uuid,removeTags:this.delTags};console.log(t,"99"),this.$store.dispatch("externalUser/externalUserUpdateTag",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("externalUser/getExternalUserDetail",this.$route.params.uuid+"").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}},E=D,L=(a("0208"),Object(g["a"])(E,T,w,!1,null,"5b0faf6c",null)),A=L.exports,U={components:{CreateTemplate:b,EditTemplate:k,EditTagsTemplate:A},data:function(){return{dialogVisible:!1,event:"CreateTemplate",eventType:"",transfer:"",uuid:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(f["c"])({})),updated:function(){},methods:{genTitle:function(){return"create"===this.eventType?"添加动态":"edit"===this.eventType?"编辑动态":"distribute"===this.eventType?"添加动态":"editTags"===this.eventType?"标签编辑":void 0},close:function(){this.event=""}}},q=U,O=Object(g["a"])(q,c,u,!1,null,null,null),I=O.exports,j=a("61f7"),R={components:{FormDialog:I},inject:["reload"],data:function(){return{reflect:{source:"来源",qq:"QQ",remarkMobile:"电话",age:"年龄",birthday:"生日",microBlog:"微博",address:"地址",email:"邮箱",createtime:"时间"},currentIndex:"",currentInput:"",inputValue:"",limited:!0,pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,uuid:"",startTime:"",endTime:""}}},watch:{},computed:Object(r["a"])(Object(r["a"])({},Object(f["c"])({loading:function(e){return e.externalUser.loading},listGroup:function(e){return e.externalUser.listGroup},externalUserDetail:function(e){return e.externalUser.externalUserDetail},externalUserTrendsListAllPage:function(e){return e.externalUserTrends.externalUserTrendsListAllPage},externalUserTrendsListAll:function(e){return e.externalUserTrends.externalUserTrendsListAll},permissionMap:function(e){return e.permission.permissionMap},externalUserAddwayType:function(e){return e.enum.externalUserAddwayType}})),{},{externalUserTrends:function(){var e,t;return null===(e=this.externalUserDetail)||void 0===e||null===(t=e.externalUserTrends)||void 0===t?void 0:t.items},defaultAvatar:function(){return o.a},limitedListGroup:function(){return this.limited?this.externalUserDetail.externalUserDetailGroupChatsList.length>0?this.externalUserDetail.externalUserDetailGroupChatsList.slice(0,1):[]:this.externalUserDetail.externalUserDetailGroupChatsList}}),created:function(){var e=this.$route.params.uuid;this.query.uuid=e,this.initDetail(this.$route.params.uuid),this.initExternalUserTrendsListAll(this.query)},mounted:function(){var e=this;document.addEventListener("click",(function(){e.currentInput="",e.currentIndex=""}))},methods:{initDetail:function(e){var t=this;this.$store.dispatch("externalUser/getExternalUserDetail",e).then((function(){})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},initExternalUserTrendsListAll:function(e){var t=this;this.$store.dispatch("externalUserTrends/getExternalUserTrendsListAll",e).then((function(){t.pageConfig.pageNumber=t.externalUserTrendsListAllPage.pageNumber+1,t.pageConfig.total=t.externalUserTrendsListAllPage.total})).catch((function(e){console.error(e),t.$message({type:"error",message:e||"初始化失败"})}))},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initExternalUserTrendsListAll(this.query)},handleEditTags:function(e){var t,a;this.$refs["formDialog"].event="EditTagsTemplate",this.$refs["formDialog"].eventType="editTags",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].uuid=e+"",(null===(t=this.externalUserDetail)||void 0===t||null===(a=t.externalUserDetailCorpTagsList)||void 0===a?void 0:a.corpTags)&&this.$store.commit("externalUser/SAVE_EDITTAGSUUID",this.externalUserDetail.externalUserDetailCorpTagsList.corpTags)},handleDetail:function(e){var t=e.userId,a={uuid:this.query.uuid,userId:t};this.$router.push({path:"/message/singleListAll",query:a})},handleGroupRouter:function(e){console.log(e),this.$router.push({path:"/externalUser/groupDetail",query:{chatId:e.groupId}})},mouseEnter:function(e,t){this.currentIndex=e.label},editInfo:function(e,t,a){var i=this;if(this.currentIndex==this.currentInput){if("手机号"==e.label&&!Object(j["b"])(this.inputValue))return void this.$message({message:"请输入正确的手机号",type:"warning"});if(this.inputValue!=e.value){var n={externalUserUuid:this.query.uuid,propertyDtoList:[{propertyUuid:e.propertyUuid,sort:0,value:this.inputValue}]};this.$store.dispatch("externalUser/propertyUpdateExternalUserProperty",n).then((function(e){i.currentInput="",i.inputValue="",i.$message({type:"success",message:"操作成功"}),i.initDetail(i.query.uuid)})).catch((function(e){console.log(e),i.$message({type:"error",message:e})}))}else this.currentInput="",this.inputValue=""}else this.currentInput=e.label},unlimited:function(){var e=this.limited;this.limited=!e},handleCreate:function(){this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create"},handleEditTrend:function(e){console.log(e),this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].transfer=e},handleDeleteTrend:function(e){var t=this,a={uuid:e.uuid};this.$confirm("是否删除当前动态","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("externalUser/deleteExTrends",a).then((function(){t.$message({type:"success",message:"操作成功"}),t.query.page=0,t.initExternalUserTrendsListAll(t.query)})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleScroll:function(){var e=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.clientHeight||document.body.clientHeight,a=document.documentElement.scrollHeight||document.body.scrollHeight;if(e+t==a){if(!(this.pageno<=this.totalnum))return;console.log("8888")}},load:function(){var e=Math.ceil(this.page.total/this.page.pageSize);this.query.page++,this.query.page,this.query.page<e&&(console.log("0009999"),this.initExternalUserTrendsListAll(this.query,"push"))}}},N=R,M=(a("fab0"),Object(g["a"])(N,i,n,!1,null,"8ad0f806",null));t["default"]=M.exports},"53e3":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"条记录"},on:{handleExport:e.doExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"触发内容",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.sensitive.word))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"触发员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:i.triggerUser.uuid}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n              "+e._s(i.triggerUser.name)+"\n            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"触发时间",align:"left",prop:"createdAt"}})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)])],1)},n=[],s=a("5530"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"敏感词："}},[a("el-input",{model:{value:e.query.word,callback:function(t){e.$set(e.query,"word","string"===typeof t?t.trim():t)},expression:"query.word"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"触发员工"}},[a("el-select",{attrs:{filterable:""},model:{value:e.query.userUuid,callback:function(t){e.$set(e.query,"userUuid",t)},expression:"query.userUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"触发时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH-mm-ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleChangeFirst},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{value:[],query:{startTime:"",endTime:""}}},computed:Object(s["a"])({},Object(o["c"])({userListAll:function(e){return e.user.listSelect}})),methods:{handleChangeFirst:function(e){this.query.startTime=e[0],this.query.endTime=e[1]},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query}}},u=c,d=a("2877"),m=Object(d["a"])(u,r,l,!1,null,null,null),f=m.exports,h=a("ecfe"),p=a("fba9"),g=a("8690"),v={components:{ListHeader:f,AsyncUserTag:p["a"],ToolBar:g["a"],CustomerPagination:h["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,word:"",userUuid:"",startTime:"",endTime:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.logListAll},page:function(e){return e.sensitive.logListAllPage}})),created:function(){this.initDataList(this.query),this.initFilter()},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/getLog",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.startTime,a=e.endTime,i=e.userUuid,n=e.word;this.query.startTime=t||this.query.startTime,this.query.endTime=a||this.query.endTime,this.query.userUuid=i||this.query.userUuid,this.query.word=n||this.query.word,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},b=v,y=(a("f6d6"),a("aa6b"),Object(d["a"])(b,i,n,!1,null,"efa44ac0",null));t["default"]=y.exports},"54c6":function(e,t,a){"use strict";var i=a("3d64"),n=a.n(i);n.a},"550c8":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.coverImage?a("el-image",{attrs:{fit:"contain",lazy:"",src:e.coverImage}}):a("video",{ref:"videoZoom",attrs:{width:"0",height:"0",src:"/api/public/file/"+e.alterUrl}})},n=[],s={props:{url:{type:String,default:""}},data:function(){return{coverImage:""}},computed:{alterUrl:function(){return this.url}},mounted:function(){var e=this;this.$nextTick((function(){var t=e.$refs["videoZoom"];t.currentTime=1;var a=document.createElement("canvas");t.oncanplay=function(){a.width=t.videoWidth,a.height=t.videoHeight,a.getContext("2d").drawImage(t,0,0,a.width,a.height);var i=a.toDataURL("image/jpeg");e.coverImage=i}}))}},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["a"]=o.exports},"55fd":function(e,t,a){"use strict";var i=a("2836"),n=a.n(i);n.a},5658:function(e,t,a){},5781:function(e,t,a){},"585a5":function(e,t,a){},"5abb":function(e,t,a){"use strict";var i=a("e428"),n=a.n(i);n.a},"5b4b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\tag\\listAllTag\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"5be5":function(e,t,a){},"5c7f":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALkAAACICAYAAAC7i0pUAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAA20SURBVHgB7Z1rbhvXFYDPvUPxoZfJJHWrJI1HRYPAQQtLf1IU/WFqBVFWEHkFSVcQeQWBVyB5BZZXYOZXgfyolT812jTlGEFLx4+IelB8zr09Z0gqJEWJrxnO8PJ8AE1qNCJN8pszZ+7jXACGYRiGYRiGYRiGYRiGYRiGYRjGWAREjKf5fHoZEjtCyLsAegOYcXC0Vt80QO7fXl9zYM6JlOT55y++UBp2Neg0MP4gYL+u4P48yx4JySl6r4jkI3yYBcZ38Et2ahq25lV0CRFgRaT2gAUPDA1gxwU8eZYv2DCHxCBk/pUv7ODXsH3V74UQYFmWd5MyEsfkzKEwB1TKtYXboGCyBXNG6OnKD04hT5Gm3+8WFhYgFot5ojP+oEHs11z3/vpaxoE5IVR7/p3/7zYI+ah3O0kdjycwenPkDgin6qqteRE9ZItEtt/WeHyBBQ8WO2HJJ/nCkQ1zQLgmCXGndxOlJ5YV+qXCPICiW3swB0QuXFIezkwLnf2xcJQFw4mU5HyROX3w494Gw4mU5NxEOH3wM/8UDCdSVgnBkoeADYbDVjHGw5IzxsOSM8bDkjPGw5IzxsOSM8bDkjPGw5IzxsOSM8bDkjPGw5IzxsOSM8bDsxOYvhQKR3ZjwOAtYUGxXgJnfT1ThAjDkjN9URJ2YlJ+NWg/axkPiFcnOVe7D9+/mdmHCMLpCuMDOmsJuVd4fZwvRHDeKEvO+IcGW0mRf/b9j0++ffpsByICS874ipQCVldXsrHYwt63h//M/+3pMxtChiVnfIdEfytzgx7amMY8RdGzECIsORMIiUTcuyFpFP1RmBGdJWcCI5VMth+i6OHVeGHJmcBIxDtr6OhsWGnL3Ei+ELMwssQhvhBc14AUApKJBe9mBVheo/O9yAjXqZE9pf4sEKHUeDG+M2gpFYeVpURX0SLXVVCu1uG0VAU/INFurCQ9uTupN1w4Oi6DqxT4QTIRg9WlFFhWt9hn51Xf3kugCHEXQsDoSE5yry4nL1XlomKiy4sJSK8kYVIoYr+TWb4kOEER9523lvB+8o+Z3ktmdfGS4AS9l7fTizADhLJMjrGSk2D05V8HnfKXFuMwCSRfP/HaUJQnOalZbVzoQBr0Xih1GbTPvGKs5CtDfuGpxPiSk3yp5OACpXTmSCXGL2RKB9IwTHrAmoqxksfj1lD7USoxbpQdJQ2JxYb7/0zyOnTWsCJUTzJmjf+e/YSbEIGW2xhPcjEloUapEcmLF1zG2E+EWjaGQWk9duuH6w73Gs19x29haTSGf53GCP+necFYyau14b7sSrUB41Kru3iA6KH2pSbLcSnXhvvb80rdW+ktwnDrip+cl2sDBaQITm3Mk3ByWh64D7VhTxLJyyhvrX79wajxjDTpe5kCLLmfUBrypli6UnQS/Oj4fCL5iEqtASdnlSt/X8KDzQ/5qFPpKtHpvXjv1fWn08k0jO7xpC/95ZtTr5kvGV/wWlFoG+XrlD74dWonkUl2aiZMxGPe85J4lAoNisDD0jxoz733kcCezxheYNLr0PP7+V5MZC7meNLpnm5BQgcPReygU4YK5ueVWrDvxTS4vYkxHpacMR6WnDEelpwxHpacMR6WnDEelpwxHpacCZRJhhj7BUvOGA9LzhgPS84YD0vOTJW//+M/t2DKsOSM8bDkjPGw5IzxRExyHvjP+E+kJKd5isy00TkwnJAlF11L4zUa/kwVY4YHA8s3YDjhSq7V884flVIj1TJhJqemYB8MJ1TJNYiD3m31Os9fnBZaq/vraxkHDCdUyT9cX8vhXa5zG0VzFn0KCH3w3q8zuzAHhH7hidea93u3keQsenBgBH9YPdP3rtvHktYdMITQJadofpXo5XKZC+b4iAZ92KirzzCC76yvZ4rX7atA2+ADUagHE4m6Kyj67vf5AggBXWu5U5NitVrxVoqQ0vKKA41S4ZWYxnhm/Br3IaJopY7xE3NcDYe/Xcvkhvmb1tLhG+ADSoUfpCK1qtKzfMFGJXfR5c/BJxYXg11mRIG69/7NzD4YxE+vT/aU1jswIbVaHX569aZr2ycbH03duUguHdaSPStA2VLK0UatabGNp+WLwpJBSm6i4C9fHm24Qj4FH6hWa/Dy9c9d28KQPJJl4m6vrzkwZgrwg/M/PM0KX06111DEa4XPhj39zwqUprhSPvJrdEUFJe/hEELAuAFartbfQbAUMYJvmSb4j6+OsrAgn6DgNvhEtdYtOaZAzyEEjJPcAhFktPAExxQllIgUBCT3i9cnj2Lgr+BEvaeir8DWHQgB46raYj7udF5qYJvwyC0yVzCS4C/enH2Brx102jQ2QkMa/8liA1Y6iIFx5XLlUsuK6un4mxbGSV4HeTj+YoJXMpLghTenX2nl7kKE0Rf/BEPp/PIKHH/evJ2DEDAuXaGLVtEzunEiNDijCo4hbBfmGFrIq1zprtOO+fhjCAlDZwYpB/wABa8qFnxUTk7PLm3D5uB9CAkjJfelhaUl+LCj9FjwJpSm9ElVnD9tfnwAIWGk5BO3sLDgY0HrFxWPTy//Qqv7ECJGrhnU28Iy4h+PJPiLV6dfa6W+hDmHcvCfj44vj1XR+sEnm7f3IUSMlHzsFpZRI/jrkz1sJtyBGYfEHHe0YL3RgNOzkteF3wf8Hsq7EDKRHLviBz84L45oDEsqlRyunXxEwcOg8PJoB4TcA5/pN8ZkUmjMehwqX25ubvrX0jUmBi9xSC0sQ45hmQHBibWbmX0UHYIQvYdi6zYGIudq92FYbeL9MFZyamGRYgjJZ0TwNp7or2i8t/wKguPgk42P7oEhGFtBa6gWlhkTvM3ar2huZoAtFloZVabCWMmbLSzX/R4Oq+dqc1Znqwcpeh1cYwagEcZKTi0sdN9v9hUJXithBB8wzzHqBCX6Xzb/wJLPAleNYTFF8Db+iy5yYBiGV7XtHsNimuBtPNE1PAQ/0CroSSdTx+AmxIsxLF4LyziCl8tlu/0Y+zwuHksp09gOnO7dXwh/Jh0IoYtKdZ+FNF4kd+/jFi3L8vZJpVLO2s0bO4WXx9TzMeEkcG1UqkIYLXkiHs/TfcySh4uJ2ANYhO1SqWyjHDdoskBrNxvlpIkD3s+0nX7ufa7YpU8q2JOgNbCSxi+vXy7/Mqz1vFqHWn38epKmXXQSM9fjSTJWKpU0RVaKnHTrkNbGPey2qGXsyavjF766nIJ5gSb5nJVr4I5Q76Szx/OPH63n6EyCajiu6x7TGYRudOZYWlrCex/H6k+JyEnellgpuYEfrC1l7BZ41ZyErZS2+0XZq1D47WilMSrO14Iao4relnwplYTfffCbQc9dlFKQ+EX8Lg6VajzX2sKf605UD4LQJKd8t1dk/OAof7aBmZhRRG9L/nZmFd69+RZMQlN+cdg+AFxXHC4vJw/DlH8qkp+dnaG81kYsZt0hkTFab4wSkZnxoDMZiT5ohGFb8lvv3cTULphiTP3kX1lJ5WAK+C45RWjXhSwJjT9mR00xGH8ZRvS25L+334VUIg7ThMTHu5zW7nd4DYBRf9n3C9+JJW9LjRd/d/F4zQKnG5FjkOgk+Zufi/Dxhx9ABHAo2mMT7WO/pB9L8tPTcnZhwfoU045tYKlngutEJ8lLpfOBF50h4VAvLP6/Hy8tJcaaJzq05G2x8cV2OP2YTa4SnSR33cbEF51B08rrD0YVXlz/pNSc16BKUF+y2GbgqqbonVWzSPJUIhbYRWdAOM1xNu596vG9bse+kje7s71B+TvAGEev6CT56nJy6hed/iH2r5O9q5ekGblrX+Nm6g7fAcZILClgOfWL0FLKGRacoAUDZL5cru11jjdqcxHJKefGnsFHnJbMD7WGC+eVOo3t6ZJ+lkF/i5he/xWj+n57mxfJMXp/EYvJJyz4fBGPWSiAWUu9N8cwSYzo9Ys5sIJ6Iy1rwZflM5jZpFzBC8+kGZG8E6XgM2qFEZjHPGl14jCMaTipVGIdJa+adb5imA6SybgtqYEdGMZcjqUQ6gEwjJGIfRriK46OdDqRqFHLynAl1RhmNnDw0nOLOohkJiOK1Wp8y8RSBMx80hy+2xScfvbayUn0VIpED7dYOsNMCvbaP0gkFrY6u/gvjV1pTkuDXezq9W19e4YJHm+w1r1+41euHIXYll0I+Sn3hDJRpNkyqB8KoQ9Q7txV+w0cT96aPb8NYH3OnUZMNBA5rRuPaXzKMBOkR5oZ1BrhlWXhmenjpSNUUnp/0PjxS38JY0IR/vy8lsWL1W3M3+8CT4NjfKQ9C8h13W+WlpIHk5S08G22fjvKYx6fxTz+Dre7MyPieEuxoNSWBblRo/V1BFZ3pZXLezVWML3xIj2Lz7SgClyHlH5Q9a3FxXguyOJDU62g1S2+tCnic6Ehc2kXFNJeOWhFJeQOk8npV9OKRC3EtvxKSZRdbTTTHZHmAyD6tAb4OS2Zj5Wi0s/uYZTqIka+qi0dAKVSiSrXetJrLdJSWrfwV3ar3DJX6AqIVlFPr8IteCmGOqaIHPUCn70YsVhtuxIuPqQiomkqIkoHA50N8C3eap0V2nXHbZhvnOZdU1x6pJT7vF34Hy/6vO2YVhRnsUxzP4xdkXkQHbO6vXs6OGj1CCl1mg4Q2kYHB6ZON+hx8yARF2eMjoOmFxsmw+m/WTgdr90lIEnq7dGxQkVL1ovn87O1Ytb4P0rxctMOWuXUAAAAAElFTkSuQmCC"},"5d17":function(e,t,a){},"5e73":function(e,t,a){"use strict";var i=a("3dd5"),n=a.n(i);n.a},"5f1c":function(e,t,a){},6015:function(e,t,a){},6027:function(e,t,a){},6069:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditPermissionConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="accessed")}}},[e._v("批量通过")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditPermissionConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="reject")}}},[e._v("批量拒绝")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","default-sort":e.sortConfig,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:e.selectable}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"角色名称",prop:"roleName"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"提交人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.submitOperator.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"提交时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"获取权限类型与内容"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.toPermissions.length?a("div",e._l(e.grouping(i.toPermissions),(function(t){return a("div",{key:t.module,staticClass:"font-no-wrap"},[a("span",{staticClass:"font-es font-weight-700"},[e._v(e._s(e.permissionEnum[t.module])+"：")]),e._v(" "),a("span",{domProps:{innerHTML:e._s(e.format(t.permissions))}})])})),0):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"状态",sortable:"",prop:"auditState","sort-method":e.sortMethod,"sort-orders":["ascending","descending",null]},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",["TO_BE_REVIEWED"===i.auditState?a("span",{staticClass:"color-primary"},[e._v("审核中")]):"AUDIT_FAILED"===i.auditState?a("span",{staticClass:"color-danger"},[e._v("已拒绝")]):a("span",{staticClass:"color-success"},[e._v("已通过")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAudit(i.uuid)}}},[e._v("审核")])],1)]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("7514"),a("ac6a"),a("456d"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"审批人："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.handlerId,callback:function(t){e.$set(e.query,"handlerId",t)},expression:"query.handlerId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审批状态："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.auditConfirmation,callback:function(t){e.$set(e.query,"auditConfirmation",t)},expression:"query.auditConfirmation"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"提起人："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.submitterId,callback:function(t){e.$set(e.query,"submitterId",t)},expression:"query.submitterId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{handlerId:"",auditConfirmation:"",submitterId:""}}},computed:Object(s["a"])({},Object(o["c"])({userListSelect:function(e){return e.user.listSelect}})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=(a("5e73"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"485f5ee3",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},p=[],g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{"label-width":"150px","label-position":"left"}},[e.detail.submitOperator?a("el-form-item",{attrs:{label:"提交人："}},[a("div",{staticClass:"submit-item"},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:e.detail.submitOperator.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n        "+e._s(e.detail.submitOperator.name)+"\n      ")])],1),e._v(" "),a("div",{staticClass:"submit-item"},["TO_BE_REVIEWED"===e.detail.auditState?a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"APPROVED"===e.detail.auditState?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"AUDIT_FAILED"===e.detail.auditState?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e()],1),e._v(" "),a("div",{staticClass:"sumbit-item"},[a("span",{staticClass:"color-info font-exs"},[e._v(e._s(e.detail.updatedAt))])])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"权限："}},e._l(e.permissionList,(function(t){return a("div",{key:t.module},[a("span",{staticClass:"font-es font-weight-700"},[e._v(e._s(e.permissionEnum[t.module])+"：")]),e._v(" "),a("span",{domProps:{textContent:e._s(e.format(t.permissions))}})])})),0),e._v(" "),a("el-form-item",{attrs:{label:"审批流程："}},[a("div",[a("el-timeline",e._l(e.detail.auditUsers,(function(t){return a("el-timeline-item",{key:t.level},[a("h5",[e._v("\n            "+e._s(t.range?"会签":"或签")+"·\n            "),"finished"===e.checkState(t)?a("span",[e._v("已完成")]):a("span",{staticClass:"color-primary"},[e._v("进行中")])]),e._v(" "),e._l(t.userList,(function(t){return a("div",{key:t.uuid},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n              "+e._s(t.name)+"\n            ")])],1)}))],2)})),1)],1)]),e._v(" "),a("div",{staticClass:"text-align-center"},["TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleAudit(e.action="reject")}}},[e._v("拒绝")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleAudit(e.action="access")}}},[e._v("通过")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]):e._e()],1)],1)},v=[],b=a("fba9"),y=a("550c8"),_=a("6424"),C=a("1882"),x={inject:["reload"],props:{transfer:{type:Object,default:function(){return{}}}},components:{AsyncUserTag:b["a"],VideoCover:y["a"],TagsDrawer:_["a"],IconTooltip:C["a"]},data:function(){return{form:{name:"",code:"",org:""},detail:{},permissionList:[],tags:[],rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},computed:Object(s["a"])({},Object(o["c"])({auditState:function(e){return e.enum.auditState},matchFormat:function(e){return e.enum.matchFormat},permissionEnum:function(e){return e.enum.roleDetail},auditSetting:function(e){return e.sensitive.auditSetting},currentUserUuid:function(e){return e.user.uuid}})),watch:{transfer:{handler:function(e,t){this.initData(e.uuid)},immediate:!0,deep:!0}},created:function(){},mounted:function(){},methods:{initData:function(e){var t=this;this.$store.dispatch("audit/getDetail",e).then((function(e){t.detail=Object(s["a"])(Object(s["a"])({},e),{},{auditUsers:t.parse(e.auditUsers)}),t.permissionList=t.grouping(e.toPermissions)})).catch((function(e){t.$message({type:"error",message:e})}))},parse:function(e){return JSON.parse(e)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleAudit:function(e){var t=this,a=this.transfer.uuid,i=null;i="reject"===e?{auditConfirmation:"AUDIT_FAILED",uuids:[a]}:{auditConfirmation:"APPROVED",uuids:[a]},this.$store.dispatch("audit/batchAuditPermissionConfirmation",i).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.handleCancel(),t.handleRefresh()}})})).catch((function(e){t.$message({type:"error",message:e})}))},handleRefresh:function(){this.$bus.$emit("handleRefresh")},checkState:function(e){return e.range?e.userList.some((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished":e.userList.every((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished"},grouping:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.module===e.module}));if(a)a.permissions.push(t);else{var i={module:t.module,permissions:[t]};e.push(i)}return e}),[]):[]},format:function(e){var t=[];return t=e.map((function(e){return e.title})),t.join("、")},currentUserState:function(e){var t=this,a=!1;return e.forEach((function(e){e.userList.forEach((function(e){e.uuid===t.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(a=!0))}))})),a}}},$=x,k=(a("ecf3"),Object(d["a"])($,g,v,!1,null,"49a78e47",null)),T=k.exports,w={components:{AuditTemplate:T},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"审核详情"}}},S=w,D=Object(d["a"])(S,h,p,!1,null,null,null),E=D.exports,L=a("ecfe"),A=a("8690"),U={components:{ListHeader:f,FormDialog:E,ToolBar:A["a"],CustomerPagination:L["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,auditConfirmation:"",auditType:"PERMISSION",handlerId:"",submitterId:""},sortConfig:{prop:"auditState",order:"ascending"},selects:[]}},watch:{},computed:Object(s["a"])({},Object(o["c"])({auditStateEnum:function(e){return e.enum.auditState},permissionMap:function(e){return e.permission.permissionMap},loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.auditPermissionlist},page:function(e){return e.sensitive.auditPermissionPage},permissionEnum:function(e){return e.enum.roleDetail},auditSetting:function(e){return e.sensitive.auditSetting},currentUserUuid:function(e){return e.user.uuid}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/getAuditPermissionlistAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.auditConfirmation,a=e.handlerId,i=e.submitterId;this.query.auditConfirmation=t||this.query.auditConfirmation,this.query.handlerId=a||this.query.handlerId,this.query.submitterId=i||this.query.submitterId,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleBatch:function(e){if(this.selects.length){var t=this.selects,a=null;"reject"===e?(t=this.selects,a={auditConfirmation:"AUDIT_FAILED",uuids:t}):(t=this.selects,a={auditConfirmation:"APPROVED",uuids:t}),this.batchAudit(a)}else this.$message({type:"warning",message:"请至少选择一项"})},batchAudit:function(e){var t=this;this.$store.dispatch("audit/batchAuditPermissionConfirmation",e).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.initDataList(t.query)}})})).catch((function(e){t.$message({type:"error",message:e})}))},handleAudit:function(e){this.$refs["formDialog"].event="AuditTemplate",this.$refs["formDialog"].eventType="audit",this.$refs["formDialog"].transfer={uuid:e},this.$refs["formDialog"].dialogVisible=!0},grouping:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.module===e.module}));if(a)a.permissions.push(t);else{var i={module:t.module,permissions:[t]};e.push(i)}return e}),[]):[]},format:function(e){var t=[];return t=e.map((function(e){return e.title})),t.join("、")},selectable:function(e,t){var a=this,i=!1;return e.auditUsers.forEach((function(e){e.userList.forEach((function(e){e.uuid===a.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(i=!0))}))})),"TO_BE_REVIEWED"===e.auditState&&!i},sortMethod:function(e,t){return"TO_BE_REVIEWED"===e.auditState?-1:"TO_BE_REVIEWED"===t.auditState?1:e.auditState===t.auditState?0:void 0},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},q=U,O=(a("afb4"),a("737c"),Object(d["a"])(q,i,n,!1,null,"6e58b4c4",null));t["default"]=O.exports},"609b":function(e,t,a){},"618c":function(e,t,a){"use strict";var i=a("6fab"),n=a.n(i);n.a},"61a7":function(e,t,a){"use strict";var i=a("14e8"),n=a.n(i);n.a},"61c2":function(e,t,a){},"61de":function(e,t,a){},"622a":function(e,t,a){"use strict";var i=a("d84b"),n=a.n(i);n.a},6238:function(e,t,a){},"62bb":function(e,t,a){"use strict";var i=a("16c5"),n=a.n(i);n.a},"62d8":function(e,t,a){"use strict";var i=a("f57a"),n=a.n(i);n.a},6363:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!0,hasImport:!1},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("span",{staticClass:"font-l"},[e._v(e._s(e.corpInfo.name))]),e._v(" "),a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["role"]["role_add"],size:"small",type:"text"},on:{click:e.handleChange}},[e._v("切换企业")])],1),e._v(" "),a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["role"]["role_add"],size:"small",type:"primary"},on:{click:e.handleCreate}},[e._v("新建角色")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.roleList,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{prop:"name",label:"角色名称",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.remark?a.remark:"--"))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["role"]["role_update"]},on:{click:function(a){return e.handlePermission(t.row)}}},[e._v("配置权限")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["role"]["role_update"]},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["role"]["role_delete"]},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=(a("7f7f"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"员工姓名"}},[a("el-input",{model:{value:e.query.userName,callback:function(t){e.$set(e.query,"userName","string"===typeof t?t.trim():t)},expression:"query.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在部门"}},[a("el-select",{on:{change:e.handleChangeSecond},model:{value:e.query.departmentsUuid,callback:function(t){e.$set(e.query,"departmentsUuid",t)},expression:"query.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"员工角色"}},[a("el-select",{on:{change:e.handleChangeThird},model:{value:e.query.roleUuid,callback:function(t){e.$set(e.query,"roleUuid",t)},expression:"query.roleUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{userName:"",departmentsUuid:"",roleUuid:""}}},computed:Object(r["a"])({},Object(c["c"])({userListAll:function(e){return e.user.userListAll},roleList:function(e){return e.role.roleList},departments:function(e){return e.department.departments}})),methods:{handleChangeFirst:function(e){this.$bus.$emit("changeSelect",{handlerId:e})},handleChangeSecond:function(e){this.$bus.$emit("changeSelect",{auditConfirmation:e})},handleChangeThird:function(e){this.$bus.$emit("changeSelect",{submitterId:e})},handleSearch:function(){this.$bus.$emit("handleSearch")},handleRefresh:function(){this.$bus.$emit("handleRefresh"),this.query=this.$options.data().query}}},d=u,m=a("2877"),f=Object(m["a"])(d,l,o,!1,null,null,null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",center:"",width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"企业",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.orgUuid,callback:function(t){e.$set(e.form,"orgUuid",t)},expression:"form.orgUuid"}},e._l(10,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},b=[],y={inject:["reload"],data:function(){return{form:{name:"",code:"",orgUuid:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入角色code",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},methods:{handleClick:function(e){console.log(e)},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},_=y,C=Object(m["a"])(_,v,b,!1,null,null,null),x=C.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"code",prop:"code"}},[a("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code","string"===typeof t?t.trim():t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark","string"===typeof t?t.trim():t)},expression:"form.remark"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},k=[],T={inject:["reload"],data:function(){return{form:{name:"",code:"",remark:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入角色code",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},methods:{handleClick:function(e){console.log(e)},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},w=T,S=Object(m["a"])(w,$,k,!1,null,null,null),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"code",prop:"code"}},[a("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code","string"===typeof t?t.trim():t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark","string"===typeof t?t.trim():t)},expression:"form.remark"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},L=[],A={props:{transfer:{type:Object,default:function(){}}},inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",remark:"",uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入角色code",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},computed:Object(r["a"])({},Object(c["c"])({currentRole:function(e){return e.role.currentRole}})),watch:{},mounted:function(){this.initData()},methods:{initData:function(){var e=this.currentRole,t=e.code,a=e.name,i=e.uuid,n=e.remark;this.form.code=t,this.form.name=a,this.form.remark=n,this.form.uuid=i},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},U=A,q=Object(m["a"])(U,E,L,!1,null,null,null),O=q.exports,I={components:{CreateTemplate:D,EditTemplate:O,ChangeTemplate:x},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){var e=this.eventType;switch(e){case"create":return"创建模板";case"edit":return"编辑模板";case"change":return"切换企业"}},close:function(){this.event=""}}},j=I,R=Object(m["a"])(j,p,g,!1,null,null,null),N=R.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.handleRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},z=[],P={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},F=P,V=(a("4da5"),Object(m["a"])(F,M,z,!1,null,"5ffc2465",null)),B=V.exports,G={components:{ListHeader:h,FormDialog:N,ToolBar:B},data:function(){return{corp:""}},watch:{},computed:Object(r["a"])({},Object(c["c"])({roleList:function(e){return e.role.roleList},departmentList:function(e){return e.department.departmentList},loading:function(e){return e.role.loading},corpInfo:function(e){return e.auth.corpInfo},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList()},mounted:function(){},beforeDestroy:function(){},methods:{doExport:function(){},handleCreate:function(){this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].dialogVisible=!0},initFilter:function(){},initDataList:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleChange:function(){this.$refs["formDialog"].event="ChangeTemplate",this.$refs["formDialog"].eventType="change",this.$refs["formDialog"].dialogVisible=!0},handleEdit:function(e){var t=e.name,a=e.code,i=e.uuid,n=e.remark,s={name:t,code:a,uuid:i,remark:n};this.$store.commit("role/SAVE_DETAIL",s),this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=s},handleDelete:function(e){var t=this,a=e.uuid,i={uuid:a};this.$confirm("是否删除当前角色","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("role/deleteRole",i).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handlePermission:function(e){var t=e.uuid,a=e.code;this.$router.push({path:"/role/detail/"+t,query:{code:a}})}}},W=G,H=(a("d70c"),Object(m["a"])(W,i,n,!1,null,null,null));t["default"]=H.exports},"64cd":function(e,t,a){"use strict";var i=a("b6f2"),n=a.n(i);n.a},6527:function(e,t,a){"use strict";var i=a("e2ea"),n=a.n(i);n.a},6560:function(e,t,a){},"65ae":function(e,t,a){},"65ea":function(e,t,a){"use strict";var i=a("0078"),n=a.n(i);n.a},6604:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\media\\detail\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"66de":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\tag\\detail\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},6742:function(e,t,a){},6766:function(e,t,a){"use strict";var i=a("15fe"),n=a.n(i);n.a},"67b6":function(e,t,a){},"693c":function(e,t,a){},6970:function(e,t,a){},"6adf":function(e,t,a){"use strict";var i=a("753e"),n=a.n(i);n.a},"6aff":function(e,t,a){},"6b5d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"6e6a":function(e,t,a){},"6f6c1":function(e,t,a){},"6fab":function(e,t,a){},"71d5":function(e,t,a){"use strict";var i=a("0368"),n=a.n(i);n.a},"721d":function(e,t,a){"use strict";var i=a("96e5"),n=a.n(i);n.a},"72a0":function(e,t,a){"use strict";var i=a("609b"),n=a.n(i);n.a},"72b3":function(e,t,a){},"737c":function(e,t,a){"use strict";var i=a("faad"),n=a.n(i);n.a},"73b3":function(e,t,a){"use strict";var i=a("f1b6"),n=a.n(i);n.a},"73bd9":function(e,t,a){"use strict";var i=a("ed35"),n=a.n(i);n.a},7460:function(e,t,a){},7472:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!0,hasImport:!1},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("span",{staticClass:"font-l"},[e._v(e._s(e.corpInfo.name))]),e._v(" "),a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["role"]["role_add"],size:"small",type:"text"},on:{click:e.handleChange}},[e._v("切换企业")])],1),e._v(" "),a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["role"]["role_add"],size:"small",type:"primary"},on:{click:e.handleCreate}},[e._v("新建模板")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"name",label:"角色名称",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.remark?a.remark:"--"))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["roleTemplate"]["roleTemplate_roleLinkPermission"]},on:{click:function(a){return e.handlePermission(t.row)}}},[e._v("配置权限")])]}}])})],1)],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=(a("7f7f"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"员工姓名"}},[a("el-input",{model:{value:e.query.userName,callback:function(t){e.$set(e.query,"userName","string"===typeof t?t.trim():t)},expression:"query.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在部门"}},[a("el-select",{on:{change:e.handleChangeSecond},model:{value:e.query.departmentsUuid,callback:function(t){e.$set(e.query,"departmentsUuid",t)},expression:"query.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"员工角色"}},[a("el-select",{on:{change:e.handleChangeThird},model:{value:e.query.roleUuid,callback:function(t){e.$set(e.query,"roleUuid",t)},expression:"query.roleUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{userName:"",departmentsUuid:"",roleUuid:""}}},computed:Object(r["a"])({},Object(c["c"])({userListAll:function(e){return e.user.userListAll},roleList:function(e){return e.role.roleList},departments:function(e){return e.department.departments}})),methods:{handleChangeFirst:function(e){this.$bus.$emit("changeSelect",{handlerId:e})},handleChangeSecond:function(e){this.$bus.$emit("changeSelect",{auditConfirmation:e})},handleChangeThird:function(e){this.$bus.$emit("changeSelect",{submitterId:e})},handleSearch:function(){this.$bus.$emit("handleSearch")},handleRefresh:function(){this.$bus.$emit("handleRefresh"),this.query=this.$options.data().query}}},d=u,m=a("2877"),f=Object(m["a"])(d,l,o,!1,null,null,null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",center:"",width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"企业",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.orgUuid,callback:function(t){e.$set(e.form,"orgUuid",t)},expression:"form.orgUuid"}},e._l(10,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},b=[],y={inject:["reload"],data:function(){return{form:{name:"",code:"",orgUuid:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入角色code",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},methods:{handleClick:function(e){console.log(e)},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},_=y,C=Object(m["a"])(_,v,b,!1,null,null,null),x=C.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"code",prop:"code"}},[a("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code","string"===typeof t?t.trim():t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark","string"===typeof t?t.trim():t)},expression:"form.remark"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},k=[],T={inject:["reload"],data:function(){return{form:{name:"",code:"",remark:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入角色code",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},methods:{handleClick:function(e){console.log(e)},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("roleTemplate/add",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},w=T,S=Object(m["a"])(w,$,k,!1,null,null,null),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"code",prop:"code"}},[a("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code","string"===typeof t?t.trim():t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark","string"===typeof t?t.trim():t)},expression:"form.remark"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},L=[],A={props:{transfer:{type:Object,default:function(){}}},inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",remark:"",uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入角色code",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},computed:Object(r["a"])({},Object(c["c"])({currentRole:function(e){return e.role.currentRole}})),watch:{},mounted:function(){this.initData()},methods:{initData:function(){var e=this.currentRole,t=e.code,a=e.name,i=e.uuid,n=e.remark;this.form.code=t,this.form.name=a,this.form.remark=n,this.form.uuid=i},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},U=A,q=Object(m["a"])(U,E,L,!1,null,null,null),O=q.exports,I={components:{CreateTemplate:D,EditTemplate:O,ChangeTemplate:x},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){var e=this.eventType;switch(e){case"create":return"创建模板";case"edit":return"编辑模板";case"change":return"切换企业"}},close:function(){this.event=""}}},j=I,R=Object(m["a"])(j,p,g,!1,null,null,null),N=R.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.handleRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},z=[],P={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},F=P,V=(a("cd9a"),Object(m["a"])(F,M,z,!1,null,"750b717f",null)),B=V.exports,G={components:{ListHeader:h,FormDialog:N,ToolBar:B},data:function(){return{corp:""}},watch:{},computed:Object(r["a"])({},Object(c["c"])({listAll:function(e){return e.roleTemplate.listAll},departmentList:function(e){return e.department.departmentList},loading:function(e){return e.roleTemplate.loading},corpInfo:function(e){return e.auth.corpInfo},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList()},mounted:function(){},beforeDestroy:function(){},methods:{doExport:function(){},handleCreate:function(){this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].dialogVisible=!0},initFilter:function(){},initDataList:function(){var e=this;this.$store.dispatch("roleTemplate/getListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleChange:function(){this.$refs["formDialog"].event="ChangeTemplate",this.$refs["formDialog"].eventType="change",this.$refs["formDialog"].dialogVisible=!0},handleEdit:function(e){var t=e.name,a=e.code,i=e.uuid,n=e.remark,s={name:t,code:a,uuid:i,remark:n};this.$store.commit("role/SAVE_DETAIL",s),this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=s},handleDelete:function(e){var t=this,a=e.uuid,i={uuid:a};this.$confirm("是否删除当前角色","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("role/deleteRole",i).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handlePermission:function(e){var t=e.uuid,a=e.code;this.$router.push({path:"/roleTemplate/detail/"+t,query:{code:a}})}}},W=G,H=(a("73b3"),Object(m["a"])(W,i,n,!1,null,null,null));t["default"]=H.exports},"751d":function(e,t,a){"use strict";var i=a("0380"),n=a.n(i);n.a},"753e":function(e,t,a){},"754c":function(e,t,a){},"756f":function(e,t,a){"use strict";var i=a("cf1ee"),n=a.n(i);n.a},7585:function(e,t,a){},7604:function(e,t,a){},"76e2":function(e,t,a){},"76fe":function(e,t,a){var i={"./automatic/listAll/index.vue":"f38f","./batchAddTask/detail/index.vue":"eb95","./batchAddTask/listAll/index.vue":"a966","./batchSendTask/add/index.vue":"b72e","./batchSendTask/addBatchSendTask/index.vue":"390c","./batchSendTask/detail/index.vue":"13ec","./batchSendTask/listAll/index.vue":"47b1","./batchSendTask/listBatchSendTaskResult/index.vue":"7f86","./batchSendTask/listMy/index.vue":"2522","./contactWay/detail/index.vue":"80ab","./contactWay/listAll/index.vue":"26228","./dashboard/index.vue":"9406","./department/detail/index.vue":"d72f","./department/listAll/index.vue":"2792","./externalUser/detail/index.vue":"5186","./externalUser/groupChatListAll/index.vue":"4361","./externalUser/groupDetail/index.vue":"bffe","./externalUser/listAll/index.vue":"c068","./externalUser/listExUserByUserId/index.vue":"b274","./externalUser/listGroup/index.vue":"b439","./externalUser/listMy/index.vue":"8104","./externalUser/quitUserRelationExUserDetail/index.vue":"8cd9","./externalUser/quitUserRelationExUserList/index.vue":"f5be","./externalUser/runWayListAll/index.vue":"fe94","./externalUser/runWayListMy/index.vue":"8e09","./media/article/detail/index.vue":"4c88","./media/article/listAll/index.vue":"1e55","./media/browsingRecords/index.vue":"f8bf","./media/detail/index.vue":"6604","./media/listAll/index.vue":"d4b3","./mediaGroup/listAll/index.vue":"b4c3","./menu/detail/index.vue":"b142","./menu/listAll/index.vue":"8bef","./menu/listMy/index.vue":"1aa6","./message/groupChatListAll/index.vue":"816b","./message/singleListAll/index.vue":"07b5","./permission/listAll/index.vue":"d4f7","./potentialCustomer/batchAdd/index.vue":"d024","./potentialCustomer/detail/index.vue":"4c15","./potentialCustomer/listAll/index.vue":"ef7a","./potentialCustomer/listMy/index.vue":"9316","./property/listAll/index.vue":"25b1","./redirect/index.vue":"ef3c","./role/detail/index.vue":"0756","./role/listAll/index.vue":"6363","./roleTemplate/detail/index.vue":"f061","./roleTemplate/listAll/index.vue":"7472","./sensitive/actionListAll/index.vue":"b8d5","./sensitive/auditBatchSendTaklistAll/index.vue":"a42b","./sensitive/auditList/index.vue":"3b29","./sensitive/auditMediaListAll/index.vue":"0e0f1","./sensitive/auditPermissionlistAll/index.vue":"6069","./sensitive/auditPropertylistAll/index.vue":"2b10","./sensitive/auditTaglistAll/index.vue":"5027","./sensitive/logListAll/index.vue":"5085","./sensitive/sensitiveListAll/index.vue":"8b09","./sensitive/sensitiveLogListAll/index.vue":"53e3","./tag/detail/index.vue":"66de","./tag/listAll/index.vue":"7bff","./tag/listAllTag/index.vue":"5b4b","./tag/listMy/index.vue":"6b5d","./user/detail/index.vue":"afe4","./user/listAll/index.vue":"ff22","./user/userActiveCount/index.vue":"a173"};function n(e){var t=s(e);return a(t)}function s(e){var t=i[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}n.keys=function(){return Object.keys(i)},n.resolve=s,e.exports=n,n.id="76fe"},"77f4":function(e,t,a){"use strict";var i=a("b12a"),n=a.n(i);n.a},"790a":function(e,t,a){"use strict";var i=a("cecd"),n=a.n(i);n.a},7938:function(e,t,a){},7945:function(e,t,a){},"79ca":function(e,t,a){"use strict";var i=a("7c9a"),n=a.n(i);n.a},"7a61":function(e,t,a){},"7bff":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个标签"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["tag"]["tag_add"],type:"primary"},on:{click:function(t){return t.stopPropagation(),e.handleCreate(t)}}},[e._v("添加标签组")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dragTable",staticStyle:{width:"100%"},attrs:{data:e.list,"row-key":"uuid",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header","default-sort":e.sortConfig}},[a("el-table-column",{attrs:{label:"标签组名",align:"left",prop:"groupName",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[Object.keys(t.row.tags).length?a("div",e._l(t.row.tags,(function(t){return a("el-tag",{key:t.uuid,staticStyle:{"margin-right":"5px"}},[e._v(e._s(t.tagName))])})),1):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return["UNDER_REVCIEW"===t.row.auditStateForOperation?a("span",{staticClass:"color-primary"},[e._v("审核中")]):a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.$index,t.row)}}},[e._v("编辑")])]}}])})],1)],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("55dd"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"标签组名称："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.groupName,callback:function(t){e.$set(e.query,"groupName","string"===typeof t?t.trim():t)},expression:"query.groupName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标签名称："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.tagName,callback:function(t){e.$set(e.query,"tagName","string"===typeof t?t.trim():t)},expression:"query.tagName"}})],1),e._v(" "),a("el-form-item",[e._v("卡片名称（企业标签由管理员统一配置，配置后企业全部成员可使用）")]),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{query:{groupName:"",tagName:""}}},computed:Object(s["a"])({},Object(o["c"])({})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=(a("1a10"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"5d765d3c",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),"destroy-on-close":"",visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},p=[],g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"标签组名称",prop:"groupName",rules:e.rules.groupName}},[a("el-input",{attrs:{maxlength:"15"},model:{value:e.form.groupName,callback:function(t){e.$set(e.form,"groupName","string"===typeof t?t.trim():t)},expression:"form.groupName"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.form.groupName.length)+"/15")])])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.tagList.length,expression:"form.tagList.length"}]},e._l(e.form.tagList,(function(t,i){return a("el-form-item",{key:i,attrs:{label:"新增标签("+(i+1)+")",prop:"tagList."+i+".tagName",rules:e.rules.tagName}},[a("div",{staticClass:"input-container"},[a("el-input",{attrs:{maxlength:"15"},model:{value:e.form.tagList[i].tagName,callback:function(t){e.$set(e.form.tagList[i],"tagName","string"===typeof t?t.trim():t)},expression:"form.tagList[index].tagName"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.form.tagList[i].tagName.length)+"/15")])]),e._v(" "),0!==i?a("el-t-button",{staticClass:"del-btn",attrs:{type:"text"},on:{click:function(t){return e.handleDelete(i)}}},[e._v("删除")]):e._e()],1)])})),1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{size:"small",type:"text"},on:{click:e.handleAddTag}},[e._v("添加标签")])],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-t-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-t-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleApply}},[e._v("确定")])],1)],1)],1)},v=[],b=(a("ac6a"),{data:function(){return{form:{groupName:"",sort:0,tagList:[{tagName:""}]},rules:{groupName:[{required:!0,message:"请输入标签组名称",trigger:"blur"}],tagName:[{required:!0,message:"请输入标签名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}]}}},computed:Object(s["a"])({},Object(o["c"])({permissionMap:function(e){return e.permission.permissionMap},tagListAll:function(e){return e.tag.tagListAll},auditSetting:function(e){return e.sensitive.auditSetting}})),watch:{"tagListAll.length":{handler:function(e,t){console.log(e),this.form.sort=e+1},immediate:!0}},mounted:function(){},methods:{handleAddTag:function(){this.form.tagList.push({tagName:""})},handleApply:function(){var e,t,a,i=this,n=this.form.sort,s=[];this.auditSetting["tag"]?(e=this.form.groupName,t=this.form.tagList.map((function(e){return e.tagName})).join(","),a={groupName:e,sort:n,addTagName:t}):(e=this.form.groupName,this.form.tagList.forEach((function(e){s.push({tagName:e.tagName})})),a={groupName:e,sort:n,tagList:s}),console.log(a),this.$refs["form"].validate((function(e){if(!e)return i.$message({type:"error",message:"请检查输入！"}),!1;i.$store.dispatch("tag/addTagIsAudit",a).then((function(){var e=i.auditSetting["tag"]?"已提交审核":"已完成";i.$message({type:"success",message:e}),i.form=i.$options.data().form,i.handleRefresh(),i.closeDialog()})).catch((function(e){i.$message({type:"error",message:e||"操作失败"})}))}))},handleCancel:function(){this.closeDialog()},closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleRefresh:function(){this.$bus.$emit("handleRequest")},handleDelete:function(e){this.form.tagList.splice(e,1)}}}),y=b,_=(a("b1fd"),Object(d["a"])(y,g,v,!1,null,"d517620c",null)),C=_.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px","label-position":"left"}},[a("div",{staticClass:"cell-container"},[a("el-form-item",{staticClass:"form-item-container",attrs:{label:"标签组名称",prop:"tagList.groupName",rules:e.rules.groupName}},[a("el-input",{attrs:{maxlength:"15"},model:{value:e.form.groupName,callback:function(t){e.$set(e.form,"groupName",t)},expression:"form.groupName"}})],1),e._v(" "),a("div",{staticClass:"operate-container"},[a("el-button",{attrs:{size:"small",type:"text"},on:{click:e.handleDeleteGroup}},[e._v("删除组")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.tagList.length,expression:"form.tagList.length"}]},e._l(e.form.tagList,(function(t,i){return a("div",{key:i,staticClass:"cell-container"},[e.checkState(t)?a("el-form-item",{staticClass:"form-item-container",attrs:{label:"标签名称("+(i+1)+")",prop:"tagList."+i+".tagName",rules:e.rules.tagName}},[a("el-input",{attrs:{maxlength:"15"},model:{value:e.form.tagList[i].tagName,callback:function(t){e.$set(e.form.tagList[i],"tagName",t)},expression:"form.tagList[index].tagName"}})],1):e._e(),e._v(" "),e.checkState(t)?a("div",{staticClass:"operate-container"},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleDelete(i,t)}}},[e._v("删除")])],1):e._e()],1)})),0),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{size:"small",type:"text"},on:{click:e.handleAddTag}},[e._v("添加标签")])],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-t-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-t-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)],1)},$=[],k=(a("96cf"),a("1da1")),T={inject:["reload"],data:function(){return{form:{groupId:"",groupName:"",tagList:[]},deleteFlagTag:!1,rules:{groupName:[{required:!0,message:"请输入标签组名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}],tagName:[{required:!0,message:"请输入标签名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}]}}},computed:Object(s["a"])({},Object(o["c"])({currentGroup:function(e){return e.tag.currentGroup},auditSetting:function(e){return e.sensitive.auditSetting}})),watch:{currentGroup:{handler:function(e,t){this.form.groupName=e.groupName,this.form.groupId=e.groupId,this.form.sort=e.sort,this.$set(this.form,"tagList",e.tags.map((function(e){return Object(s["a"])({},e)})))},deep:!0,immediate:!0}},methods:{handleAddTag:function(){this.form.tagList.push({tagName:""})},handleCancel:function(){this.closeDialog()},handleConfirm:function(){var e=this,t=this.form.tagList.every((function(e){return!0===e.deleted}));t?this.$confirm("删除所有标签将删除标签组，是否删除标签组？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(k["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.doConfirm();case 2:case"end":return t.stop()}}),t)})))).catch((function(e){})):this.doConfirm()},doConfirm:function(){var e=this,t=JSON.parse(JSON.stringify(this.form)),a=t;this.$store.dispatch("tag/updateTagIsAudit",a).then((function(){var t=e.auditSetting["tag"]?"已提交审核":"已完成";e.$message({type:"success",message:t}),e.handleFresh(),e.closeDialog()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))},handleDelete:function(e,t){t.hasOwnProperty("deleted")?(JSON.parse(JSON.stringify(Object(s["a"])(Object(s["a"])({},t),{},{deleted:!0}))),this.form.tagList.splice(e,1,Object(s["a"])(Object(s["a"])({},t),{},{deleted:!0}))):this.form.tagList.splice(e,1)},closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleDeleteGroup:function(){var e=this;this.$confirm("是否删除当前标签组","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.form.groupId,a=e.form.groupName,i=e.form.tagList.map((function(e){return e.tagId})),n={groupId:t,groupName:a,tagIds:i};e.closeDialog(),e.$store.dispatch("tag/deleteTagIsAudit",n).then((function(){var t=e.auditSetting["tag"]?"已提交审核":"已完成";e.$message({type:"success",message:t}),e.handleFresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})})),e.form=e.$options.data().form})).catch((function(e){}))},handleFresh:function(){this.$bus.$emit("handleRequest")},checkState:function(e){return!e.hasOwnProperty("deleted")||!e.deleted}}},w=T,S=(a("3909"),Object(d["a"])(w,x,$,!1,null,"74971074",null)),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},L=[],A={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},U=A,q=Object(d["a"])(U,E,L,!1,null,null,null),O=q.exports,I={components:{CreateTemplate:C,EditTemplate:D,DistributeTemplate:O},data:function(){return{dialogVisible:!1,event:"",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"create"===this.eventType?"创建模板":"edit"===this.eventType?"编辑模板":"distribute"===this.eventType?"分配部门":void 0}}},j=I,R=Object(d["a"])(j,h,p,!1,null,null,null),N=R.exports,M=a("8690"),z=a("aa47"),P={inject:["reload"],components:{ListHeader:f,FormDialog:N,ToolBar:M["a"]},name:"TagListAll",data:function(){return{sortConfig:{prop:"sort",order:"ascending"},pageConfig:{total:0,pageNumber:0,pageSize:1e3},query:{page:0,size:10,groupName:"",tagName:""},sortable:null,list:[],oldList:[],newList:[],form:{tagSorts:[{sort:0,tagGroupId:""},{sort:0,tagGroupId:""}]}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({loading:function(e){return e.tag.loading},page:function(e){return e.tag.tagListPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){var e=this;this.initDataList(this.query),this.$bus.$on("handleRequest",(function(){e.handleRequest()})),this.$once("hook:beforeDestory",(function(){e.$bus.$off("handleRequest")}))},mounted:function(){this.setSort()},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getAllUserList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("tag/getTagList",e).then((function(e){t.list=JSON.parse(JSON.stringify(e)),t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total,t.oldList=t.list.map((function(e){return e.groupId})),t.newList=t.oldList.slice()})).catch((function(e){console.log(e),t.$message({type:"error",message:e||"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.groupName,a=e.tagName;this.query.groupName=t||this.query.groupName,this.query.tagName=a||this.query.tagName,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},handleRequest:function(){this.initDataList(this.query)},handleEdit:function(e,t){var a=this.list[e];this.$store.commit("tag/SAVE_GROUP",a),this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].dialogVisible=!0},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleCreate:function(){this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].dialogVisible=!0},setSort:function(){var e=this,t=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=z["a"].create(t,{ghostClass:"sortable-ghost",onEnd:function(t){var a=t.newIndex,i=t.oldIndex;e.form.tagSorts[0].sort=e.list[a].sort,e.form.tagSorts[1].sort=e.list[i].sort,e.form.tagSorts[1].tagGroupId=e.list[a].groupId,e.form.tagSorts[0].tagGroupId=e.list[i].groupId;var n=e.list[0].sort;e.list[0].sort=e.list[1].sort,e.list[1].sort=n,e.handleChangeSort();var s=e.list.splice(t.oldIndex,1)[0];e.$nextTick((function(){e.list.splice(t.newIndex,0,s)}));var r=e.newList.splice(t.oldIndex,1)[0];e.newList.splice(t.newIndex,0,r)}})},handleChangeSort:function(){var e=this;this.$store.dispatch("tag/updateTagSort",this.form).then((function(){e.initDataList()})).catch((function(t){e.$message({type:"error",message:t})}))}}},F=P,V=(a("8aa5"),a("ba8d"),a("f625"),Object(d["a"])(F,i,n,!1,null,"65defa5a",null));t["default"]=V.exports},"7c9a":function(e,t,a){},"7d25":function(e,t,a){},"7d54":function(e,t,a){},"7d89":function(e,t,a){"use strict";var i=a("b2b6"),n=a.n(i);n.a},"7f52":function(e,t,a){"use strict";var i=a("36c3d"),n=a.n(i);n.a},"7f84":function(e,t,a){"use strict";var i=a("7938"),n=a.n(i);n.a},"7f86":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("\n    src\\views\\batchSendTask\\listBatchSendTaskResult\\index.vue\n")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},8015:function(e,t,a){"use strict";var i=a("4806"),n=a.n(i);n.a},"80ab":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"contact-way-detail app-container"},[a("el-card",{staticClass:"contact-way-detail-warp"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"140px"}},[a("div",{staticClass:"contact-way-detail-info"},[a("h5",[e._v("基本信息")]),e._v(" "),a("div",{staticClass:"info-warp"},[a("el-form-item",{attrs:{label:"二维码名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"名称不会展示给用户，用于企业记录渠道名称或使用场景"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客服人员:",prop:"member"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.ruleForm.member,callback:function(t){e.$set(e.ruleForm,"member",t)},expression:"ruleForm.member"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.userId}})})),1),e._v(" "),a("span",{staticClass:"tip"},[e._v("同一个二维码可以选择多位成员同时使用")])],1),e._v(" "),a("el-form-item",{attrs:{label:"标签：",prop:"delivery"}},[a("el-collapse-transition",[a("div",{staticClass:"tag-warp"},[e._l(e.tagData,(function(t,i){return a("div",{key:i,staticClass:"tag-list-warp"},[a("el-row",{attrs:{gutter:20,type:"flex",justify:"center"}},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"lg-42"},[e._v(e._s(t.groupName))])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("div",{staticClass:"tag-list display-flex align-items-center flex-wrap"},[a("el-checkbox-group",{attrs:{size:"small"},on:{change:function(a){return e.handleCheckedTagsChange(t,i)}},model:{value:e.checkboxGroup,callback:function(t){e.checkboxGroup=t},expression:"checkboxGroup"}},e._l(t.tagList,(function(t,i){return a("el-checkbox-button",{key:i,staticStyle:{"margin-bottom":"5px","margin-right":"5px"},attrs:{label:t.uuid,border:""}},[e._v(e._s(t.tagName))])})),1)],1)])],1)],1)})),e._v(" "),a("div",{staticClass:"is-show",on:{click:function(t){e.isShow=!e.isShow}}},[a("span",[e._v(e._s(e.isShow?"收起":"展开"))]),e._v(" "),a("i",{staticClass:"el-icon--right",class:e.isShow?"el-icon-arrow-up":"el-icon-arrow-down "})])],2)])],1)],1)]),e._v(" "),a("div",{staticClass:"set-welcome-message"},[a("h5",[e._v("设置欢迎语")]),e._v(" "),a("div",{staticClass:"info-warp"},[a("div",{staticClass:"tip"},[a("i",{staticClass:"el-icon-warning warning"}),e._v(" "),a("span",[e._v("\n              因企业微信限制，若使用成员已在\n              "),a("b",[e._v("「企业微信后台」")]),e._v(" 配置了欢迎语，这里的欢迎语将不会生效\n            ")])]),e._v(" "),a("el-form-item",{attrs:{label:"设置欢迎语:"}},[a("el-radio-group",{model:{value:e.ruleForm.welComeType,callback:function(t){e.$set(e.ruleForm,"welComeType",t)},expression:"ruleForm.welComeType"}},[a("el-radio",{attrs:{label:"MYWEL"}},[e._v("渠道欢迎语")]),e._v(" "),a("el-radio",{attrs:{label:"DEFAULTWEL"}},[e._v("默认欢迎语")]),e._v(" "),a("el-radio",{attrs:{label:"DISWEL"}},[e._v("不发送欢迎语")])],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"MYWEL"==e.ruleForm.welComeType,expression:"ruleForm.welComeType == 'MYWEL'"}],attrs:{label:"欢迎语1:"}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"insert-btn"},[a("el-button",{staticClass:"clickable no-select",attrs:{type:"text",disabled:!e.insertName},on:{click:function(t){return e.insertionMemberName(e.memberNick)}}},[e._v("[插入客户昵称]")])],1),e._v(" "),a("inputEdit",{ref:"chatInput",staticStyle:{height:"200px"},model:{value:e.ruleForm.welcomeContent,callback:function(t){e.$set(e.ruleForm,"welcomeContent",t)},expression:"ruleForm.welcomeContent"}})],1)]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"MYWEL"==e.ruleForm.welComeType,expression:"ruleForm.welComeType == 'MYWEL'"}],attrs:{label:"欢迎语2:"}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"message-box-content"},[a("el-radio-group",{model:{value:e.ruleForm.welComeMediaType,callback:function(t){e.$set(e.ruleForm,"welComeMediaType",t)},expression:"ruleForm.welComeMediaType"}},[a("el-radio",{attrs:{label:"IMG"}},[e._v("图片")]),e._v(" "),a("el-radio",{attrs:{label:"LINK"}},[e._v("链接")])],1),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"IMG"==e.ruleForm.welComeMediaType,expression:"ruleForm.welComeMediaType == 'IMG'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleSetMessageImage,"before-upload":e.beforeAvatarUpload}},[e.messageImage?a("img",{staticClass:"avatar",attrs:{src:e.messageImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),e.messageImage?a("el-button",{staticClass:"re-chose",attrs:{size:"small",type:"text"}},[e._v("重新上传")]):e._e()],1),e._v(" "),e.messageImage?a("i",{staticClass:"el-icon-circle-close close",on:{click:function(t){return t.stopPropagation(),e.handleDelMessageImage(t)}}}):e._e()],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"LINK"==e.ruleForm.welComeMediaType,expression:"ruleForm.welComeMediaType == 'LINK'"}],staticClass:"message-content"},[a("el-select",{staticClass:"label-warp",staticStyle:{width:"80%"},attrs:{"popper-append-to-body":!1,clearable:"",placeholder:"请选择","popper-class":"selectinfo"},on:{change:e.handleChoseLink},model:{value:e.ruleForm.link,callback:function(t){e.$set(e.ruleForm,"link",t)},expression:"ruleForm.link"}},[e.ruleForm.link?a("div",{staticClass:"display-flex align-items-center label-input",attrs:{slot:"prefix"},slot:"prefix"},[a("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:"/api/public/file/"+e.welcomecontentT.imgId,alt:""}}),e._v(" "),a("div",{staticClass:"input-title"},[a("span",[e._v(e._s(e.welcomecontentT.title))]),e._v(" "),a("div",{staticClass:"input-content text-over"},[e._v(e._s(e.welcomecontentT.description))])])]):e._e(),e._v(" "),e._l(e.articleListSelect,(function(t,i){return a("el-option",{key:i,attrs:{label:t.title,value:t.uuid}},[a("div",{staticClass:"option-warp flex-between-alinecenter"},[a("div",{staticClass:"link-img"},[a("img",{staticClass:"option-img",attrs:{src:"/api/public/file/"+t.imgId}})]),e._v(" "),a("div",{staticClass:"option-content flex-1"},[a("p",[e._v(e._s(t.title))]),e._v(" "),a("p",[e._v(e._s(t.description))])])])])}))],2)],1)],1)])]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"DEFAULTWEL"==e.ruleForm.welComeType,expression:"ruleForm.welComeType == 'DEFAULTWEL'"}],staticClass:"default-wel",attrs:{label:" "}},[a("span",[e._v("将发送成员已设置的欢迎语，若所选成员未设置欢迎语，则不会发送欢迎语")])])],1)]),e._v(" "),a("div",{staticClass:"contact-way-detail-feature-set"},[a("h5",[e._v("功能设置")]),e._v(" "),a("div",{staticClass:"info-warp"},[a("el-form-item",{attrs:{label:"自动通过好友:",prop:"autoAddFriend"}},[a("el-switch",{model:{value:e.ruleForm.autoAddFriend,callback:function(t){e.$set(e.ruleForm,"autoAddFriend",t)},expression:"ruleForm.autoAddFriend"}}),e._v(" "),a("el-tooltip",{staticClass:"add-friend-tip",attrs:{effect:"light",content:"开启后，客户添加该企业微信时，无需好友验证，将会自动添加成功",placement:"right-start"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"二维码预览：",prop:"qrCode"}},[a("div",{staticClass:"qr-code display-flex"},[a("div",{staticClass:"qr-code-warp"},[a("img",{staticClass:"img",attrs:{src:e.qrCode,alt:""}}),e._v(" "),e.imageUrl?a("img",{staticClass:"img-p",attrs:{src:e.imageUrl,alt:""}}):e._e()]),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("div",{staticClass:"upload-img flex-column-center-alinecenter"},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),a("span",[e._v("更换头像")])])])],1),e._v(" "),a("div",[e._v("* 此二维码只是样式预览效果，请勿直接使用")])]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")])],1)],1)])])],1)],1)},n=[],s=(a("7f7f"),a("96cf"),a("1da1")),r=(a("b54a"),a("7514"),a("c5f6"),a("5530")),l=a("d977"),o=a.n(l),c=a("2f62"),u=a("12e3"),d={name:"ContactWayDetail",components:{inputEdit:u["a"]},data:function(){return{uuid:"",isShow:!1,checkboxGroup:[],addNewGroupformData:[],ruleForm:{name:"",member:[],options:[],autoAddFriend:!0,openTime:"1",welComeType:"MYWEL",welcomeContent:"",welComeMediaType:"IMG",link:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:1,max:20,message:"长度在 3 到 5 个字符",trigger:"blur"}],member:[{required:!0,message:"请选择客服人员",trigger:"change"}]},messageImage:"",mediaId:"",mediaUuid:"",insertName:!0,welcomecontentT:{},memberNick:"客户昵称",qrCode:o.a,imageUrl:"",imgId:"",configId:"",startTime:"",endTime:""}},watch:{"ruleForm.welcomeContent":{handler:function(e,t){e.indexOf('<span class="nickName">客户昵称</span>')>-1?this.insertName=!1:this.insertName=!0},immediate:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({tagListSelect:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect},articleListSelect:function(e){return e.media.articleListSelect}})),{},{tagData:function(){return this.isShow?this.tagListSelect:this.tagListSelect.filter((function(e,t){return t<3}))}}),created:function(){this.initFilter(),this.$route.query.uuid&&this.$route.query.uuid&&(this.uuid=this.$route.query.uuid,this.getContactWayDetail(this.uuid))},methods:{getContactWayDetail:function(e){var t=this;this.$store.dispatch("contactWay/getContactWayDetail",e).then((function(e){t.configId=e.configId,t.qrCode=e.qrCode,t.ruleForm.name=e.remark,t.ruleForm.autoAddFriend=e.skipVerify,t.ruleForm.welComeType=e.welComeType,t.ruleForm.welcomeContent=e.welcomeContent,t.ruleForm.welComeMediaType=e.welComeMediaType,"IMG"==e.welComeMediaType&&(t.messageImage=e.welcomeMediaContent),"LINK"==e.welComeMediaType&&(t.ruleForm.link=Number(e.welcomeMediaContent),t.welcomecontentT=t.articleListSelect.find((function(e){return e.uuid===t.ruleForm.link}))),e.serviceUsers.map((function(e){t.ruleForm.member.push(e.userId)})),e.servicesTags.map((function(e){t.checkboxGroup.push(e.uuid)}))})).catch((function(e){}))},initFilter:function(){var e=this;this.$store.dispatch("media/getArticleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(a){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=6;break}i={remark:t.ruleForm.name,scene:2,skipVerify:t.ruleForm.autoAddFriend,tags:t.checkboxGroup,type:t.ruleForm.member.length>1?2:1,user:t.ruleForm.member,welComeMediaType:t.ruleForm.welComeMediaType,welComeType:t.ruleForm.welComeType,welcomeContent:t.ruleForm.welcomeContent},"MYWEL"!=t.ruleForm.welComeType?(i.welcomeContent="",i.welComeMediaType="IMG"):("IMG"==t.ruleForm.welComeMediaType&&""!=t.mediaId&&(i.welcomeMediaContent=t.mediaId),"LINK"==t.ruleForm.welComeMediaType&&""!=t.mediaUuid&&(i.welcomeMediaContent=t.mediaUuid)),t.$route.query.uuid?(i.configId=t.configId,""!=t.imgId&&(i.imgId=t.imgId),t.$store.dispatch("contactWay/contactWayUpdate",i).then((function(){t.$message({message:"保存成功",type:"success"}),t.$router.push({path:"/contactWay/listAll"})})).catch((function(e){}))):(""!=t.imgId&&(i.imgId=t.imgId),t.$store.dispatch("contactWay/contactWayAdd",i).then((function(){t.$message({message:"保存成功",type:"success"}),t.$router.push({path:"/contactWay/listAll"})})).catch((function(e){}))),e.next=7;break;case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields()},handleDelMessageImage:function(){this.messageImage=""},handleCheckedTagsChange:function(e,t){},handleSetMessageImage:function(e,t){this.messageImage=URL.createObjectURL(t.raw),this.mediaId=e.id},handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.imgId=e.id},beforeAvatarUpload:function(e){console.log(e,"file");var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},insertionMemberName:function(e){this.insertName=!1,this.ruleForm.welcomeContent=this.ruleForm.welcomeContent+'<span class="nickName">'.concat(e,"</span>&#8203;")},handleChoseLink:function(e){this.welcomecontentT=this.articleListSelect.find((function(t){return t.uuid===e})),this.mediaUuid=this.welcomecontentT.uuid}}},m=d,f=(a("8605"),a("d8c2"),a("2877")),h=Object(f["a"])(m,i,n,!1,null,"36bce2d2",null);t["default"]=h.exports},8104:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.handleExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户名",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"user-card"},[a("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px"},attrs:{src:t.row.avatar,lazy:""}}),e._v(" "),a("div",{staticClass:"client-info"},[a("span",{staticClass:"remark"},[e._v(e._s(t.row.remarkName))]),e._v(" "),a("div",[e._v(e._s(t.row.wxNickName))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("async-user-drawer",{attrs:{hasPop:!0,users:e.row.user}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"企业标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.externalUserDetailCorpTagsList.corpTags?a("tags-drawer-obj",{attrs:{tags:t.row.externalUserDetailCorpTagsList.corpTags}}):a("span",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"添加时间",align:"left",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_detail"],type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",[a("div",[a("img",{attrs:{width:"128",height:"128",src:e.userDetail.headimgurl}})])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("div",[e._v(e._s(e.userDetail.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("div",[e._v(e._s(e.sex(e.userDetail.gender)))])]),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("div",[a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.isEmpty(e.userDetail.state)?"未指定":e.userDetail.state.name))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("div",[e._v("\n            "+e._s(e.userDetail.role&&e.userDetail.role.name)+"\n          ")])]),e._v(" "),a("el-form-item",{attrs:{label:"公司"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.org)?"未指定":e.userDetail.org.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.department)?"未指定":e.userDetail.department.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"可用"}},[a("div",[e.userDetail.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):a("el-tag",{attrs:{type:"danger"}},[e._v("不可用")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("div",[e._v(e._s(e.userDetail.userinfo&&e.userDetail.userinfo.mobile))])]),e._v(" "),a("el-form-item",{attrs:{label:"国家/地区"}},[e._v(e._s(e.isEmpty(e.userDetail.country)&&e.isEmpty(e.userDetail.city)&&e.isEmpty(e.userDetail.province)?"未设置":e.userDetail.country+e.userDetail.city+e.userDetail.province))]),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},e._l(e.userDetail.events,(function(t){return a("el-button",{key:t,attrs:{type:"primary"},on:{click:function(a){return e.handleEvents(t)}}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作历史",name:"logs",disabled:!e.userDetail.logs.length}},[a("el-scrollbar",[a("el-timeline",{staticClass:"py-3"},e._l(e.userDetail.logs,(function(t){return a("el-timeline-item",{key:t.uuid,attrs:{timestamp:t.createdAt}},[a("div",[e._v("\n                "+e._s(t.operator.nickname)+"\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#E6A23C"}},[e._v("@"+e._s(t.org.name))]),e._v(" "),a("span",{staticClass:"font-sm"},[e._v("执行了")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.event))])])])})),1)],1)],1)],1),e._v(" "),a("EventDialog",{ref:"eventDialog"})],1)},l=[],o=(a("6b54"),a("2f62")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},m=[],f={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},h=f,p=a("2877"),g=Object(p["a"])(h,d,m,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},y=[],_=(a("ac6a"),a("456d"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},T=[],w={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},S=w,D=Object(p["a"])(S,k,T,!1,null,null,null),E=D.exports,L={components:{CreateTemplate:v,EditTemplate:$,DistributeTemplate:E},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},A=L,U=Object(p["a"])(A,c,u,!1,null,null,null),q=U.exports,O={components:{EventDialog:q},data:function(){return{activeType:"detail"}},watch:{},computed:Object(s["a"])({},Object(o["c"])({eventsMap:function(e){return e.stateSettings.eventsMap},userDetail:function(e){return e.userManage.userDetail}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{sex:function(e){return"Gender_Type_Unknown"!=e&&e?"Gender_Type_Female"==e?"女":"Gender_Type_Male"==e?"男":void 0:"未知"},initHandleEvents:function(){},isEmpty:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isEmpty(e)})),handleClose:function(){this.$store.commit("component/TOGGLE_PANEL",!1)},handleEvents:function(e){console.log(this.$refs,e);var t=e;switch(e){case"enable":e="EventEnable";break;case"kick":e="EventKick";break;case"disable":e="EventDisable";break;default:return!1}this.$refs["eventDialog"].event=e,this.$refs["eventDialog"].eventType=t,this.$refs["eventDialog"].dialogVisible=!0},handleConfirm:function(){},initData:function(){}}},I=O,j=Object(p["a"])(I,r,l,!1,null,null,null),R=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"external-user-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"客户名称："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入客户名称"},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属员工："}},[a("el-select",{attrs:{clearable:""},on:{change:e.handleSelectedChange},model:{value:e.query.userId,callback:function(t){e.$set(e.query,"userId",t)},expression:"query.userId"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.userId}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"添加时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户标签："}},[a("div",{staticClass:"tag-border"},[a("el-select",{attrs:{clearable:"",size:"mini",multiple:""},on:{change:e.handleChangeSecond},model:{value:e.query.tagIds,callback:function(t){e.$set(e.query,"tagIds",t)},expression:"query.tagIds"}},e._l(e.tagListAll,(function(t,i){return a("el-option-group",{key:i,attrs:{label:t.groupName}},e._l(t.tagList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.tagName,value:e.uuid}})})),1)})),1),e._v(" "),a("span",{staticClass:"tag-warp"},[a("el-radio-group",{model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:!0}},[e._v("包含任一")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("完全匹配")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            包含任一：有任意一个选择的标签的用户;\n            "),a("br"),e._v("完全匹配：必须拥有全部选择的标签的用户。\n          ")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1)],1)]),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},M=[],z={data:function(){return{value:[],contractWay:[{type:"员工主动添加",id:"1"},{type:"员工被动添加",id:"2"},{type:"二维码扫码添加",id:"3"}],query:{name:"",contractWayId:"",userId:"",tagIds:[],flag:!0,startTime:"",endTime:""},timer:null}},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){console.log(e),this.query.startTime=this.value[0],this.query.endTime=this.value[1],this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSelectedChange:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query}}},P=z,F=(a("03d5"),Object(p["a"])(P,N,M,!1,null,"db4768ce",null)),V=F.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},G=[],W={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},H=W,J=(a("f953"),Object(p["a"])(H,B,G,!1,null,"02c2789e",null)),Y=J.exports,X=a("1b32"),K=a("adac"),Q=a("ee39"),Z={components:{AsyncUserDrawer:X["a"],ListHeader:V,UserDetail:R,FormDialog:q,ToolBar:Y,UserDrawer:K["a"],TagsDrawerObj:Q["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,flag:!0,name:"",tagIds:[],userId:"",startTime:"",endTime:"",contractWayId:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.externalUser.loading},list:function(e){return e.externalUser.list},page:function(e){return e.externalUser.page},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){},methods:{initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getExternalUserListMy",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){console.log(e,"row");var t=e.externalUuid;this.$router.push({path:"/externalUser/detail/"+t})},handleSearch:function(e){var t=e.tagIds,a=e.name,i=e.userId,n=e.startTime,s=e.endTime,r=(e.contractWayId,e.flag);this.query.tagIds=t?t+"":this.query.tagIds,this.query.name=a||this.query.name,this.query.userId=i||this.query.userId,this.query.startTime=n||this.query.startTime,this.query.flag=!!r,this.query.endTime=s||this.query.endTime,console.log(e,"handleSearch",this.query),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleExport:function(e){console.log(e)}}},ee=Z,te=(a("7d89"),a("64cd"),Object(p["a"])(ee,i,n,!1,null,"da193af8",null));t["default"]=te.exports},8139:function(e,t,a){},"814b":function(e,t,a){"use strict";var i=a("f468"),n=a.n(i);n.a},"816b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\message\\listGroupChat\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"817b":function(e,t,a){},"839e":function(e,t,a){},"85fc":function(e,t,a){"use strict";var i=a("4c05"),n=a.n(i);n.a},8605:function(e,t,a){"use strict";var i=a("044e"),n=a.n(i);n.a},8690:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},n=[],s={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},r=s,l=(a("2622"),a("2877")),o=Object(l["a"])(r,i,n,!1,null,"75980664",null);t["a"]=o.exports},"86b5":function(e,t,a){"use strict";var i=a("0990"),n=a.n(i);n.a},"87b0":function(e,t,a){},8885:function(e,t,a){"use strict";var i=a("c297"),n=a.n(i);n.a},8896:function(e,t,a){"use strict";var i=a("125c"),n=a.n(i);n.a},"8aa5":function(e,t,a){"use strict";var i=a("8d2e"),n=a.n(i);n.a},"8b09":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个敏感词",hasRefresh:!0},on:{handleExport:e.doExport,handleRefresh:e.handleRefresh}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["riskManagement"]["riskManagement_add"]},on:{click:function(t){return t.stopPropagation(),e.handleCreate(t)}}},[e._v("新建敏感词")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["riskManagement"]["riskManagement_add"]},on:{click:function(t){return t.stopPropagation(),e.handleBatchChange(t)}}},[e._v("设置通知人")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"敏感词",align:"left",prop:"word"}}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.toUser).length?a("div",[a("async-user-drawer",{attrs:{hasPop:!0,users:i.toUser}})],1):e._e(),e._v(" "),Object.keys(i.toRole).length?a("div",[a("role-drawer",{attrs:{roles:i.toRole}})],1):e._e()]}}])},[a("template",{slot:"header"},[a("span",[e._v("\n              通知人\n              "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",{staticClass:"font-exs color-info"},[e._v("除了发送者，设置人也会收到触发通知。")])]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)])],2),e._v(" "),a("el-table-column",{attrs:{align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[a("div",[e._v(e._s("INSET"==i.tagType?"包含其一":"全部满足"))]),e._v(" "),a("tags-drawer",{attrs:{tags:i.sensitiveSetTag}})],1)]}}])},[a("template",{slot:"header"},[a("span",[e._v("\n              适用标签\n              "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",{staticClass:"font-exs color-info"},[e._v("员工与不满足该标签的人沟通时，不会被监控。")])]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)])],2),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"left",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.creator).length?a("div",[a("async-user-tag",{attrs:{uuid:i.creator.uuid,size:"small",type:"info"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(i.creator.name)+"\n              ")])],1):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",popAuth:!0,auth:e.permissionMap["riskManagement"]["riskManagement_update"],size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.$index)}}},[e._v("编辑")]),e._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),a("el-t-button",{attrs:{type:"text",popAuth:!0,auth:e.permissionMap["riskManagement"]["riskManagement_delete"],size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"敏感词："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.word,callback:function(t){e.$set(e.query,"word","string"===typeof t?t.trim():t)},expression:"query.word"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发生时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH-mm-ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleChangeFirst},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{value:[],query:{startTime:"",endTime:"",word:""}}},computed:{},methods:{handleChangeFirst:function(e){this.query.startTime=this.value[0],this.query.endTime=this.value[1]},handleChangeSecond:function(e){this.$emit("handleSearch",this.query)},handleChangeThird:function(e){this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query}}},d=u,m=(a("73bd9"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"6f91286a",null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),"destroy-on-close":"",visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"敏感词"}},[e._l(e.form.words,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-right":"5px"},attrs:{closable:"",size:"big","disable-transitions":!1},on:{close:function(a){return e.handleClose(t)}}},[e._v(e._s(t))])})),e._v(" "),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[a("i",{staticClass:"el-icon-plus"}),e._v("添加\n    ")])],2),e._v(" "),a("el-form-item",{attrs:{label:"被通知人"}},[a("div",[a("el-radio",{attrs:{label:"USER"},model:{value:e.form.informType,callback:function(t){e.$set(e.form,"informType",t)},expression:"form.informType"}},[e._v("员工通知")]),e._v(" "),a("el-radio",{attrs:{label:"ROLE"},model:{value:e.form.informType,callback:function(t){e.$set(e.form,"informType",t)},expression:"form.informType"}},[e._v("角色通知")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:""}}),e._v(" "),a("div",{staticClass:"mb-20"},[a("keep-alive",["ROLE"==e.form.informType?a("div",{staticClass:"role-container mb-20"},[a("el-select",{attrs:{multiple:""},model:{value:e.toRoles,callback:function(t){e.toRoles=t},expression:"toRoles"}},e._l(e.listSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1):a("div",[a("complex-select",{attrs:{section:"user",options:e.departmentList},model:{value:e.userSelects,callback:function(t){e.userSelects=t},expression:"userSelects"}})],1)]),e._v(" "),a("span",{staticClass:"font-exs color-info"},[e._v("当员工触发敏感词后，除通知以上设置被通知人，触发的员工本人也将收到通知消息。")])],1),e._v(" "),a("el-form-item",{attrs:{label:"符合标签"}},[a("div",[a("el-radio",{attrs:{label:"INSET"},model:{value:e.form.tagType,callback:function(t){e.$set(e.form,"tagType",t)},expression:"form.tagType"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"UNIONSET"},model:{value:e.form.tagType,callback:function(t){e.$set(e.form,"tagType",t)},expression:"form.tagType"}},[e._v("完全匹配")])],1)]),e._v(" "),a("tag-multi-select",{model:{value:e.tagSelects,callback:function(t){e.tagSelects=t},expression:"tagSelects"}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},b=[],y=a("8cbb"),_=a("fba9"),C=a("f6e6"),x={inject:["reload"],components:{AsyncUserTag:_["a"],ComplexSelect:y["a"],TagMultiSelect:C["a"]},data:function(){return{userSelects:[],tagSelects:[],inputVisible:!1,inputValue:"",form:{tagType:"INSET",informType:"USER",type:"MSG",words:[]},toUserTags:[],toRoles:[],rules:{word:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{"form.informType":{handler:function(e,t){"ROLE"==e&&(this.$set(this.form,"toRole",[]),this.$delete(this.form,"toUser")),"USER"==e&&(this.$set(this.form,"toUser",[]),this.$delete(this.form,"toRole"))},immediate:!0},toUserTags:{handler:function(e,t){},deep:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({departmentList:function(e){return e.department.departmentList},listSelect:function(e){return e.role.roleListSelect},tagListSelect:function(e){return e.tag.tagListSelect}})),{},{toUser:function(){return this.form.toUser}}),mounted:function(){this.initFilter()},methods:{initFilter:function(){var e=this;this.$store.dispatch("role/getRoleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleConfirm:function(){var e=this;"USER"==this.form.informType?this.form.toUser=this.userSelects.map((function(e){return e.uuid})):this.form.toRole=this.toRoles,this.form.setTag=this.tagSelects;var t=this.form;this.$refs["form"].validate((function(a){a?e.$store.dispatch("sensitive/add",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.handleRefresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})})):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleClose:function(e){this.form.words.splice(this.form.words.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this.inputValue;e&&this.form.words.push(e),this.inputVisible=!1,this.inputValue=""},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},$=x,k=(a("d713"),Object(m["a"])($,v,b,!1,null,null,null)),T=k.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"敏感词",prop:"word"}},[a("el-input",{model:{value:e.form.word,callback:function(t){e.$set(e.form,"word","string"===typeof t?t.trim():t)},expression:"form.word"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重置标签"}},[a("div",[a("el-radio",{attrs:{label:"INSET"},model:{value:e.form.tagType,callback:function(t){e.$set(e.form,"tagType",t)},expression:"form.tagType"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"UNIONSET"},model:{value:e.form.tagType,callback:function(t){e.$set(e.form,"tagType",t)},expression:"form.tagType"}},[e._v("完全匹配")])],1)]),e._v(" "),a("tag-multi-select",{model:{value:e.form.setTag,callback:function(t){e.$set(e.form,"setTag",t)},expression:"form.setTag"}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},S=[],D=(a("ac6a"),a("9d29")),E={inject:["reload"],props:{transfer:{type:Object,default:function(){return{}}}},components:{AsyncUserTag:_["a"],ComplexSelect:y["a"],TagSelect:D["a"],TagMultiSelect:C["a"]},data:function(){return{userSelects:[],tagSelects:[],tagOriginSelects:null,indexTemp:[],inputVisible:!1,inputValue:"",form:{},toUserTags:[],toRoles:[],rules:{word:[{required:!0,message:"请输入敏感词",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{transfer:{handler:function(e,t){this.tagSelects=this.$options.data().tagSelects,console.log(e)},immediate:!0},currentWord:{handler:function(e,t){this.tagSelects=this.$options.data().tagSelects,console.log(e);var a=e.uuid,i=e.type,n=e.informType,s=e.tagType,r=e.sensitiveSetTag,l=(e.toUser,e.toRole,e.word);this.$set(this.form,"uuid",a),this.$set(this.form,"type",i),this.$set(this.form,"informType",n),this.$set(this.form,"tagType",s),this.$set(this.form,"word",l),this.$set(this.form,"setTag",r.map((function(e){return e.uuid})))},immediate:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({userListSelect:function(e){return e.user.listSelect},departmentList:function(e){return e.department.departmentList},listSelect:function(e){return e.role.listSelect},tagListSelect:function(e){return e.tag.tagListSelect},currentWord:function(e){return e.sensitive.currentWord},tagListMap:function(e){return e.tag.tagListMap}})),{},{toUser:function(){return this.form.toUser}}),created:function(){this.initFilter()},updated:function(){},methods:{initFilter:function(){var e=this;this.$store.dispatch("role/getRoleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("tag/getListSelect").then((function(t){var a=[];t.forEach((function(e){a.push(e.tagList.map((function(e){return e.uuid})))})),e.tagOriginSelects=a})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleConfirm:function(){var e=this;this.form.setTag=this.tagSelects.reduce((function(e,t){return e.concat(t)}),[]);var t=this.form;this.$refs["form"].validate((function(a){console.log(t),a?e.$store.dispatch("sensitive/update",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.handleRefresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})})):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleChange:function(){},handleCloseTag:function(){},handleRefresh:function(){this.$bus.$emit("handleRefrensh")},handleClose:function(e){this.form.words.splice(this.form.words.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this.inputValue;e&&this.form.words.push(e),this.inputVisible=!1,this.inputValue=""}}},L=E,A=(a("8c25"),Object(m["a"])(L,w,S,!1,null,null,null)),U=A.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},O=[],I={data:function(){return{form:{departmentsUuid:0}}},computed:Object(r["a"])({},Object(c["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},j=I,R=Object(m["a"])(j,q,O,!1,null,null,null),N=R.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"被通知人"}},[a("div",[a("el-radio",{attrs:{label:"USER"},model:{value:e.form.informType,callback:function(t){e.$set(e.form,"informType",t)},expression:"form.informType"}},[e._v("员工通知")]),e._v(" "),a("el-radio",{attrs:{label:"ROLE"},model:{value:e.form.informType,callback:function(t){e.$set(e.form,"informType",t)},expression:"form.informType"}},[e._v("角色通知")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:""}}),e._v(" "),a("div",{staticClass:"mb-20"},[a("keep-alive",["ROLE"==e.form.informType?a("div",{staticClass:"role-container mb-20"},[a("el-select",{attrs:{multiple:""},model:{value:e.roleSelects,callback:function(t){e.roleSelects=t},expression:"roleSelects"}},e._l(e.listSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1):a("div",[a("complex-select",{attrs:{section:"user",options:e.departmentList},model:{value:e.userSelects,callback:function(t){e.userSelects=t},expression:"userSelects"}})],1)]),e._v(" "),a("span",{staticClass:"font-exs color-info"},[e._v("当员工触发敏感词后，除通知以上设置被通知人，触发的员工本人也将收到通知消息。")])],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},z=[],P={inject:["reload"],props:{transfer:{type:Object,default:function(){return{}}}},components:{ComplexSelect:y["a"]},data:function(){return{roleSelects:[],userSelects:[],form:{informType:"ROLE",sensitiveUuid:[],noticeUuid:[]}}},watch:{transfer:{handler:function(e,t){console.log(e.sensitiveUuid),this.form.sensitiveUuid=e.sensitiveUuid},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({departmentList:function(e){return e.department.departmentList},listSelect:function(e){return e.role.roleListSelect}})),created:function(){this.initFilter()},methods:{initFilter:function(){var e=this;this.$store.dispatch("role/getRoleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleConfirm:function(){var e=this,t=this.userSelects.length?this.userSelects.map((function(e){return e.uuid})):this.roleSelects.map((function(e){return e.uuid})),a=Object(r["a"])(Object(r["a"])({},this.form),{},{noticeUuid:t});this.$store.dispatch("sensitive/updateNoticeUser",a).then((function(t){0==t.code&&(e.$message({type:"success",message:"操作成功"}),e.handleRefresh())})).catch((function(t){e.$message({type:"error",message:t||"操作失败"})}))},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},F=P,V=Object(m["a"])(F,M,z,!1,null,null,null),B=V.exports,G={components:{CreateTemplate:T,EditTemplate:U,DistributeTemplate:N,ChangeTemplate:B},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"create"===this.eventType?"新建敏感词":"edit"===this.eventType?"编辑敏感词":"change"===this.eventType?"修改通知人":void 0}}},W=G,H=Object(m["a"])(W,p,g,!1,null,null,null),J=H.exports,Y=a("8690"),X=a("1b32"),K=a("6424"),Q=a("1a6c"),Z={components:{ListHeader:h,FormDialog:J,ToolBar:Y["a"],AsyncUserTag:_["a"],AsyncUserDrawer:X["a"],RoleDrawer:Q["a"],TagsDrawer:K["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,startTime:"",endTime:"",word:""},rowSelects:[]}},watch:{},computed:Object(r["a"])({},Object(c["c"])({loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.sensitiveListAll},page:function(e){return e.sensitive.sensitivePage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/getSensitiveListAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.startTime,a=e.endTime,i=e.word;this.query.startTime=t||this.query.startTime,this.query.endTime=a||this.query.endTime,this.query.word=i||this.query.word,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleCreate:function(){this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].dialogVisible=!0},handleDelete:function(e){var t=this,a={uuid:this.listAll[e].uuid};this.$confirm("是否删除当前敏感词","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("sensitive/deleteSensitive",a).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList(t.query)})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleEdit:function(e){var t=this.listAll[e],a=t.uuid,i=t.type,n=t.informType,s=t.tagType,r=t.sensitiveSetTag,l=t.toUser,o=t.toRole,c=t.word;r=JSON.parse(JSON.stringify(r)),l=JSON.parse(JSON.stringify(l)),o=JSON.parse(JSON.stringify(o));var u={uuid:a,type:i,informType:n,tagType:s,sensitiveSetTag:r,toUser:l,toRole:o,word:c},d=this.listAll[e];this.$store.commit("sensitive/SAVE_CURRENTWORD",d),this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=u},handleBatchChange:function(){if(this.rowSelects.length){var e=this.rowSelects.map((function(e){return e.uuid})),t={sensitiveUuid:e};this.$refs["formDialog"].event="ChangeTemplate",this.$refs["formDialog"].eventType="change",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=t}else this.$message({type:"warning",message:"请至少选择一项"})},handleSelectionChange:function(e){this.rowSelects=e}}},ee=Z,te=(a("feab"),a("fc5d"),Object(m["a"])(ee,i,n,!1,null,"fcce8ff2",null));t["default"]=te.exports},"8b2f":function(e,t,a){"use strict";var i=a("754c"),n=a.n(i);n.a},"8b50":function(e,t,a){},"8bef":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\menu\\list\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},"8c25":function(e,t,a){"use strict";var i=a("e1e9"),n=a.n(i);n.a},"8cd9":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_redistributionExUser"]},on:{click:e.handleDistribute}},[e._v("分配给其他员工")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户名称",prop:"externalUser.name",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"原添加人",prop:"user.name",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"原添加人所属部门",prop:"departments[0].name",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"离职时间",align:"left",prop:"updatedAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"primary",size:"mini",popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_redistributionExUser"]},on:{click:function(a){return a.stopPropagation(),e.handleDistributeSingle(t.$index,t.row)}}},[e._v("分配")])]}}])})],1)],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("ac6a"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",[a("div",[a("img",{attrs:{width:"128",height:"128",src:e.userDetail.headimgurl}})])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("div",[e._v(e._s(e.userDetail.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("div",[e._v(e._s(e.sex(e.userDetail.gender)))])]),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("div",[a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.isEmpty(e.userDetail.state)?"未指定":e.userDetail.state.name))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("div",[e._v("\n            "+e._s(e.userDetail.role&&e.userDetail.role.name)+"\n          ")])]),e._v(" "),a("el-form-item",{attrs:{label:"公司"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.org)?"未指定":e.userDetail.org.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.department)?"未指定":e.userDetail.department.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"可用"}},[a("div",[e.userDetail.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):a("el-tag",{attrs:{type:"danger"}},[e._v("不可用")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("div",[e._v(e._s(e.userDetail.userinfo&&e.userDetail.userinfo.mobile))])]),e._v(" "),a("el-form-item",{attrs:{label:"国家/地区"}},[e._v(e._s(e.isEmpty(e.userDetail.country)&&e.isEmpty(e.userDetail.city)&&e.isEmpty(e.userDetail.province)?"未设置":e.userDetail.country+e.userDetail.city+e.userDetail.province))]),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},e._l(e.userDetail.events,(function(t){return a("el-button",{key:t,attrs:{type:"primary"},on:{click:function(a){return e.handleEvents(t)}}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作历史",name:"logs",disabled:!e.userDetail.logs.length}},[a("el-scrollbar",[a("el-timeline",{staticClass:"py-3"},e._l(e.userDetail.logs,(function(t){return a("el-timeline-item",{key:t.uuid,attrs:{timestamp:t.createdAt}},[a("div",[e._v("\n                "+e._s(t.operator.nickname)+"\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#E6A23C"}},[e._v("@"+e._s(t.org.name))]),e._v(" "),a("span",{staticClass:"font-sm"},[e._v("执行了")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.event))])])])})),1)],1)],1)],1),e._v(" "),a("EventDialog",{ref:"eventDialog"})],1)},l=[],o=(a("6b54"),a("2f62")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},m=[],f={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},h=f,p=a("2877"),g=Object(p["a"])(h,d,m,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},y=[],_=(a("456d"),a("7f7f"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"departmentsUuid"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},T=[],w={data:function(){return{form:{departmentsUuid:""},rules:{departmentsUuid:[{required:!0,message:"请选择分配人员",trigger:["change","blur"]}]}}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},userListSelect:function(e){return e.user.listSelect},quitUserCurrentRow:function(e){return e.externalUser.quitUserCurrentRow}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.$refs["form"].resetFields(),this.closeDialog()},handleConfrim:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var a={external_userid:e.quitUserCurrentRow.externalUser.externalUserId,handover_userid:e.quitUserCurrentRow.user.userId,takeover_userid:e.form.departmentsUuid};e.$store.dispatch("externalUser/redistributionExUser",a).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.$bus.$emit("handleRefresh")})).catch((function(t){e.$message({type:"error",message:"操作失败"}),e.handleCancel()})),e.$refs["form"].resetFields()}else e.$message({type:"error",message:"请检查输入"})}))}}},S=w,D=Object(p["a"])(S,k,T,!1,null,null,null),E=D.exports,L={components:{CreateTemplate:v,EditTemplate:$,DistributeTemplate:E},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:"distribute"}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配模板"}}},A=L,U=Object(p["a"])(A,c,u,!1,null,null,null),q=U.exports,O={components:{EventDialog:q},data:function(){return{activeType:"detail"}},watch:{},computed:Object(s["a"])({},Object(o["c"])({eventsMap:function(e){return e.stateSettings.eventsMap},userDetail:function(e){return e.userManage.userDetail}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{sex:function(e){return"Gender_Type_Unknown"!=e&&e?"Gender_Type_Female"==e?"女":"Gender_Type_Male"==e?"男":void 0:"未知"},initHandleEvents:function(){},isEmpty:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isEmpty(e)})),handleClose:function(){this.$store.commit("component/TOGGLE_PANEL",!1)},handleEvents:function(e){console.log(this.$refs,e);var t=e;switch(e){case"enable":e="EventEnable";break;case"kick":e="EventKick";break;case"disable":e="EventDisable";break;default:return!1}this.$refs["eventDialog"].event=e,this.$refs["eventDialog"].eventType=t,this.$refs["eventDialog"].dialogVisible=!0},handleConfirm:function(){},initData:function(){}}},I=O,j=Object(p["a"])(I,r,l,!1,null,null,null),R=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("div",{staticClass:"font-s"},[e._v("\n        当企业成员被客户从微信联系人中删除时，会在客户流失列表中产生一条记录，超盈SCRM会为您自动发出【被删除通知】，以便您第一时间得到通知信息，客户流失功能只会记录授权给超盈SCRM成员的客户流失信息\n    ")])])},M=[],z={data:function(){return{query:{name:"",tagIds:"",userId:""}}},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},userListAll:function(e){return e.user.userListAll}})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},P=z,F=Object(p["a"])(P,N,M,!1,null,null,null),V=F.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},G=[],W={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},H=W,J=(a("8deb3"),Object(p["a"])(H,B,G,!1,null,"32efe0c8",null)),Y=J.exports,X={name:"runWayListAll",components:{ListHeader:V,UserDetail:R,FormDialog:q,ToolBar:Y},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{},selectedAllData:[]}},watch:{$route:{handler:function(e,t){console.log(this.$route.query)},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({loading:function(e){return e.externalUser.loading},listAll:function(e){return e.externalUser.quitUserRelationExUserListDetail},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.$route.query)},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("department/getDepartmentListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getQuitUserRelationExUserDetail",e).then((function(){})).catch((function(e){console.error(e),t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.listAll[e].userId;this.$router.push({path:"/externalUser/quitUserRelationExUserDetail",query:{userId:t}})},handleDistribute:function(){this.selectedAllData.length>0?(this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].selectedAllData=this.selectedAllData):this.$message({type:"warning",message:"请勾选分配人员!"})},handleDistributeSingle:function(e,t){var a=this;console.log(t,666),this.$refs.multipleTable.clearSelection(),this.handleSelectionChange(t),this.selectedAllData.forEach((function(e){a.$refs.multipleTable.toggleRowSelection(e)})),this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$store.commit("externalUser/SAVE_QUITUSERCURRENTROW",t)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleSelectionChange:function(e){this.selectedAllData=[e],console.log(e,"selected")}}},K=X,Q=(a("f7f9"),a("c679"),Object(p["a"])(K,i,n,!1,null,"6d9508fa",null));t["default"]=Q.exports},"8d2e":function(e,t,a){},"8d5d":function(e,t,a){"use strict";var i=a("461d"),n=a.n(i);n.a},"8da0":function(e,t,a){"use strict";var i=a("9651"),n=a.n(i);n.a},"8da4":function(e,t,a){"use strict";var i=a("9012"),n=a.n(i);n.a},"8de8":function(e,t,a){},"8deb3":function(e,t,a){"use strict";var i=a("2783"),n=a.n(i);n.a},"8e09":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.runWayList,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"流失客户",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"user-card"},[a("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px"},attrs:{src:t.row.externalUser.avatar,lazy:""}}),e._v(" "),a("div",{staticClass:"client-info"},[a("span",{staticClass:"remark"},[e._v("\n                  "+e._s(t.row.remark)+"\n                  "),a("span",{staticClass:"main-color"},[e._v(e._s(1==t.row.externalUser.type?"@微信":"@企业微信"))])]),e._v(" "),a("div",[e._v(e._s(t.row.externalUser.name))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.user).length?a("div",e._l([i.user],(function(t){return a("async-user-tag",{key:t.uuid,attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(t.name)+"\n              ")])})),1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.tags?a("tags-drawer-obj",{attrs:{tags:t.row.tags.corpTags}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"流失时间",align:"left",prop:"updatedAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"流失类型",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.delFollow?"被客户删除":"主动删除客户"))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index,t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",[a("div",[a("img",{attrs:{width:"128",height:"128",src:e.userDetail.headimgurl}})])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("div",[e._v(e._s(e.userDetail.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("div",[e._v(e._s(e.sex(e.userDetail.gender)))])]),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("div",[a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.isEmpty(e.userDetail.state)?"未指定":e.userDetail.state.name))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("div",[e._v("\n            "+e._s(e.userDetail.role&&e.userDetail.role.name)+"\n          ")])]),e._v(" "),a("el-form-item",{attrs:{label:"公司"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.org)?"未指定":e.userDetail.org.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.department)?"未指定":e.userDetail.department.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"可用"}},[a("div",[e.userDetail.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):a("el-tag",{attrs:{type:"danger"}},[e._v("不可用")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("div",[e._v(e._s(e.userDetail.userinfo&&e.userDetail.userinfo.mobile))])]),e._v(" "),a("el-form-item",{attrs:{label:"国家/地区"}},[e._v(e._s(e.isEmpty(e.userDetail.country)&&e.isEmpty(e.userDetail.city)&&e.isEmpty(e.userDetail.province)?"未设置":e.userDetail.country+e.userDetail.city+e.userDetail.province))]),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},e._l(e.userDetail.events,(function(t){return a("el-button",{key:t,attrs:{type:"primary"},on:{click:function(a){return e.handleEvents(t)}}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作历史",name:"logs",disabled:!e.userDetail.logs.length}},[a("el-scrollbar",[a("el-timeline",{staticClass:"py-3"},e._l(e.userDetail.logs,(function(t){return a("el-timeline-item",{key:t.uuid,attrs:{timestamp:t.createdAt}},[a("div",[e._v("\n                "+e._s(t.operator.nickname)+"\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#E6A23C"}},[e._v("@"+e._s(t.org.name))]),e._v(" "),a("span",{staticClass:"font-sm"},[e._v("执行了")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.event))])])])})),1)],1)],1)],1),e._v(" "),a("EventDialog",{ref:"eventDialog"})],1)},l=[],o=(a("6b54"),a("2f62")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},m=[],f={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},h=f,p=a("2877"),g=Object(p["a"])(h,d,m,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},y=[],_=(a("ac6a"),a("456d"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},T=[],w={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},S=w,D=Object(p["a"])(S,k,T,!1,null,null,null),E=D.exports,L={components:{CreateTemplate:v,EditTemplate:$,DistributeTemplate:E},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},A=L,U=Object(p["a"])(A,c,u,!1,null,null,null),q=U.exports,O={components:{EventDialog:q},data:function(){return{activeType:"detail"}},watch:{},computed:Object(s["a"])({},Object(o["c"])({eventsMap:function(e){return e.stateSettings.eventsMap},userDetail:function(e){return e.userManage.userDetail}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{sex:function(e){return"Gender_Type_Unknown"!=e&&e?"Gender_Type_Female"==e?"女":"Gender_Type_Male"==e?"男":void 0:"未知"},initHandleEvents:function(){},isEmpty:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isEmpty(e)})),handleClose:function(){this.$store.commit("component/TOGGLE_PANEL",!1)},handleEvents:function(e){console.log(this.$refs,e);var t=e;switch(e){case"enable":e="EventEnable";break;case"kick":e="EventKick";break;case"disable":e="EventDisable";break;default:return!1}this.$refs["eventDialog"].event=e,this.$refs["eventDialog"].eventType=t,this.$refs["eventDialog"].dialogVisible=!0},handleConfirm:function(){},initData:function(){}}},I=O,j=Object(p["a"])(I,r,l,!1,null,null,null),R=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"run-way-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"客户名称："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"流失类型："}},[a("el-select",{on:{change:e.handleSelectedChange},model:{value:e.query.delFollow,callback:function(t){e.$set(e.query,"delFollow",t)},expression:"query.delFollow"}},e._l(e.typeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属员工："}},[a("el-select",{on:{change:e.handleSelectedChange},model:{value:e.query.userUuid,callback:function(t){e.$set(e.query,"userUuid",t)},expression:"query.userUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"添加时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户标签："}},[a("div",{staticClass:"tag-border"},[a("el-select",{attrs:{size:"mini",multiple:""},on:{change:e.handleChangeSecond},model:{value:e.query.tagIds,callback:function(t){e.$set(e.query,"tagIds",t)},expression:"query.tagIds"}},e._l(e.tagListAll,(function(t){return a("el-option-group",{key:t.groupId,attrs:{label:t.groupName}},e._l(t.tagList,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.tagName,value:e.uuid}})})),1)})),1),e._v(" "),a("span",{staticClass:"tag-warp"},[a("el-radio-group",{model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:!0}},[e._v("包含任一")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("完全匹配")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            包含任一：有任意一个选择的标签的用户;\n            "),a("br"),e._v("完全匹配：必须拥有全部选择的标签的用户。\n          ")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1)],1)]),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},M=[],z={data:function(){return{value:[],query:{name:"",userUuid:"",tagIds:[],flag:!0,startTime:"",endTime:"",delFollow:""},typeOptions:[{label:"主动删除客户",value:!1},{label:"被客户删除",value:!0}],contractWay:[{type:"员工主动添加",id:"1"},{type:"员工被动添加",id:"2"},{type:"二维码扫码添加",id:"3"}],timer:null}},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){console.log(e),this.query.startTime=this.value[0],this.query.endTime=this.value[1],this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSelectedChange:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query}}},P=z,F=(a("3cd7"),Object(p["a"])(P,N,M,!1,null,"37e61e58",null)),V=F.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},G=[],W={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},H=W,J=(a("85fc"),Object(p["a"])(H,B,G,!1,null,"1c66baf1",null)),Y=J.exports,X=a("fba9"),K=a("ee39"),Q=a("51fb"),Z={name:"runWayList",components:{ListHeader:V,UserDetail:R,FormDialog:q,ToolBar:Y,AsyncUserTag:X["a"],TagsDrawerObj:K["a"],UserTag:Q["a"]},data:function(){return{hasPop:!1,pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,flag:!0,name:"",tagIds:"",userUuid:"",startTime:"",endTime:"",delFollow:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.externalUser.loading},runWayList:function(e){return e.externalUser.runWayList},runWayPage:function(e){return e.externalUser.runWayPage}})),created:function(){this.initDataList(this.query),this.initFilter()},methods:{initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getRunWayList",e).then((function(){t.pageConfig.pageNumber=t.runWayPage.pageNumber+1,t.pageConfig.total=t.runWayPage.total})).catch((function(e){console.error(e),t.$message({type:"error",message:"初始化失败"})}))},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e,t){this.$router.push({path:"/externalUser/detail/".concat(t.externalUser.uuid),query:{userId:t.user.userId}})},handleSearch:function(e){var t=e.name,a=(e.contractWayId,e.userUuid),i=e.tagIds,n=e.flag,s=e.startTime,r=e.endTime,l=e.delFollow;this.query.delFollow=""===l?"":!0===l,this.query.flag=!!n,this.query.name=t||this.query.name,this.query.tagIds=i?i+"":this.query.tagIds,this.query.userUuid=a||this.query.userUuid,this.query.startTime=s||this.query.startTime,this.query.endTime=r||this.query.endTime,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},doExport:function(e){console.log(e)}}},ee=Z,te=(a("4f58"),a("8b2f"),Object(p["a"])(ee,i,n,!1,null,"0030d805",null));t["default"]=te.exports},"8f3c":function(e,t,a){},9012:function(e,t,a){},9299:function(e,t,a){"use strict";var i=a("87b0"),n=a.n(i);n.a},9316:function(e,t,a){"use strict";a.r(t);var i,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["potentialCustomer"]["potentialCustomer_add"]},on:{click:e.addBatchTask}},[e._v("批量添加好友")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",auth:e.permissionMap["potentialCustomer"]["potentialCustomer_add"],popAuth:!0},on:{click:function(t){return t.stopPropagation(),e.handleCreate(t)}}},[e._v("新增用户")]),e._v(" "),a("el-t-button",{attrs:{auth:e.permissionMap["potentialCustomer"]["potentialCustomer_allocation"]},on:{click:function(t){return t.stopPropagation(),e.handleDistribute(t)}}},[e._v("分配")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.listMy,"row-key":"uuid",stripe:"",lazy:"",fit:"","highlight-current-row":"","header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户名",align:"left",prop:"name",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",align:"left",prop:"mobile",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{align:"left"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("tags-drawer",{attrs:{tags:t.potentialCustomerTags}})]}}])},[a("template",{slot:"header"},[a("span",[e._v("\n              预设标签\n              "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",{staticClass:"font-exs color-info"},[e._v("添加成为用户后，将自动打上预设标签。")])]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)])],2),e._v(" "),a("el-table-column",{attrs:{label:"批量添加次数",align:"left",prop:"tryCount"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.belong).length?a("div",[a("async-user-tag",{attrs:{uuid:i.belong.uuid,size:"small",type:"info"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(i.belong.name)+"\n              ")])],1):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"添加员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.creator).length?a("div",[a("async-user-tag",{attrs:{uuid:i.creator.uuid,size:"small",type:"info"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(i.creator.name)+"\n              ")])],1):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"入库时间",align:"left",prop:"importTime"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["potentialCustomer"]["potentialCustomer_update"]},on:{click:function(a){return a.stopPropagation(),e.handleAllocation(t.row)}}},[e._v("分配")]),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["potentialCustomer"]["potentialCustomer_update"]},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-t-button",{attrs:{type:"text",popAuth:!0,auth:e.permissionMap["potentialCustomer"]["potentialCustomer_delete"],size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},s=[],r=a("ade3"),l=(a("96cf"),a("1da1")),o=(a("ac6a"),a("7f7f"),a("5530")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"run-way-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"客户名称："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"添加员工："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.creatorUuid,callback:function(t){e.$set(e.query,"creatorUuid",t)},expression:"query.creatorUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"添加时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"添加次数："}},[a("el-radio-group",{model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:1}},[e._v("全部客户")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("未添加过的客户")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("\n        自定义添加次数的客户\n        "),a("span",{staticStyle:{display:"inline-block",width:"50px",color:"#000"}},[a("el-input",{ref:"minInput",staticClass:"min",attrs:{size:"mini"},on:{input:function(t){return e.inputMin(t)},focus:e.focusInput},model:{value:e.query.min,callback:function(t){e.$set(e.query,"min","string"===typeof t?t.trim():t)},expression:"query.min"}}),e._v(" "),a("span",[e._v("--")]),e._v(" "),a("el-input",{staticClass:"max",attrs:{size:"mini"},on:{focus:e.focusInput,input:function(t){return e.inputMax(t)}},model:{value:e.query.max,callback:function(t){e.$set(e.query,"max","string"===typeof t?t.trim():t)},expression:"query.max"}}),e._v(" "),a("span",[e._v("次")])],1)])],1)],1),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},u=[],d=(a("a481"),a("2f62")),m={data:function(){return{value:[],query:{name:"",belongUuid:"",creatorUuid:"",startTime:"",endTime:"",flag:1,max:null,min:null},timer:null}},watch:{"query.flag":{handler:function(e,t){var a=this;2!=e?(this.query.min="",this.query.max=""):this.$nextTick((function(){a.$refs.minInput.focus()}))},immediate:!0}},computed:Object(o["a"])({},Object(d["c"])({userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){this.query.startTime=this.value[0],this.query.endTime=this.value[1]},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSelectedChange:function(e){this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.value=this.$options.data().value,this.$emit("handleRefresh")},inputMin:function(e){(this.query.min||this.query.max)&&(this.query.flag=2);var t=/[^\d]/g;this.query.min=e.replace(t,""),(""==this.query.min||this.query.min<=0||this.query.min>99)&&(this.$message.warning("输入数字必须在0-100之间"),this.query.min=0)},inputMax:function(e){var t=/[^\d]/g;this.query.max=e.replace(t,""),(""==this.query.max||this.query.max<0||this.query.max>100)&&(this.$message.warning("输入数字必须在0-100之间"),this.query.max=1)},focusInput:function(){this.query.flag=2}}},f=m,h=(a("79ca"),a("c670"),a("2877")),p=Object(h["a"])(f,c,u,!1,null,"cf7727f8",null),g=p.exports,v=a("fba9"),b=a("6424"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,center:"","modal-append-to-body":!1,"append-to-body":"",width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},_=[],C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"客户名"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"持有人"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.belongUuid,callback:function(t){e.$set(e.form,"belongUuid",t)},expression:"form.belongUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预设标签"}},[a("label",{staticClass:"tag-label",attrs:{slot:"label"},slot:"label"},[e._v("\n      预设标签\n      "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"添加成为用户后，将自动打上预设标签",placement:"right"}},[a("i",{staticClass:"el-icon-question tip"})])],1)]),e._v(" "),a("div",[a("tags-selected",{attrs:{tagListSelect:e.tagListSelect,checkboxGroup:e.form.tagId},on:{change:e.handleCheckedTagsChange}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},x=[],$=a("fbff"),k=a("61f7"),T={inject:["reload"],components:{TagsSelected:$["a"]},data:function(){var e=function(e,t,a){!t||Object(k["b"])(t)?a():a(new Error("手机格式不正确"))};return{hasParent:!1,form:{belongUuid:"",mobile:"",name:"",tagId:[]},rules:{mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:e,trigger:["blur","change"]}]},result:[]}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(o["a"])(Object(o["a"])({},Object(d["b"])(["uuid"])),Object(d["c"])({userListAll:function(e){return e.user.listSelect},tagListSelect:function(e){return e.tag.tagListSelect}})),created:function(){this.initFilter()},mounted:function(){this.form.belongUuid=this.uuid},methods:{initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleCheckedTagsChange:function(e,t){this.checkboxGroup=e},handleConfirm:function(){var e=this;this.form.tagId=this.checkboxGroup,this.$refs["form"].validate((function(t){t?e.$store.dispatch("potentialCustomer/batchAdd",e.form).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){console.error(t),e.$message({type:"error",message:"操作失败"})})):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("potentialCustomer/getListMy").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}},w=T,S=(a("42fb"),Object(h["a"])(w,C,x,!1,null,"46a14fc4",null)),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"客户名"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预设标签"}},[a("label",{staticClass:"tag-label",attrs:{slot:"label"},slot:"label"},[e._v("\n      预设标签\n      "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"添加成为用户后，将自动打上预设标签",placement:"right"}},[a("i",{staticClass:"el-icon-question tip"})])],1)]),e._v(" "),a("div",[a("tags-selected",{attrs:{tagListSelect:e.tagListSelect,checkboxGroup:e.form.tagId,packUp:!0,isShow:!0},on:{change:e.handleCheckedTagsChange}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},L=[],A={inject:["reload"],props:{transfer:{type:Object,default:function(){}}},components:{TagsSelected:$["a"]},data:function(){return{checkboxGroup:[],hasParent:!1,changeTag:!1,form:{mobile:"",name:"",tagId:[],belongUuid:"",uuid:""},rules:{name:[{required:!0,message:"请输入客户名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{transfer:{handler:function(e,t){var a=this;console.log(e,"newVal");var i=e.belong,n=e.uuid,s=e.selectedTag,r=e.mobile,l=e.name;this.form.name=l,this.form.belongUuid=i.uuid,this.form.uuid=n,this.form.mobile=r,s.length>0&&s.map((function(e){a.form.tagId.push(e)}))},immediate:!0}},computed:Object(o["a"])({},Object(d["c"])({tagListSelect:function(e){return e.tag.tagListSelect}})),mounted:function(){},methods:{handleCheckedTagsChange:function(e,t){this.changeTag=!0,this.checkboxGroup=e},handleConfirm:function(){var e=this;this.changeTag&&(this.form.tagId=this.checkboxGroup),this.$store.dispatch("potentialCustomer/potentialCustomerUpdate",this.form).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("potentialCustomer/getListMy").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},U=A,q=Object(h["a"])(U,E,L,!1,null,null,null),O=q.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-select",{staticStyle:{width:"100%","margin-bottom":"20px"},model:{value:e.form.userUuid,callback:function(t){e.$set(e.form,"userUuid",t)},expression:"form.userUuid"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},j=[],R=a("8cbb"),N={props:{transfer:{type:Object,default:function(){}}},components:{ComplexSelect:R["a"]},data:function(){return{selects:[],form:{userUuid:"",uuid:[]}}},watch:{transfer:{handler:function(e,t){console.log(e,"8888");var a=e.uuid;this.form.uuid=a},immediate:!0}},computed:Object(o["a"])({},Object(d["c"])({departmentList:function(e){return e.department.departmentList},userListSelect:function(e){return e.user.listSelect}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){var e=this;this.$store.dispatch("potentialCustomer/allocation",this.form).then((function(t){switch(t.code){case 1:e.$message({type:"error",message:"分配失败"}),e.closeDialog();break;default:e.$message({type:"success",message:"操作成功"}),e.closeDialog(),e.handleRefresh();break}})).catch((function(t){e.$message({type:"error",message:t})}))},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},M=N,z=Object(h["a"])(M,I,j,!1,null,null,null),P=z.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("div",[e._v("已选择"+e._s(e.transfer.length)+"名用户，查看列表")]),e._v(" "),a("br"),e._v(" "),a("el-form-item",{attrs:{label:"开始时间：",prop:"startTime"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间","default-time":["00:00:00","23:59:59"]},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"消息内容：",prop:"content"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)],1)},V=[],B={props:{transfer:{type:Array,default:[]}},data:function(){return{form:{startTime:"",content:""},rules:{startTime:[{required:!0,message:"请输入正确的时间格式",trigger:"blur"}],content:[{required:!0,message:"消息内容为必填项",trigger:"blur"}]}}},methods:{handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleConfirm:function(){var e=this,t=[];this.transfer.map((function(e,a){t[a]=e.uuid}));var a=Object(o["a"])(Object(o["a"])({},this.form),{},{customerUuids:t});this.$refs["form"].validate((function(t){t?(console.log(a),e.$store.dispatch("potentialCustomer/batchAddTask",a).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))}}},G=B,W=Object(h["a"])(G,F,V,!1,null,null,null),H=W.exports,J={components:{CreateTemplate:D,EditTemplate:O,DistributeTemplate:P,addBatchTask:H},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(o["a"])({},Object(d["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"distribute"===this.eventType?"分配部门":"AddBatchTask"===this.eventType?"批量添加好友":void 0}}},Y=J,X=Object(h["a"])(Y,y,_,!1,null,null,null),K=X.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},Z=[],ee={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},te=ee,ae=(a("9815"),Object(h["a"])(te,Q,Z,!1,null,"3dd73e3c",null)),ie=ae.exports,ne=a("ecfe"),se={components:{ListHeader:g,FormDialog:K,ToolBar:ie,TagsDrawer:b["a"],AsyncUserTag:v["a"],CustomerPagination:ne["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,name:"",belongUuid:"",creatorUuid:"",startTime:"",endTime:"",flag:"",min:"",max:""},selects:[]}},watch:{},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.potentialCustomer.loading},listMy:function(e){return e.potentialCustomer.listMy},listMyPage:function(e){return e.potentialCustomer.listMyPage},permissionMap:function(e){return e.permission.permissionMap}})),{},{routesData:function(){return this.routes}}),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)}))},beforeDestroy:function(){this.$bus.$off("handleRefresh")},methods:(i={doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("potentialCustomer/getListMy",e).then((function(){t.pageConfig.pageNumber=t.listMyPage.pageNumber+1,t.pageConfig.total=t.listMyPage.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleSearch:function(e){var t;e.max<e.min&&(t=e.max,e.max=e.min,e.min=t);var a=e.belongUuid,i=e.creatorUuid,n=e.endTime,s=(e.flag,e.max),r=e.min,l=e.name,o=e.startTime;2==e.flag?(this.query.flag=!0,this.query.min=r,this.query.max=s):1==e.flag?(this.query.flag="",this.query.min="",this.query.max=""):(this.query.flag=!1,this.query.min=0,this.query.max=0),this.query.name=l||"",this.query.belongUuid=a||"",this.query.creatorUuid=i||"",this.query.endTime=n||"",this.query.startTime=o||"",this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleCreate:function(){this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].dialogVisible=!0},handleDistribute:function(){var e=this.selects.map((function(e){return e.uuid})),t={uuid:e};this.selects.length?(this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=t):this.$message({type:"warning",message:"请至少选择一个客户"})},handleSelectionChange:function(e){var t=e;this.selects=t.map((function(e){return e.uuid+""}))},addBatchTask:function(){this.selects.length?(this.$refs["formDialog"].event="addBatchTask",this.$refs["formDialog"].eventType="AddBatchTask",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=this.selects):this.$message({type:"warning",message:"请至少选择一个客户"})},handleAllocation:function(e){var t=this;e.uuid=[e.uuid],console.log(e,"777"),this.$refs.multipleTable.clearSelection(),this.handleSelectionChange([e]),this.selects.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)})),this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=e},handleEdit:function(e){var t=e.belong,a=e.uuid,i=e.mobile,n=e.name,s=[];e.potentialCustomerTags.map((function(e){e.tags.map((function(e){s.push(e.tagId)}))}));var r={belong:t,uuid:a,selectedTag:s,mobile:i,name:n};this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=r},handleDelete:function(e){var t=this,a=e.uuid,i={uuid:[a]};this.$confirm("是否删除当前客户","删除潜在客户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("potentialCustomer/deletePotentialCustomer",i).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))}},Object(r["a"])(i,"handleSelectionChange",(function(e){this.selects=e})),Object(r["a"])(i,"changeSize",(function(e){this.query.size=e,this.initDataList(this.query)})),i)},re=se,le=(a("d302"),a("d8e6"),Object(h["a"])(re,n,s,!1,null,"5f9e22c8",null));t["default"]=le.exports},"952a":function(e,t,a){"use strict";var i=a("1808"),n=a.n(i);n.a},9572:function(e,t,a){},"960b":function(e,t,a){"use strict";var i=a("f345"),n=a.n(i);n.a},9651:function(e,t,a){},9682:function(e,t,a){},"9682c":function(e,t,a){},"96c4":function(e,t,a){"use strict";var i=a("7585"),n=a.n(i);n.a},"96df":function(e,t,a){"use strict";var i=a("05b7"),n=a.n(i);n.a},"96e5":function(e,t,a){},9815:function(e,t,a){"use strict";var i=a("294b"),n=a.n(i);n.a},9816:function(e,t,a){},9915:function(e,t,a){},"99d1":function(e,t,a){},"9daa":function(e,t,a){"use strict";var i=a("19a6"),n=a.n(i);n.a},"9e60":function(e,t,a){},"9ff3":function(e,t,a){"use strict";var i=a("347c"),n=a.n(i);n.a},a10e:function(e,t,a){},a166:function(e,t,a){},a173:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\user\\userActiveCount\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},a263:function(e,t,a){e.exports=a.p+"static/img/no-menber-result.43f59dd1.png"},a308:function(e,t,a){"use strict";var i=a("b205"),n=a.n(i);n.a},a42b:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditTagConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="access")}}},[e._v("批量通过")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["audit"]["audit_batchAuditTagConfirmation"]},on:{click:function(t){return e.handleBatch(e.action="reject")}}},[e._v("批量拒绝")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","default-sort":e.sortConfig,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",selectable:e.selectable}}),e._v(" "),a("el-table-column",{attrs:{width:"85",align:"left",label:"提交人"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.submitOperator.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"提交时间",prop:"createdAt",sortable:"","sort-orders":["descending","ascending"]}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"群发内容"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{staticClass:"font-no-wrap"},[e._v(e._s(i.textContent))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"客户标签"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[a("el-row",[a("el-col",{attrs:{span:8}},[i.matchFormat?a("span",{staticClass:"color-primary font-exs"},[e._v(e._s(e.matchFormat[i.matchFormat]))]):a("span",[e._v("--")])]),e._v(" "),a("el-col",{attrs:{span:16}},[i.toTags&&Object.keys(i.toTags).length?a("tags-drawer",{attrs:{tags:e.grouping(i.toTags)}}):e._e()],1)],1)],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"leeft",label:"状态",sortable:"",prop:"auditState",width:"80","sort-method":e.sortMethod,"sort-orders":["ascending","descending",null]},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",["TO_BE_REVIEWED"===i.auditState?a("span",{staticClass:"color-primary"},[e._v("审核中")]):"AUDIT_FAILED"===i.auditState?a("span",{staticClass:"color-danger"},[e._v("已拒绝")]):a("span",{staticClass:"color-success"},[e._v("已通过")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"80",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAudit(i.uuid)}}},[e._v("审核")])],1)]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("7514"),a("ac6a"),a("456d"),a("96cf"),a("1da1")),r=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"审批人："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.handlerId,callback:function(t){e.$set(e.query,"handlerId",t)},expression:"query.handlerId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审批状态："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.auditConfirmation,callback:function(t){e.$set(e.query,"auditConfirmation",t)},expression:"query.auditConfirmation"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"提起人："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.submitterId,callback:function(t){e.$set(e.query,"submitterId",t)},expression:"query.submitterId"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{handlerId:"",auditConfirmation:"",submitterId:""}}},computed:Object(r["a"])({},Object(c["c"])({userListSelect:function(e){return e.user.listSelect}})),created:function(){this.initFilter()},methods:{initFilter:function(){var e=this;this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleChangeFirst:function(e){this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},d=u,m=(a("412d"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"7e7693bf",null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{"label-width":"150px","label-position":"left"}},[e.detail.submitOperator?a("el-form-item",{attrs:{label:"提交人："}},[a("div",{staticClass:"submit-item"},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:e.detail.submitOperator.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n        "+e._s(e.detail.submitOperator.name)+"\n      ")])],1),e._v(" "),a("div",{staticClass:"submit-item"},["TO_BE_REVIEWED"===e.detail.auditState?a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"APPROVED"===e.detail.auditState?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e(),e._v(" "),"AUDIT_FAILED"===e.detail.auditState?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v(e._s(e.auditState[e.detail.auditState]))]):e._e()],1),e._v(" "),a("div",{staticClass:"sumbit-item"},[a("span",{staticClass:"color-info font-exs"},[e._v(e._s(e.detail.updatedAt))])])]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"群发类型："}},[a("div",[a("span",[e._v(e._s(e.detail.sendType))])])]),e._v(" "),a("el-form-item",{attrs:{label:"文字消息："}},[a("div",{domProps:{innerHTML:e._s(e.detail.textContent)}})]),e._v(" "),a("el-form-item",{attrs:{label:"文字内容："}},[e.detail.mediaUuid?a("article-board",{attrs:{uuid:e.detail.mediaUuid}}):e._e(),e._v(" "),"IMAGE"===e.detail.tempMediaType?a("el-image",{attrs:{fit:"contain",src:"/api/public/file/"+e.detail.tempMediaKey}}):e._e(),e._v(" "),"VIDEO"===e.detail.tempMediaType?a("video",{staticStyle:{width:"400px",height:"300px"},attrs:{controls:"",src:"/api/public/file/"+e.detail.tempMediaKey}}):e._e(),e._v(" "),"FILE"===e.detail.tempMediaType?a("div",{staticClass:"file-container"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleDownload}},[a("i",{staticClass:"el-icon-document"}),e._v("\n          下载文件 \n          "),a("i",{staticClass:"el-icon-download"})])],1):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"标签配置："}},[e.detail.matchFormat?a("div",[a("span",{staticClass:"color-primary font-exs"},[e._v(e._s(e.matchFormat[e.detail.matchFormat]))]),e._v(" "),a("icon-tooltip",[a("div",[a("div",{staticClass:"font-exs color-info"},[e._v("包含任意：至少包含一个标签。")]),e._v(" "),a("div",{staticClass:"font-exs color-info"},[e._v("完全匹配：包含全部标签。")])])])],1):e._e(),e._v(" "),e.tags.length?a("tags-drawer",{attrs:{tags:e.tags}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"审批流程："}},[a("div",[a("el-timeline",e._l(e.detail.auditUsers,(function(t){return a("el-timeline-item",{key:t.level},[a("h5",[e._v("\n            "+e._s(t.range?"会签":"或签")+"·\n            "),"finished"===e.checkState(t)?a("span",[e._v("已完成")]):a("span",{staticClass:"color-primary"},[e._v("进行中")])]),e._v(" "),e._l(t.userList,(function(t){return a("div",{key:t.uuid},[a("async-user-tag",{attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid color-primary"}),e._v("\n              "+e._s(t.name)+"\n            ")])],1)}))],2)})),1)],1)]),e._v(" "),a("div",{staticClass:"text-align-center"},["TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleAudit(e.action="reject")}}},[e._v("拒绝")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleAudit(e.action="access")}}},[e._v("通过")]),e._v(" "),"TO_BE_REVIEWED"!==e.detail.auditState||e.currentUserState(e.detail.auditUsers)?a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]):e._e()],1)],1)},b=[],y=a("fba9"),_=a("550c8"),C=a("6424"),x=a("1882"),$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h3",[e._v(e._s(e.detail.title))]),e._v(" "),a("div",{staticClass:"article-container"},[a("div",{staticClass:"font-exs color-info",domProps:{innerHTML:e._s(e.detail.articleContent)}})])])},k=[],T=(a("c5f6"),{props:{uuid:{type:Number,default:0}},data:function(){return{detail:{}}},created:function(){this.initData(this.uuid)},methods:{initData:function(e){var t=this;this.$store.dispatch("media/getArticleDetail",e).then((function(e){t.detail=e})).catch((function(e){console.error(e)}))}}}),w=T,S=(a("0a57"),Object(m["a"])(w,$,k,!1,null,"78d6c17e",null)),D=S.exports,E={inject:["reload"],props:{transfer:{type:Object,default:function(){return{}}}},components:{AsyncUserTag:y["a"],VideoCover:_["a"],TagsDrawer:C["a"],IconTooltip:x["a"],ArticleBoard:D},data:function(){return{form:{name:"",code:"",org:""},detail:{},tags:[],rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{transfer:{handler:function(e,t){this.initData(e.uuid)},immediate:!0,deep:!0}},computed:Object(r["a"])({},Object(c["c"])({auditState:function(e){return e.enum.auditState},matchFormat:function(e){return e.enum.matchFormat},currentUserUuid:function(e){return e.user.uuid}})),mounted:function(){},methods:{initData:function(e){var t=this;this.$store.dispatch("audit/getDetail",e).then((function(e){t.detail=Object(r["a"])(Object(r["a"])({},e),{},{auditUsers:t.parse(e.auditUsers)}),t.tags=t.grouping(e.toTags)})).catch((function(e){console.error(e),t.$message({type:"error",message:e})}))},parse:function(e){return JSON.parse(e)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},grouping:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.groupId===e.groupId}));if(a)a.tags.push(t);else{var i={groupId:t.groupId,groupName:t.groupName,tags:[t]};e.push(i)}return e}),[]):[]},groupingDelete:function(e){return console.log(e,"grouping"),Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.groupId===e.groupId}));if(a)a.tags.push(t);else{var i={groupId:t.groupId,groupName:t.groupName,tags:[t]};e.push(i)}return e}),[]):[]},handleAudit:function(e){var t=this,a=this.transfer.uuid,i=null;i="reject"===e?{auditConfirmation:"AUDIT_FAILED",uuids:[a]}:{auditConfirmation:"APPROVED",uuids:[a]},console.log(i),this.$store.dispatch("audit/batchAuditMediaConfirmation",i).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.handleCancel(),t.handleRefresh()}})})).catch((function(e){t.$confirm(e,"错误",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){})).catch((function(e){}))}))},handleRefresh:function(){this.$bus.$emit("handleRefresh")},checkState:function(e){return e.range?e.userList.some((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished":e.userList.every((function(e){return"TO_BE_REVIEWED"===e.auditState}))?"underway":"finished"},currentUserState:function(e){var t=this,a=!1;return e.forEach((function(e){e.userList.forEach((function(e){e.uuid===t.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(a=!0))}))})),a},handleDownload:function(){var e=this.detail.tempMediaKey;window.location.href="/api/public/file/".concat(e)}}},L=E,A=(a("d300"),Object(m["a"])(L,v,b,!1,null,"9aa490c8",null)),U=A.exports,q={components:{AuditTemplate:U},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("audit"===this.eventType)return"审批详情"}}},O=q,I=Object(m["a"])(O,p,g,!1,null,null,null),j=I.exports,R=a("8690"),N=a("ecfe"),M={components:{ListHeader:h,FormDialog:j,ToolBar:R["a"],CustomerPagination:N["a"],TagsDrawer:C["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},sortConfig:{prop:"auditState",order:"ascending"},query:{page:0,size:10,auditConfirmation:"",auditType:"BATCH_SEND_TASK",handlerId:"",submitterId:""},selects:[]}},watch:{},computed:Object(r["a"])({},Object(c["c"])({auditStateEnum:function(e){return e.enum.auditState},auditState:function(e){return e.emnu.auditState},mediaType:function(e){return e.enum.mediaType},matchFormat:function(e){return e.enum.matchFormat},permissionMap:function(e){return e.permission.permissionMap},loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.auditBatchSendTaskListAll},page:function(e){return e.sensitive.auditBatchSendTaskPage}})),created:function(){this.initDataList(this.query)},methods:{doExport:function(e){console.log(e)},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/getAuditBatchSendTaklistAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleAudit:function(e){this.$refs["formDialog"].event="AuditTemplate",this.$refs["formDialog"].eventType="audit",this.$refs["formDialog"].transfer={uuid:e},this.$refs["formDialog"].dialogVisible=!0},handleSearch:function(e){var t=e.auditConfirmation,a=e.handlerId,i=e.submitterId;this.query.auditConfirmation=t||this.query.auditConfirmation,this.query.handlerId=a||this.query.handlerId,this.query.submitterId=i||this.query.submitterId,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleBatch:function(e){if(this.selects.length){var t=this.selects,a=null;"reject"===e?(t=this.selects,a={auditConfirmation:"AUDIT_FAILED",uuids:t}):(t=this.selects,a={auditConfirmation:"APPROVED",uuids:t}),this.batchAudit(a)}else this.$message({type:"warning",message:"请至少选择一项"})},batchAudit:function(e){var t=this;this.$store.dispatch("audit/batchAuditBatchTaskConfirmation",e).then((function(){t.$message({type:"success",message:"操作成功",duration:1e3,onClose:function(){t.initDataList(t.query)}})})).catch((function(e){t.$message({type:"error",message:e})}))},handleAccess:function(e){var t=this,a={auditConfirmation:"APPROVED",uuids:[e.uuid]};this.$confirm("是否通过当前审批","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("audit/batchAuditBatchTaskConfirmation",a).then((function(e){t.$message({type:"success",message:"操作成功"}),t.initDataList(t.query)})).catch((function(e){console.error(e),t.$message({type:"danger",message:"操作失败"})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)}))},handleReject:function(e){var t=this,a={auditConfirmation:"AUDIT_FAILED",uuids:[e.uuid]};this.$confirm("是否拒绝当前审批","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("audit/batchAuditBatchTaskConfirmation",a).then((function(e){t.$message({type:"success",message:"操作成功"}),t.initDataList(t.query)})).catch((function(e){t.$message({type:"danger",message:"操作失败"})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleBatchConfrim:function(){var e=this,t=this.selects,a={auditConfirmation:"APPROVED",uuids:t};console.log(a),this.selects.length?this.$store.dispatch("audit/batchAuditBatchTaskConfirmation",a).then((function(){e.$message({type:"success",message:"操作成功"}),e.initDataList(e.query)})).catch((function(t){e.$message({type:"error",message:"操作失败"})})):this.$message({type:"error",message:"请选择至少一项"})},handleBatchReject:function(){var e=this,t=this.selects,a={auditConfirmation:"AUDIT_FAILED",uuids:t};this.selects.length?this.$store.dispatch("audit/batchAuditBatchTaskConfirmation",a).then((function(){e.$message({type:"success",message:"操作成功"}),e.initDataList(e.query)})).catch((function(t){e.$message({type:"error",message:"操作失败"})})):this.$message({type:"error",message:"请选择至少一项"})},grouping:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.groupId===e.groupId}));if(a)a.tags.push(t);else{var i={groupId:t.groupId,groupName:t.groupName,tags:[t]};e.push(i)}return e}),[]):[]},sortMethod:function(e,t){return"TO_BE_REVIEWED"===e.auditState?-1:"TO_BE_REVIEWED"===t.auditState?1:e.auditState===t.auditState?0:void 0},selectable:function(e,t){var a=this,i=!1;return e.auditUsers.forEach((function(e){e.userList.forEach((function(e){e.uuid===a.currentUserUuid&&("APPROVED"!==e.auditState&&"AUDIT_FAILED"!==e.auditState||(i=!0))}))})),"TO_BE_REVIEWED"===e.auditState&&!i},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},z=M,P=(a("b275"),a("e892"),Object(m["a"])(z,i,n,!1,null,"5b6b7587",null));t["default"]=P.exports},a475:function(e,t,a){"use strict";var i=a("adb7"),n=a.n(i);n.a},a6b4:function(e,t,a){},a6cb:function(e,t,a){},a7a3:function(e,t,a){"use strict";var i=a("2b97"),n=a.n(i);n.a},a966:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{ref:"listHeader",on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasRefresh:!0,usersNumber:e.userPage.total},on:{handleRefresh:e.handleRefresh,handleExport:e.doExport,handleUpdate:e.handleUpdate}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.batchTaskListmy,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"进度",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.count?a("div",[e._v(e._s(t.row.addCount)+" / "+e._s(t.row.count))]):a("div",[e._v("-")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"生效时间",prop:"startTime",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[Object.keys(t.row.creator).length?a("div",[e._v(e._s(t.row.creator.name))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建日期",prop:"createdAt",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:e.addStatus(t.row.addStatus)},[e._v(e._s(e.batchAddTaskEnum[t.row.addStatus]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index)}}},[e._v("详情")]),e._v(" "),"INTERRUPT"==t.row.addStatus?a("el-t-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleContinue(t.$index)}}},[e._v("继续")]):e._e(),e._v(" "),"CANCELED"!=t.row.addStatus?a("el-t-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleCancel(t.$index)}}},[e._v("取消")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=a("5530"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"任务状态："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.status,callback:function(t){e.$set(e.query,"status",t)},expression:"query.status"}},e._l(e.statusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"创建人："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.creatorUuid,callback:function(t){e.$set(e.query,"creatorUuid",t)},expression:"query.creatorUuid"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"创建时间："}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleChangeSecond},model:{value:e.datePicker,callback:function(t){e.datePicker=t},expression:"datePicker"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary",clearable:""},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{statusList:[{value:"NOTSTARTED",label:"未开始"},{value:"INTERRUPT",label:"中断"},{value:"PROCESSING",label:"进行中"},{value:"CANCELED",label:"已取消"},{value:"FINISHED",label:"已完成"}],datePicker:[],query:{status:"",creatorUuid:"",starttime:"",endtime:""}}},computed:Object(s["a"])({},Object(o["c"])({userListSelect:function(e){return e.user.listSelect}})),methods:{handleChangeFirst:function(e){this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){e?(this.query.starttime=e[0],this.query.endtime=e[1]):(this.query.starttime="",this.query.endtime="")},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=(a("bbab"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"28a28952",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},p=[],g={components:{},data:function(){return{dialogVisible:!1,event:"",eventType:""}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("cancelTask"==this.eventType)return"取消"}}},v=g,b=Object(d["a"])(v,h,p,!1,null,null,null),y=b.exports,_=a("8690"),C=a("c1ac"),x={components:{ListHeader:f,FormDialog:y,ToolBar:_["a"]},data:function(){return{pageConfig:{total:0,pageNumber:1,pageSize:20},query:{page:0,size:20,status:"",creatorUuid:"",starttime:"",endtime:""}}},watch:{},computed:Object(s["a"])(Object(s["a"])({},Object(o["c"])({loading:function(e){return e.externalUser.loading},batchTaskListmy:function(e){return e.externalUser.batchTaskListmy},userPage:function(e){return e.externalUser.batchTaskListmyPage},permissionMap:function(e){return e.permission.permissionMap},batchAddTaskEnum:function(e){return e.enum.batchAddTask}})),{},{addStatus:function(){return function(e){switch(e){case"NOTSTARTED":return"color-primary";case"INTERRUPT":return"color-danger";case"PROCESSING":return"color - success";case"CANCELED":return"";case"FINISHED":return""}}}}),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log("请求接口导出全部")},initFilter:function(){var e=this;this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleUpdate:function(){this.initDataList(this.query)},initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getListMy",e).then((function(){t.pageConfig.pageNumber=t.userPage.pageNumber+1,t.pageConfig.total=t.userPage.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.batchTaskListmy[e].uuid;this.$router.push({path:"/batchAddTask/detail/"+t})},handleCancel:function(e){var t=this;this.$confirm("是否取消当前项","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(C["e"])({uuid:t.batchTaskListmy[e].uuid}).then((function(e){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}))}))},handleContinue:function(e){},handleSearch:function(e){var t=e.creatorUuid,a=e.endtime,i=e.starttime,n=e.status;this.query.creatorUuid=t||t,this.query.endtime=a||a,this.query.starttime=i||i,this.query.status=n||n,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){console.log(this.query),this.query.page=e-1,this.pageConfig.pageNumber=e,this.initDataList(this.query)}}},$=x,k=(a("756f"),Object(d["a"])($,i,n,!1,null,"068fa4b8",null));t["default"]=k.exports},a9d4:function(e,t,a){"use strict";var i=a("a166"),n=a.n(i);n.a},aa6b:function(e,t,a){"use strict";var i=a("b2f1"),n=a.n(i);n.a},aaec:function(e,t,a){},adb7:function(e,t,a){},add0:function(e,t,a){},ae51:function(e,t,a){},afb4:function(e,t,a){"use strict";var i=a("aff4"),n=a.n(i);n.a},afe4:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"box-card left-top-info"},[a("div",{staticClass:"info-name"},[a("img",{attrs:{src:e.userDetail.avatar}}),e._v(" "),a("div",[a("div",[e._v(e._s(e.userDetail.name))]),e._v(" "),a("span",[e._v("共"+e._s(e.idList.length)+"位客户")])]),e._v(" "),e.userDetail.role?a("el-tag",{attrs:{effect:"plain",size:"small"}},[e._v("\n              "+e._s(e.userDetail.role.name)+"\n            ")]):e._e()],1)])])],1)],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("div",[a("span",{staticClass:"font-exs"},[e._v("联系客户统计")])]),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"mt-20"},[a("el-radio-group",{model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("昨天")]),e._v(" "),a("el-radio-button",{attrs:{label:"7"}},[e._v("七天内")]),e._v(" "),a("el-radio-button",{attrs:{label:"30"}},[e._v("近30天")])],1),e._v(" "),a("el-date-picker",{staticStyle:{float:"right"},attrs:{type:"daterange","value-format":"yyyy-MM-dd HH-mm-ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)]),e._v(" "),a("div",{staticClass:"out-container"},[a("div",{staticClass:"board-container",staticStyle:{"margin-right":"20px"}},e._l(e.externalUser,(function(t,i){return a("div",{key:i,staticClass:"unit"},[a("div",{staticClass:"number"},[e._v(e._s(t||"0"))]),e._v(" "),a("div",{staticClass:"key"},[e._v(e._s(e.reflect[i]))])])})),0),e._v(" "),a("div",{staticClass:"board-container"},e._l(e.message,(function(t,i){return a("div",{key:i,staticClass:"unit"},[a("div",{staticClass:"number"},[e._v(e._s(t||"0"))]),e._v(" "),a("div",{staticClass:"key"},[e._v(e._s(e.reflect[i]))])])})),0)])]),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.idList,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"全部客户",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"avatar_name"},[a("img",{attrs:{src:t.row.externalUser.avatar,width:"40",height:"40"}}),e._v(" "),a("div",[e._v(e._s(t.row.externalUser.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[Object.keys(t.row.tags).length?a("div",e._l(t.row.tags,(function(t){return a("el-tag",{key:t.tagId,staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"mini"}},[e._v(e._s(t.tagName))])})),1):a("div",[a("span",[e._v("--")])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"添加时间",prop:"createtime",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"上次对话时间",prop:"updatedAt",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"添加渠道",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.source?e.source:"--"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_detail"],size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index)}}},[e._v("详情")])]}}])})],1)],1)],1)},n=[],s=a("5530"),r=a("2f62"),l=a("5a0c"),o=a.n(l),c={data:function(){return{value:[],date:1,form:{end:"",sta:"",userid:[]},externalUser:{},message:{},reflect:{chat_cnt:"聊天总数(条)",message_cnt:"发送消息总数(条)",reply_percentage:"已回复聊天占比",avg_reply_time:"平均首次回复时长",negative_feedback_cnt:"拉黑/删除某人(人)",new_apply_cnt:"主动添加客户数(人)",new_contact_cnt:"新增客户数(人)"}}},watch:{$route:{handler:function(e,t){var a=this,i=e.params.uuid;this.$once("hook:created",(function(){a.initData(i)}))},immediate:!0},date:{handler:function(e,t){this.changeDate(e)},immediate:!0},"form.userid.length":{handler:function(e,t){e&&this.initBoard(this.form)}}},computed:Object(s["a"])({},Object(r["c"])({userDetail:function(e){return e.user.userDetail},customerStatistics:function(e){return e.externalUser.customerStatistics},loading:function(e){return e.externalUser.loading},idList:function(e){return e.externalUser.idList},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){},mounted:function(){},methods:{initData:function(e){var t=this;this.$store.dispatch("user/getDetail",e).then((function(e){var a=e.userId;t.form.userid.push(a)})).catch((function(e){console.error(e),t.$message({type:"error",message:e||"初始化失败"})})),this.$store.dispatch("externalUser/getListExUserByUserId",{uuid:e}).then((function(){})).catch((function(e){console.error(e),t.$message({type:"error",message:e||"初始化失败"})}))},initBoard:function(e){var t=this;this.$store.dispatch("externalUser/getCustomerStatistics",e).then((function(){var e=t.customerStatistics,a=e.new_contact_cnt,i=e.new_apply_cnt,n=e.negative_feedback_cnt;t.externalUser={new_contact_cnt:a,new_apply_cnt:i,negative_feedback_cnt:n};var s=t.customerStatistics,r=s.chat_cnt,l=s.message_cnt,o=s.reply_percentage,c=s.avg_reply_time;t.message={chat_cnt:r,message_cnt:l,reply_percentage:o,avg_reply_time:c}})).catch((function(e){console.error(e),t.$message({type:"error",message:e||"初始化失败"})}))},handleChange:function(){console.log(this.value)},changeDate:function(e){this.form.sta=o()().subtract(e,"day").format("YYYY-MM-DD HH:mm:ss"),this.form.end=o()().format("YYYY-MM-DD HH:mm:ss")},handleDetail:function(e){var t=this.idList[e].externalUser.uuid;this.$router.push({path:"/externalUser/detail/"+t})},formatTime:function(){},changeTime:function(){}}},u=c,d=(a("8d5d"),a("2877")),m=Object(d["a"])(u,i,n,!1,null,"7e218cc7",null);t["default"]=m.exports},aff4:function(e,t,a){},b12a:function(e,t,a){},b142:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\menu\\detail\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},b1fd:function(e,t,a){"use strict";var i=a("fdf4"),n=a.n(i);n.a},b205:function(e,t,a){},b274:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\externalUser\\listExUserByUserId\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},b275:function(e,t,a){"use strict";var i=a("9682c"),n=a.n(i);n.a},b2b5:function(e,t,a){"use strict";var i=a("9572"),n=a.n(i);n.a},b2b6:function(e,t,a){},b2f1:function(e,t,a){},b439:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listGroup,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{prop:"name",label:"群名称",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"群主",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.owner?a("div",[e._v(e._s(t.row.owner.name))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"countNum",label:"群人数",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"昨日入群",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.countNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"昨日退群",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.countNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=a("5530"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",[a("div",[a("img",{attrs:{width:"128",height:"128",src:e.userDetail.headimgurl}})])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("div",[e._v(e._s(e.userDetail.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("div",[e._v(e._s(e.sex(e.userDetail.gender)))])]),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("div",[a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.isEmpty(e.userDetail.state)?"未指定":e.userDetail.state.name))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("div",[e._v("\n            "+e._s(e.userDetail.role&&e.userDetail.role.name)+"\n          ")])]),e._v(" "),a("el-form-item",{attrs:{label:"公司"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.org)?"未指定":e.userDetail.org.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.department)?"未指定":e.userDetail.department.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"可用"}},[a("div",[e.userDetail.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):a("el-tag",{attrs:{type:"danger"}},[e._v("不可用")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("div",[e._v(e._s(e.userDetail.userinfo&&e.userDetail.userinfo.mobile))])]),e._v(" "),a("el-form-item",{attrs:{label:"国家/地区"}},[e._v(e._s(e.isEmpty(e.userDetail.country)&&e.isEmpty(e.userDetail.city)&&e.isEmpty(e.userDetail.province)?"未设置":e.userDetail.country+e.userDetail.city+e.userDetail.province))]),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},e._l(e.userDetail.events,(function(t){return a("el-button",{key:t,attrs:{type:"primary"},on:{click:function(a){return e.handleEvents(t)}}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作历史",name:"logs",disabled:!e.userDetail.logs.length}},[a("el-scrollbar",[a("el-timeline",{staticClass:"py-3"},e._l(e.userDetail.logs,(function(t){return a("el-timeline-item",{key:t.uuid,attrs:{timestamp:t.createdAt}},[a("div",[e._v("\n                "+e._s(t.operator.nickname)+"\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#E6A23C"}},[e._v("@"+e._s(t.org.name))]),e._v(" "),a("span",{staticClass:"font-sm"},[e._v("执行了")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.event))])])])})),1)],1)],1)],1),e._v(" "),a("EventDialog",{ref:"eventDialog"})],1)},l=[],o=(a("6b54"),a("2f62")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},m=[],f={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},h=f,p=a("2877"),g=Object(p["a"])(h,d,m,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},y=[],_=(a("ac6a"),a("456d"),a("7f7f"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},T=[],w={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},S=w,D=Object(p["a"])(S,k,T,!1,null,null,null),E=D.exports,L={components:{CreateTemplate:v,EditTemplate:$,DistributeTemplate:E},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},A=L,U=Object(p["a"])(A,c,u,!1,null,null,null),q=U.exports,O={components:{EventDialog:q},data:function(){return{activeType:"detail"}},watch:{},computed:Object(s["a"])({},Object(o["c"])({eventsMap:function(e){return e.stateSettings.eventsMap},userDetail:function(e){return e.userManage.userDetail}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{sex:function(e){return"Gender_Type_Unknown"!=e&&e?"Gender_Type_Female"==e?"女":"Gender_Type_Male"==e?"男":void 0:"未知"},initHandleEvents:function(){},isEmpty:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isEmpty(e)})),handleClose:function(){this.$store.commit("component/TOGGLE_PANEL",!1)},handleEvents:function(e){console.log(this.$refs,e);var t=e;switch(e){case"enable":e="EventEnable";break;case"kick":e="EventKick";break;case"disable":e="EventDisable";break;default:return!1}this.$refs["eventDialog"].event=e,this.$refs["eventDialog"].eventType=t,this.$refs["eventDialog"].dialogVisible=!0},handleConfirm:function(){},initData:function(){}}},I=O,j=Object(p["a"])(I,r,l,!1,null,null,null),R=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"搜索群名称"}},[a("el-input",{model:{value:e.query.externalUuid,callback:function(t){e.$set(e.query,"externalUuid","string"===typeof t?t.trim():t)},expression:"query.externalUuid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"全部群主"}},[a("el-select",{attrs:{clearable:""},on:{change:e.handleChangeSecond},model:{value:e.query.userId,callback:function(t){e.$set(e.query,"userId",t)},expression:"query.userId"}},e._l(e.listOwner,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.userId}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},M=[],z={data:function(){return{query:{externalUuid:"",userId:""}}},computed:Object(s["a"])({},Object(o["c"])({listOwner:function(e){return e.externalUser.listOwner}})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},P=z,F=Object(p["a"])(P,N,M,!1,null,null,null),V=F.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},G=[],W={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},H=W,J=(a("8da4"),Object(p["a"])(H,B,G,!1,null,"9e867394",null)),Y=J.exports,X={components:{ListHeader:V,UserDetail:R,FormDialog:q,ToolBar:Y},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,externalUuid:"",userId:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({listOwner:function(e){return e.externalUser.departmentList},loading:function(e){return e.externalUser.loading},listGroup:function(e){return e.externalUser.listGroup},listGroupPage:function(e){return e.externalUser.listGroupPage}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){},beforeDestroy:function(){},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("externalUser/getListOwner").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getListGroup",e).then((function(){t.pageConfig.pageNumber=t.listGroupPage.pageNumber+1,t.pageConfig.total=t.listGroupPage.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.externalUuid,a=e.userId;this.query.externalUuid=t||this.query.externalUuid,this.query.userId=a||this.query.userId,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)}}},K=X,Q=(a("c7a5"),Object(p["a"])(K,i,n,!1,null,"75cb792e",null));t["default"]=Q.exports},b4c3:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("\n    src\\views\\mediaGroup\\list\\index.vue\n")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},b64b:function(e,t,a){"use strict";var i=a("5f1c"),n=a.n(i);n.a},b654:function(e,t,a){},b6f2:function(e,t,a){},b72e:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("\n    src\\views\\batchSendTask\\add\\index.vue\n")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},b825:function(e,t,a){"use strict";var i=a("1e53"),n=a.n(i);n.a},b87c:function(e,t,a){},b8b5:function(e,t,a){},b8bf:function(e,t,a){},b8d5:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"审批模块",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"提交人",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"提交时间",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"审批人",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"审核时间",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"描述",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=a("5530"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}},[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-form-item",[a("div",[a("img",{attrs:{width:"128",height:"128",src:e.userDetail.headimgurl}})])]),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("div",[e._v(e._s(e.userDetail.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("div",[e._v(e._s(e.sex(e.userDetail.gender)))])]),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("div",[a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.isEmpty(e.userDetail.state)?"未指定":e.userDetail.state.name))])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("div",[e._v("\n            "+e._s(e.userDetail.role&&e.userDetail.role.name)+"\n          ")])]),e._v(" "),a("el-form-item",{attrs:{label:"公司"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.org)?"未指定":e.userDetail.org.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[e._v("\n          "+e._s(e.isEmpty(e.userDetail.department)?"未指定":e.userDetail.department.name)+"\n        ")]),e._v(" "),a("el-form-item",{attrs:{label:"可用"}},[a("div",[e.userDetail.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("可用")]):a("el-tag",{attrs:{type:"danger"}},[e._v("不可用")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("div",[e._v(e._s(e.userDetail.userinfo&&e.userDetail.userinfo.mobile))])]),e._v(" "),a("el-form-item",{attrs:{label:"国家/地区"}},[e._v(e._s(e.isEmpty(e.userDetail.country)&&e.isEmpty(e.userDetail.city)&&e.isEmpty(e.userDetail.province)?"未设置":e.userDetail.country+e.userDetail.city+e.userDetail.province))]),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},e._l(e.userDetail.events,(function(t){return a("el-button",{key:t,attrs:{type:"primary"},on:{click:function(a){return e.handleEvents(t)}}},[e._v(e._s(t))])})),1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作历史",name:"logs",disabled:!e.userDetail.logs.length}},[a("el-scrollbar",[a("el-timeline",{staticClass:"py-3"},e._l(e.userDetail.logs,(function(t){return a("el-timeline-item",{key:t.uuid,attrs:{timestamp:t.createdAt}},[a("div",[e._v("\n                "+e._s(t.operator.nickname)+"\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#E6A23C"}},[e._v("@"+e._s(t.org.name))]),e._v(" "),a("span",{staticClass:"font-sm"},[e._v("执行了")]),e._v(" "),a("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.event))])])])})),1)],1)],1)],1),e._v(" "),a("EventDialog",{ref:"eventDialog"})],1)},l=[],o=(a("6b54"),a("2f62")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},m=[],f={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},h=f,p=a("2877"),g=Object(p["a"])(h,d,m,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},y=[],_=(a("ac6a"),a("456d"),a("7f7f"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},T=[],w={data:function(){return{form:{departmentsUuid:0}}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},S=w,D=Object(p["a"])(S,k,T,!1,null,null,null),E=D.exports,L={components:{CreateTemplate:v,EditTemplate:$,DistributeTemplate:E},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配部门"}}},A=L,U=Object(p["a"])(A,c,u,!1,null,null,null),q=U.exports,O={components:{EventDialog:q},data:function(){return{activeType:"detail"}},watch:{},computed:Object(s["a"])({},Object(o["c"])({eventsMap:function(e){return e.stateSettings.eventsMap},userDetail:function(e){return e.userManage.userDetail}})),mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{sex:function(e){return"Gender_Type_Unknown"!=e&&e?"Gender_Type_Female"==e?"女":"Gender_Type_Male"==e?"男":void 0:"未知"},initHandleEvents:function(){},isEmpty:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isEmpty(e)})),handleClose:function(){this.$store.commit("component/TOGGLE_PANEL",!1)},handleEvents:function(e){console.log(this.$refs,e);var t=e;switch(e){case"enable":e="EventEnable";break;case"kick":e="EventKick";break;case"disable":e="EventDisable";break;default:return!1}this.$refs["eventDialog"].event=e,this.$refs["eventDialog"].eventType=t,this.$refs["eventDialog"].dialogVisible=!0},handleConfirm:function(){},initData:function(){}}},I=O,j=Object(p["a"])(I,r,l,!1,null,null,null),R=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"敏感行为"}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.action,callback:function(t){e.$set(e.query,"action","string"===typeof t?t.trim():t)},expression:"query.action"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发生时间"}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH-mm-ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleChangeFirst},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},M=[],z={data:function(){return{value:[],query:{action:"",startTiem:"",endTime:""}}},computed:Object(s["a"])({},Object(o["c"])({})),methods:{handleChangeFirst:function(e){this.query.startTime=this.value[0],this.query.endTime=this.value[1],this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query}}},P=z,F=(a("65ea"),Object(p["a"])(P,N,M,!1,null,"7e6aa344",null)),V=F.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},G=[],W={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},H=W,J=(a("d7ce"),Object(p["a"])(H,B,G,!1,null,"76dd89de",null)),Y=J.exports,X={components:{ListHeader:V,UserDetail:R,FormDialog:q,ToolBar:Y},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,startTime:"",endTime:"",action:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.sensitive.loading},listAll:function(e){return e.sensitive.actionListAll},page:function(e){return e.sensitive.actionPage}})),created:function(){this.initDataList(this.query)},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getAllUserList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("sensitive/getActionListAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.startTime,a=e.endTime,i=e.action;this.query.startTime=t||this.query.startTime,this.query.endTime=a||this.query.endTime,this.query.action=i||this.query.action,console.log(e,"handleSearch"),this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)}}},K=X,Q=(a("d2b3"),a("01cb"),Object(p["a"])(K,i,n,!1,null,"d0c52992",null));t["default"]=Q.exports},b94e:function(e,t,a){"use strict";var i=a("0c5b"),n=a.n(i);n.a},b97d:function(e,t,a){"use strict";var i=a("99d1"),n=a.n(i);n.a},b997:function(e,t,a){},b9f2:function(e,t,a){},ba8d:function(e,t,a){"use strict";var i=a("7604"),n=a.n(i);n.a},bbab:function(e,t,a){"use strict";var i=a("bd43"),n=a.n(i);n.a},bc19:function(e,t,a){},bd43:function(e,t,a){},bdbf:function(e,t,a){"use strict";var i=a("d25a"),n=a.n(i);n.a},bf39:function(e,t,a){},bffe:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"list-group-detail app-container"},[i("div",{staticClass:"display-flex"},[i("div",{staticClass:"top-left container-card"},[i("div",{staticClass:"group-chat-info flex-between-alinecenter"},[i("div",{staticClass:"group-list flex-between-alinecenter"},[i("div",{staticClass:"group-list-left flex-column-center-alinecenter"},[i("svg-icon",{staticClass:"font-el",attrs:{"icon-class":"groupChat"}}),e._v(" "),i("div",{staticClass:"font-exs"},[e._v("群聊")])],1),e._v(" "),i("div",{staticClass:"group-item-info"},[i("div",[e._v(e._s(e.groupDetail.name?e.groupDetail.name:"--"))]),e._v(" "),i("div",{staticClass:"group-item-content display-flex align-items-center"},[i("span",[e._v("群主：")]),e._v(" "),i("strong",[e._v(e._s(e.groupDetail.ownerName))]),e._v(" "),i("i",[e._v("|")]),e._v(" "),e.groupDetail.member_list?i("span",[e._v("共 "+e._s(e.groupDetail.member_list.length)+" 位成员")]):e._e()])])]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("聊天记录")])],1),e._v(" "),i("div",{staticClass:"data-box display-flex"},[i("div",{staticClass:"data-item flex-1"},[e.groupDetail.member_list?i("p",{staticClass:"bold"},[e._v(e._s(e.groupDetail.member_list.length))]):e._e(),e._v(" "),i("p",{staticClass:"name"},[e._v("总人数")])]),e._v(" "),e._m(0),e._v(" "),e._m(1)])]),e._v(" "),i("el-card",{staticClass:"top-right",staticStyle:{width:"392px"}},[i("div",{staticClass:"head"},[i("div",{staticClass:"head-warp"},[i("div",{staticClass:"head-title flex-between-alinecenter"},[i("span",[e._v("群公告")]),e._v(" "),i("span",{staticClass:"text-blue"},[i("span",{staticClass:"icon-warp"},[i("i",{staticClass:"el-icon-refresh"}),e._v(" 更新\n              ")])])])])]),e._v(" "),e.groupDetail.notice?i("div",{staticClass:"notice-content"},[e._v(e._s(e.groupDetail.notice))]):i("div",{staticClass:"no-group"},[i("div",{staticClass:"no-group-view"},[i("img",{attrs:{src:a("50bd"),alt:""}}),e._v(" "),i("p",[e._v("暂无群公告")])])])])],1),e._v(" "),i("el-card",{staticClass:"box-card content-spacing box_vh"},[i("div",{staticClass:"common-table"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.groupDetail.member_list,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[i("el-table-column",{attrs:{label:"成员",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px"},attrs:{lazy:"",src:t.row.avatar}}),e._v(" "),i("span",[e._v(e._s(t.row.username))])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"入群时间",prop:"join_time",align:"left"}}),e._v(" "),i("el-table-column",{attrs:{label:"入群方式",prop:"scene",align:"left"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-t-button",{attrs:{type:"primary",size:"mini",auth:e.permissionMap["user"]["user_detail"],popAuth:!0},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.row)}}},[e._v("详情")])]}}])})],1)],1)])],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-item flex-1"},[a("p",{staticClass:"bold"},[e._v("0")]),e._v(" "),a("p",{staticClass:"name"},[e._v("昨日新增")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-item flex-1"},[a("p",{staticClass:"bold"},[e._v("0")]),e._v(" "),a("p",{staticClass:"name"},[e._v("昨日退群")])])}],s=a("5530"),r=a("2f62"),l={data:function(){return{}},computed:Object(s["a"])({},Object(r["c"])({groupDetail:function(e){return e.externalUser.groupDetail},loading:function(e){return e.externalUser.loading},permissionMap:function(e){return e.permission.permissionMap}})),watch:{$route:{handler:function(e,t){var a=this,i=e.query;this.$once("hook:created",(function(){a.initDetail(i)}))},immediate:!0}},methods:{initDetail:function(e){var t=this;this.$store.dispatch("externalUser/getGroupDetail",e).then((function(){})).catch((function(e){console.error(e),t.$message({type:"error",message:e||"初始化失败"})}))},handleDetail:function(e){if(1==e.type){var t=e.uuid;this.$router.push({path:"/user/detail/"+t})}if(2==e.type){var a=e.uuid;this.$router.push({path:"/externalUser/detail/"+a})}}}},o=l,c=(a("8896"),a("2877")),u=Object(c["a"])(o,i,n,!1,null,"668ea850",null);t["default"]=u.exports},c068:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.handleExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.externalUserListAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户名",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"user-card"},[a("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px"},attrs:{src:t.row.avatar,lazy:""}}),e._v(" "),a("div",{staticClass:"client-info"},[a("span",{staticClass:"remark"},[e._v(e._s(t.row.remarkName))]),e._v(" "),a("div",[e._v(e._s(t.row.wxNickName))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("async-user-drawer",{attrs:{hasPop:!0,users:e.row.user}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"企业标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!==t.row.externalUserDetailCorpTagsList.corpTags?a("tags-drawer-obj",{attrs:{tags:t.row.externalUserDetailCorpTagsList.corpTags}}):a("span",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"添加时间",align:"left",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_detail"],type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)])],1)},n=[],s=(a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"external-user-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"客户名称："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入客户名称"},on:{clear:function(t){return e.handleClearable("name")}},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属员工："}},[a("el-select",{attrs:{clearable:"",filterable:""},on:{clear:function(t){return e.handleClearable("userId")}},model:{value:e.query.userId,callback:function(t){e.$set(e.query,"userId",t)},expression:"query.userId"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.userId}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"添加时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户标签："}},[a("div",{staticClass:"tag-border"},[a("el-select",{attrs:{filterable:"",size:"mini",multiple:""},on:{change:e.handleSelectedThrottle},model:{value:e.query.tagIds,callback:function(t){e.$set(e.query,"tagIds",t)},expression:"query.tagIds"}},e._l(e.tagListAll,(function(t,i){return a("el-option-group",{key:i,attrs:{label:t.groupName}},e._l(t.tagList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.tagName,value:e.uuid}})})),1)})),1),e._v(" "),a("span",{staticClass:"tag-warp"},[a("el-radio-group",{model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:!0}},[e._v("包含任一")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("完全匹配")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            包含任一：有任意一个选择的标签的用户;\n            "),a("br"),e._v("完全匹配：必须拥有全部选择的标签的用户。\n          ")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1)],1)]),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{value:[],contractWay:[{type:"员工主动添加",id:"1"},{type:"员工被动添加",id:"2"},{type:"二维码扫码添加",id:"3"}],query:{name:"",contractWayId:"",userId:"",tagIds:[],flag:!0,startTime:"",endTime:""},timer:null}},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){e?(this.query.startTime=this.value[0],this.query.endTime=this.value[1]):(this.query.startTime="",this.query.endTime="")},handleSelectedThrottle:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query},handleClearable:function(e){this.query[e]=""}}},u=c,d=(a("2a60"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"7561f54e",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},p=[],g={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},v=g,b=(a("4f74"),Object(d["a"])(v,h,p,!1,null,"39689889",null)),y=b.exports,_=a("1b32"),C=a("adac"),x=a("ee39"),$=a("ecfe"),k={components:{AsyncUserDrawer:_["a"],ListHeader:f,ToolBar:y,UserDrawer:C["a"],TagsDrawerObj:x["a"],CustomerPagination:$["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,flag:!0,name:"",tagIds:[],userId:"",startTime:"",endTime:"",contractWayId:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.externalUser.loading},externalUserListAll:function(e){return e.externalUser.externalUserListAll},listAllPage:function(e){return e.externalUser.listAllPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){},methods:{initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getExternalUserListAll",e).then((function(){t.pageConfig.pageNumber=t.listAllPage.pageNumber+1,t.pageConfig.total=t.listAllPage.total})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=e.externalUuid;this.$router.push({path:"/externalUser/detail/"+t})},handleSearch:function(e){var t=e.tagIds,a=e.name,i=e.userId,n=e.startTime,s=e.endTime,r=(e.contractWayId,e.flag);this.query.tagIds=t?t+"":this.query.tagIds,this.query.name=a||"",this.query.userId=i||"",this.query.startTime=n||"",this.query.flag=!!r,this.query.endTime=s||"",this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},changeSize:function(e){this.query.size=e,this.initDataList(this.query)},handleExport:function(e){console.log(e)}}},T=k,w=(a("21b1"),a("f5e3b"),Object(d["a"])(T,i,n,!1,null,"6b6d35a9",null));t["default"]=w.exports},c156:function(e,t,a){},c1fb:function(e,t,a){},c297:function(e,t,a){},c637:function(e,t,a){},c670:function(e,t,a){"use strict";var i=a("fc32"),n=a.n(i);n.a},c679:function(e,t,a){"use strict";var i=a("213b"),n=a.n(i);n.a},c6a7:function(e,t,a){},c7a5:function(e,t,a){"use strict";var i=a("ebf0"),n=a.n(i);n.a},c824:function(e,t,a){"use strict";var i=a("9816"),n=a.n(i);n.a},c9e8:function(e,t,a){"use strict";var i=a("6027"),n=a.n(i);n.a},caa7:function(e,t,a){"use strict";var i=a("3d46"),n=a.n(i);n.a},cd9a:function(e,t,a){"use strict";var i=a("1b78"),n=a.n(i);n.a},ce101:function(e,t,a){"use strict";var i=a("42b7"),n=a.n(i);n.a},ce29:function(e,t,a){},ce8a:function(e,t,a){"use strict";var i=a("585a5"),n=a.n(i);n.a},cecd:function(e,t,a){},cf1ee:function(e,t,a){},cf83:function(e,t,a){},cfd3:function(e,t,a){"use strict";var i=a("dcef"),n=a.n(i);n.a},d024:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("\n    src\\views\\potentialCustomer\\batchAdd\\index.vue\n")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},d25a:function(e,t,a){},d2b3:function(e,t,a){"use strict";var i=a("4eae"),n=a.n(i);n.a},d300:function(e,t,a){"use strict";var i=a("6560"),n=a.n(i);n.a},d302:function(e,t,a){"use strict";var i=a("f2ff"),n=a.n(i);n.a},d3577:function(e,t,a){},d3d2:function(e,t,a){"use strict";var i=a("7d25"),n=a.n(i);n.a},d436:function(e,t,a){"use strict";var i=a("6015"),n=a.n(i);n.a},d4aa:function(e,t,a){"use strict";var i=a("c637"),n=a.n(i);n.a},d4b3:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",[a("el-col",{attrs:{span:5}},[a("el-card",{staticClass:"content-spacing",staticStyle:{"min-height":"84vh","margin-right":"20px"}},[a("el-form",{attrs:{"label-position":"left","label-width":"60px"}},[a("el-form-item",{attrs:{label:"搜索："}},[a("el-input",{on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearchGroup(t)}},model:{value:e.groupName,callback:function(t){e.groupName=t},expression:"groupName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearchGroup},slot:"append"})],1)],1)],1),e._v(" "),a("div",{staticClass:"text-align-center",staticStyle:{"margin-bottom":"20px"}},[a("el-t-button",{attrs:{type:"text",popAuth:!0,auth:e.permissionMap["mediaGroup"]["mediaGroup_add"],size:"mini"},on:{click:function(t){return t.stopPropagation(),e.handleCreateGroup(t)}}},[a("i",{staticClass:"el-icon-plus"}),e._v("添加分组\n          ")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"mediaGroupTable",staticStyle:{width:"100%"},attrs:{data:e.groupListAll,lazy:"","highlight-current-row":"","show-header":!1,"header-row-class-name":"el-table-header"},on:{"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{prop:"groupName"}}),e._v(" "),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["mediaGroup"]["mediaGroup_rename"]},on:{click:function(a){return a.stopPropagation(),e.handleEditGroup(t.$index)}}},[e._v("修改")]),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["mediaGroup"]["mediaGroup_delete"]},on:{click:function(a){return a.stopPropagation(),e.handleDeleteGroup(t.$index)}}},[e._v("删除")])],1)]}}])})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-card",{staticClass:"content-spacing",staticStyle:{"min-height":"84vh"}},[a("list-header",{on:{handleSearch:e.handleSearch}}),e._v(" "),a("el-divider"),e._v(" "),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{lazy:"",label:"全部",name:"zero"}},[a("all-board",{ref:"allBoard",on:{handleDelete:e.handleDelete,handleTransfer:function(t){return e.handleTransfer("allBoard",t)}}})],1),e._v(" "),a("el-tab-pane",{attrs:{lazy:"",label:"文本",name:"first"}},[a("text-board",{ref:"textBoard",on:{handleCreateText:e.handleCreateText,handleDelete:e.handleDelete,handleTransfer:function(t){return e.handleTransfer("textBoard",t)}}})],1),e._v(" "),a("el-tab-pane",{attrs:{lazy:"",label:"图片",name:"second"}},[a("image-board",{ref:"imageBoard",on:{handleDelete:e.handleDelete,handleCreateImage:e.handleCreateImage,handleTransfer:function(t){return e.handleTransfer("imageBoard",t)}}})],1),e._v(" "),a("el-tab-pane",{attrs:{lazy:"",label:"视频",name:"third"}},[a("video-board",{ref:"videoBoard",on:{handleDelete:e.handleDelete,handleCreateVideo:e.handleCreateVideo,handleTransfer:function(t){return e.handleTransfer("videoBoard",t)}}})],1),e._v(" "),a("el-tab-pane",{attrs:{lazy:"",label:"文章",name:"fourth"}},[a("article-board",{ref:"articleBoard",on:{handleEditArticle:e.handleEditArticle,handleCreateArticle:e.handleCreateArticle,handleDelete:e.handleDelete,handleTransfer:function(t){return e.handleTransfer("articleBoard",t)}}})],1),e._v(" "),a("el-tab-pane",{attrs:{lazy:"",label:"文件",name:"fifth"}},[a("file-board",{ref:"fileBoard",on:{handleDelete:e.handleDelete,handleCreateFile:e.handleCreateFile,handleTransfer:function(t){return e.handleTransfer("videoBoard",t)}}})],1)],1)],1)],1)],1),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,center:"","append-to-body":"",width:"600px","destroy-on-close":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer},on:{handleRefresh:e.handleRefresh}})],1)])],1)},o=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"分组名称",prop:"groupName"}},[a("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:e.form.groupName,callback:function(t){e.$set(e.form,"groupName","string"===typeof t?t.trim():t)},expression:"form.groupName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"可见范围"}},[a("el-radio",{attrs:{label:"department"},model:{value:e.section,callback:function(t){e.section=t},expression:"section"}},[e._v("到部门")]),e._v(" "),a("el-radio",{attrs:{label:"user"},model:{value:e.section,callback:function(t){e.section=t},expression:"section"}},[e._v("到员工")])],1),e._v(" "),a("complex-select",{attrs:{section:e.section,options:e.departmentList},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},u=[],d=a("2f62"),m=a("8cbb"),f={inject:["reload"],components:{ComplexSelect:m["a"]},data:function(){return{section:"department",selects:[],form:{groupName:""},rules:{groupName:[{required:!0,message:"请输入组名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}]}}},computed:Object(r["a"])({},Object(d["c"])({listSelect:function(e){return e.department.listSelect},departmentList:function(e){return e.department.departmentList},auditSetting:function(e){return e.sensitive.auditSetting}})),created:function(){this.initData()},methods:{initData:function(){var e=this;this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleConfirm:function(){var e=this;"department"===this.section?this.$set(this.form,"departmentUuids",this.selects.map((function(e){return e.uuid}))):this.$set(this.form,"userUuids",this.selects.map((function(e){return e.uuid})));var t=this.form;this.$refs["form"].validate((function(a){a?e.$store.dispatch("media/addGroup",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.handleRefresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})})):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},h=f,p=a("2877"),g=Object(p["a"])(h,c,u,!1,null,null,null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"分组名称",prop:"groupName"}},[a("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:e.form.groupName,callback:function(t){e.$set(e.form,"groupName","string"===typeof t?t.trim():t)},expression:"form.groupName"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},y=[],_={inject:["reload"],props:{transfer:{type:Object,default:function(){}}},data:function(){return{form:{groupName:"",uuid:""},rules:{groupName:[{required:!0,message:"请输入组名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}]}}},watch:{transfer:{handler:function(e,t){var a=e.groupName,i=e.uuid;this.form.groupName=a,this.form.uuid=i},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({listSelect:function(e){return e.department.listSelect}})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("media/rename",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.$bus.$emit("handleRefresh")})).catch((function(t){e.$message({type:"error",message:t||"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1}}},C=_,x=Object(p["a"])(C,b,y,!1,null,null,null),$=x.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[a("h3",[e._v("添加素材")]),e._v(" "),e._l(e.content,(function(t,i){return a("el-form-item",{key:i,attrs:{label:"内容"}},[a("div",{staticClass:"input-item"},[a("el-input",{staticStyle:{flex:"1"},attrs:{maxlength:"4000",type:"textarea","show-word-limit":""},model:{value:e.content[i],callback:function(t){e.$set(e.content,i,"string"===typeof t?t.trim():t)},expression:"content[index]"}}),e._v(" "),0!==i?a("el-t-button",{staticClass:"close-btn",attrs:{type:"text"},on:{click:function(t){return e.handleDelete(i)}}},[a("i",{staticClass:"el-icon-close"})]):e._e()],1)])})),e._v(" "),a("el-divider"),e._v(" "),a("h3",[e._v("素材配置")]),e._v(" "),a("el-form-item",{attrs:{label:"符合标签"}},[a("div",[a("el-radio",{attrs:{label:"CONTAINS_ANY"},model:{value:e.matchFormat,callback:function(t){e.matchFormat=t},expression:"matchFormat"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"PERFECT_MATCH"},model:{value:e.matchFormat,callback:function(t){e.matchFormat=t},expression:"matchFormat"}},[e._v("完全匹配")])],1)]),e._v(" "),a("tag-select",{attrs:{options:e.tagListSelect},model:{value:e.tagSelects,callback:function(t){e.tagSelects=t},expression:"tagSelects"}}),e._v(" "),a("el-form-item",{attrs:{label:"引用条例"}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],2)],1)},T=[],w=a("9d29"),S={components:{TagSelect:w["a"]},props:{transfer:{type:Object,default:function(){}}},data:function(){return{tagSelects:[],content:[""],form:{},type:"TEXT",groupUuid:"",matchFormat:"CONTAINS_ANY"}},watch:{transfer:{handler:function(e,t){var a=e.uuid;this.groupUuid=a},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({tagListSelect:function(e){return e.tag.tagListSelect},auditSetting:function(e){return e.sensitive.auditSetting}})),created:function(){this.initData()},mounted:function(){},methods:{initData:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleDelete:function(e){this.content.splice(e,1)},handleAddContent:function(){this.content.push("")},handleConfirm:function(){var e=this,t=this.content[0],a=this.groupUuid,i=this.type,n=this.tagSelects.reduce((function(e,t){return e.concat(t)}),[]).join(","),s=this.matchFormat,l={tagUuids:n,matchFormat:s},o=Object(r["a"])({groupUuid:a,type:i,content:t},l);this.$refs["form"].validate((function(t){t?e.$store.dispatch("media/addMediaIsAudit",{params:o}).then((function(){var t=e.auditSetting["media"]?"已提交审核":"已完成";e.$message({type:"success",message:t}),e.handleCancel(),e.handleRefresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})})):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},D=S,E=(a("1d1a"),Object(p["a"])(D,k,T,!1,null,"61f54db2",null)),L=E.exports,A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[a("h3",[e._v("添加素材")]),e._v(" "),a("el-form-item",{attrs:{label:"内容"}},[a("el-upload",{ref:"upload",attrs:{multiple:"",action:"/api/media/addMediaIsAudit","show-file-list":!0,"file-list":e.fileList,"before-upload":e.beforeImageUpload,"on-success":e.onSuccess,"auto-upload":!1,"on-error":e.onError,"list-type":"picture",data:e.data}},[a("el-t-button",{attrs:{slot:"trigger",size:"small",type:"primary",popAuth:!0,auth:e.permissionMap["media"]["media_add"]},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("图片支持png、jpg、jpeg，大小不超过2M。")])],1)],1),e._v(" "),a("el-divider"),e._v(" "),a("h3",[e._v("素材配置")]),e._v(" "),a("el-form-item",{attrs:{label:"符合标签"}},[a("div",[a("el-radio",{attrs:{label:"CONTAINS_ANY"},model:{value:e.data.matchFormat,callback:function(t){e.$set(e.data,"matchFormat",t)},expression:"data.matchFormat"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"PERFECT_MATCH"},model:{value:e.data.matchFormat,callback:function(t){e.$set(e.data,"matchFormat",t)},expression:"data.matchFormat"}},[e._v("完全匹配")])],1)]),e._v(" "),a("tag-select",{attrs:{options:e.tagListSelect},model:{value:e.tagSelects,callback:function(t){e.tagSelects=t},expression:"tagSelects"}}),e._v(" "),a("el-form-item",{attrs:{label:"引用条例"}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)],1)},U=[],q={components:{TagSelect:w["a"]},props:{transfer:{type:Object,default:function(){}}},data:function(){return{imageTypes:["image/jpeg","image/gif","image/png"],fileList:[],tagSelects:[],content:[""],form:{},data:{groupUuid:"",tagUuids:"",type:"IMAGE",matchFormat:"CONTAINS_ANY"},uploadFilesLength:0}},watch:{transfer:{handler:function(e,t){var a=e.uuid;this.data.groupUuid=a},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({tagListSelect:function(e){return e.tag.tagListSelect},permissionMap:function(e){return e.permission.permissionMap},auditSetting:function(e){return e.sensitive.auditSetting}})),created:function(){this.initData()},mounted:function(){},methods:{initData:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleDelete:function(e){this.content.splice(e,1)},handleAddContent:function(){this.content.push("")},handleConfirm:function(){var e=this;this.data.tagUuids=this.tagSelects.reduce((function(e,t){return e.concat(t)}),[]).join(","),this.$refs["form"].validate((function(t){t?e.submitUpload():e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},beforeImageUpload:function(e){console.log(e);var t=e.type,a=e.size;return a>2097152?(this.$message({type:"error",message:"文件大小超出限制"}),!1):!!this.imageTypes.some((function(e){return e===t}))||(this.$message({type:"error",message:"文件类型不支持"}),!1)},onSuccess:function(e,t,a){var i=this;if(this.uploadFilesLength++,this.$message({type:"warning",message:"操作完成"}),this.uploadFilesLength===a.length){var n=this.auditSetting["media"]?"已提交审核":"已完成";setTimeout((function(){i.$message({type:"success",message:n})}),2e3),this.$bus.$emit("handleRefresh"),this.$parent.$parent.dialogVisible=!1}},onError:function(e){this.$message({type:"error",message:e||"上传失败"})},submitUpload:function(){this.$refs.upload.submit()}}},O=q,I=(a("618c"),Object(p["a"])(O,A,U,!1,null,"26460e5c",null)),j=I.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[a("h3",[e._v("添加素材")]),e._v(" "),a("el-form-item",{attrs:{label:"内容"}},[a("el-upload",{ref:"upload",attrs:{multiple:"",action:"/api/media/addMediaIsAudit","show-file-list":!0,"file-list":e.fileList,"before-upload":e.beforeVideoUpload,"on-success":e.onSuccess,"auto-upload":!1,"on-error":e.onError,"list-type":"text",data:e.data}},[a("el-t-button",{attrs:{slot:"trigger",size:"small",type:"primary",popAuth:!0,auth:e.permissionMap["media"]["media_add"]},slot:"trigger"},[e._v("选取文件")])],1)],1),e._v(" "),a("el-divider"),e._v(" "),a("h3",[e._v("素材配置")]),e._v(" "),a("el-form-item",{attrs:{label:"符合标签"}},[a("div",[a("el-radio",{attrs:{label:"CONTAINS_ANY"},model:{value:e.data.matchFormat,callback:function(t){e.$set(e.data,"matchFormat",t)},expression:"data.matchFormat"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"PERFECT_MATCH"},model:{value:e.data.matchFormat,callback:function(t){e.$set(e.data,"matchFormat",t)},expression:"data.matchFormat"}},[e._v("完全匹配")])],1)]),e._v(" "),a("tag-select",{attrs:{options:e.tagListSelect},model:{value:e.tagSelects,callback:function(t){e.tagSelects=t},expression:"tagSelects"}}),e._v(" "),a("el-form-item",{attrs:{label:"引用条例"}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)],1)},N=[],M={components:{TagSelect:w["a"]},props:{transfer:{type:Object,default:function(){}}},data:function(){return{imageTypes:["image/jpeg","image/gif","image/png"],fileList:[],tagSelects:[],content:[""],form:{},data:{groupUuid:"",tagUuids:"",type:"FILE",matchFormat:"CONTAINS_ANY"},uploadFilesLength:0}},watch:{transfer:{handler:function(e,t){var a=e.uuid;this.data.groupUuid=a},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({tagListSelect:function(e){return e.tag.tagListSelect},permissionMap:function(e){return e.permission.permissionMap},auditSetting:function(e){return e.sensitive.auditSetting}})),created:function(){this.initData()},mounted:function(){},methods:{initData:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleDelete:function(e){this.content.splice(e,1)},handleAddContent:function(){this.content.push("")},handleConfirm:function(){var e=this;this.data.tagUuids=this.tagSelects.reduce((function(e,t){return e.concat(t)}),[]).join(","),console.log(this.data),this.$refs["form"].validate((function(t){t?e.submitUpload():e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("media/getMediaGroupListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))},onSuccess:function(e,t,a){this.uploadFilesLength++;var i=this.auditSetting["media"]?"已提交审核":"已完成";this.$message({type:"success",message:i}),this.uploadFilesLength===a.length&&(this.$bus.$emit("handleRefresh"),this.$parent.$parent.dialogVisible=!1)},onError:function(e){this.$message({type:"error",message:e||"上传失败"})},submitUpload:function(){this.$refs.upload.submit()},beforeVideoUpload:function(e){e.type;var t=e.size;return!(t>10485760)||(this.$message({type:"error",message:"文件大小超出限制"}),!1)}}},z=M,P=(a("e1b2"),Object(p["a"])(z,R,N,!1,null,"a964b4fa",null)),F=P.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[a("h3",[e._v("添加素材")]),e._v(" "),a("el-form-item",{attrs:{label:"内容"}},[a("el-upload",{ref:"upload",attrs:{multiple:"",action:"/api/media/addMediaIsAudit","show-file-list":!0,"file-list":e.fileList,"before-upload":e.beforeVideoUpload,"on-success":e.onSuccess,"auto-upload":!1,"on-error":e.onError,"list-type":"text",data:e.data}},[a("el-t-button",{attrs:{slot:"trigger",size:"small",type:"primary",popAuth:!0,auth:e.permissionMap["media"]["media_add"]},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("视频支持，大小不超过10M。")])],1)],1),e._v(" "),a("el-divider"),e._v(" "),a("h3",[e._v("素材配置")]),e._v(" "),a("el-form-item",{attrs:{label:"符合标签"}},[a("div",[a("el-radio",{attrs:{label:"CONTAINS_ANY"},model:{value:e.data.matchFormat,callback:function(t){e.$set(e.data,"matchFormat",t)},expression:"data.matchFormat"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"PERFECT_MATCH"},model:{value:e.data.matchFormat,callback:function(t){e.$set(e.data,"matchFormat",t)},expression:"data.matchFormat"}},[e._v("完全匹配")])],1)]),e._v(" "),a("tag-select",{attrs:{options:e.tagListSelect},model:{value:e.tagSelects,callback:function(t){e.tagSelects=t},expression:"tagSelects"}}),e._v(" "),a("el-form-item",{attrs:{label:"引用条例"}}),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)],1)},B=[],G={components:{TagSelect:w["a"]},props:{transfer:{type:Object,default:function(){}}},data:function(){return{imageTypes:["image/jpeg","image/gif","image/png"],fileList:[],tagSelects:[],content:[""],form:{},data:{groupUuid:"",tagUuids:"",type:"VIDEO",matchFormat:"CONTAINS_ANY"},uploadFilesLength:0}},watch:{transfer:{handler:function(e,t){var a=e.uuid;this.data.groupUuid=a},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({tagListSelect:function(e){return e.tag.tagListSelect},permissionMap:function(e){return e.permission.permissionMap},auditSetting:function(e){return e.sensitive.auditSetting}})),created:function(){this.initData()},mounted:function(){},methods:{initData:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleDelete:function(e){this.content.splice(e,1)},handleAddContent:function(){this.content.push("")},handleConfirm:function(){var e=this;this.data.tagUuids=this.tagSelects.reduce((function(e,t){return e.concat(t)}),[]).join(","),this.$refs["form"].validate((function(t){t?e.submitUpload():e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},onSuccess:function(e,t,a){var i=this;if(this.uploadFilesLength++,this.$message({type:"warning",message:"操作完成"}),this.uploadFilesLength===a.length){this.$bus.$emit("handleRefresh");var n=this.auditSetting["media"]?"已提交审核":"已完成";setTimeout((function(){i.$message({type:"success",message:n})}),2e3),this.$parent.$parent.dialogVisible=!1}},onError:function(e){this.$message({type:"error",message:e||"上传失败"})},submitUpload:function(){this.$refs.upload.submit()},beforeVideoUpload:function(e){var t=e.type,a=e.size;return a>10485760?(this.$message({type:"error",message:"文件大小超出限制"}),!1):"video/mp4"===t||(this.$message({type:"error",message:"文件类型不支持"}),!1)}}},W=G,H=(a("a7a3"),Object(p["a"])(W,V,B,!1,null,"5518923d",null)),J=H.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"内容"}},[a("el-input",{attrs:{maxlength:"4000",type:"textarea","show-word-limit":""},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content","string"===typeof t?t.trim():t)},expression:"form.content"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},X=[],K={props:{transfer:{type:Object,default:function(){}}},data:function(){return{form:{type:"TEXT",content:"",groupUuid:""}}},watch:{transfer:{handler:function(e,t){var a=e.uuid;this.form.groupUuid=a},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("media/addMedia",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("media/getMediaGroupListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}},Q=K,Z=Object(p["a"])(Q,Y,X,!1,null,null,null),ee=Z.exports,te={components:{CreateGroupTemplate:v,EditGroupTemplate:$,CreateTextTemplate:L,EditTextTemplate:ee,CreateImageTemplate:j,CreateFileTemplate:F,CreateVideoTemplate:J},data:function(){return{dialogVisible:!1,event:"CreateGroupTemplate",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"createGroup"===this.eventType?"创建分组":"editGroup"===this.eventType?"编辑分组":"createText"===this.eventType?"新建文本素材":"editText"===this.eventType?"编辑文本素材":void 0},handleRefresh:function(){this.$emit("handleRefresh")}}},ae=te,ie=Object(p["a"])(ae,l,o,!1,null,null,null),ne=ie.exports,se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"external-user-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"创建人："}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.query.cratorUuid,callback:function(t){e.$set(e.query,"cratorUuid",t)},expression:"query.cratorUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.uuid,attrs:{value:e.uuid,label:e.name}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},re=[],le={data:function(){return{value:[],contractWay:[{type:"员工主动添加",id:"1"},{type:"员工被动添加",id:"2"},{type:"二维码扫码添加",id:"3"}],query:{fileName:"",startTime:"",endTime:""},timer:null}},computed:Object(r["a"])({},Object(d["c"])({tagListAll:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect}})),created:function(){this.initFilter()},methods:{initFilter:function(){var e=this;this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){console.error(t),e.$message({type:"error",message:t||"初始化失败"})}))},handleSelectedTime:function(e){this.query.startTime=this.value[0],this.query.endTime=this.value[1]},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSelectedChange:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},oe=le,ce=(a("54c6"),Object(p["a"])(oe,se,re,!1,null,"79f6bac4",null)),ue=ce.exports,de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("board-header",{ref:"boardHeader",on:{selectAll:e.handleSelectAll,batchTransfer:e.handleBatchTransfer,batchDelete:e.handleBatchDelete,addMedia:e.handleAddMedia,toggleLayout:e.handleToggleLayout}}),e._v(" "),a("div",{staticClass:"btn-container"},[a("keep-alive",["list"===e.mode?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"mediaGroupTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,lazy:"","highlight-current-row":"","show-header":!0,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:e.selectable,type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.creator.name))])]}}],null,!1,1339504964)}),e._v(" "),a("el-table-column",{attrs:{label:"内容",prop:"content"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["UNDER_REVCIEW"===i.auditStateForOperation?a("span",{staticClass:"color-primary"}):a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleDelete(i.uuid)}}},[e._v("删除")])]}}],null,!1,956725680)})],1):a("card-grid",{ref:"cardGrid",attrs:{options:e.listAll},on:{handleDelete:e.handleDelete},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1)],1),e._v(" "),a("dialog-transfer",{ref:"dialogTransfer",attrs:{options:e.groupListAll},on:{handleTransfer:e.handleTransfer},model:{value:e.groupUuid,callback:function(t){e.groupUuid=t},expression:"groupUuid"}})],1)},me=[],fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header-container"},[a("div",{staticClass:"left-region"},[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){return e.handleToggleLayout(e.mode="list")}}},[a("i",{class:["grid"===e.mode?"color-info":"color-primary","el-icon-s-unfold"]})]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleToggleLayout(e.mode="grid")}}},[a("i",{class:["list"===e.mode?"color-info":"color-primary",,"el-icon-menu"]})]),e._v(" "),"grid"===e.mode?a("el-checkbox",{staticStyle:{"margin-left":"20px"},on:{change:e.handleSelectAll},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("全选")]):e._e()],1),e._v(" "),a("div",{staticClass:"right-region"},[e.hasBatch?a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleBatchTransfer}},[e._v("移至分组")]):e._e(),e._v(" "),e.hasBatch?a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleBatchDelete}},[e._v("批量删除")]):e._e(),e._v(" "),e.hasAdd?a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleAddMedia}},[e._v("添加素材")]):e._e()],1)])},he=[],pe={props:{hasAdd:{type:Boolean,default:!0},hasBatch:{type:Boolean,default:!0}},data:function(){return{checked:!1,mode:"list"}},methods:{handleSelectAll:function(){this.$emit("selectAll",this.checked)},handleBatchTransfer:function(){this.$emit("batchTransfer")},handleBatchDelete:function(){this.$emit("batchDelete")},handleAddMedia:function(){this.$emit("addMedia")},handleToggleLayout:function(e){this.mode=e,this.$emit("toggleLayout",e)}}},ge=pe,ve=(a("7f84"),Object(p["a"])(ge,fe,he,!1,null,"cff045a4",null)),be=ve.exports,ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-container"},[e.listAll.length?a("el-checkbox-group",{on:{change:e.handleChangeCheck},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},e._l(e.listAll,(function(t){return a("div",{key:t.uuid,staticClass:"grid-item"},[a("el-card",{staticStyle:{margin:"15px",height:"calc(100% - 30px)"}},[a("div",{staticClass:"card-inner"},[a("div",{staticClass:"content-container"},["TEXT"===t.type?a("div",[a("span",[e._v(e._s(t.content))])]):e._e(),e._v(" "),"IMAGE"===t.type?a("div",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.handleViewImage(t.localId)}}},[a("el-image",{attrs:{fit:"cover",src:"/api/public/file/"+t.localId}}),e._v(" "),a("div",{staticClass:"cover"},[a("i",{staticClass:"el-icon-picture-outline icon"})])],1):e._e(),e._v(" "),"ARTICLE"===t.type?a("div",[a("div",[a("h5",{staticClass:"text-align-center"},[e._v(e._s(t.title))]),e._v(" "),a("div",[a("span",{staticClass:"color-info font-exs"},[e._v(e._s(t.description))])]),e._v(" "),a("div",{domProps:{innerHTML:e._s(t.articleContent)}})])]):e._e(),e._v(" "),"FILE"===t.type?a("div",[a("div",{staticClass:"file"},[a("i",{staticClass:"el-icon-document color-info"}),e._v(" "),a("span",{staticClass:"font-exs color-info user-select-none"},[e._v(e._s(t.fileName))])])]):e._e(),e._v(" "),"VIDEO"===t.type?a("div",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.handleViewVideo(t.localId)}}},[a("div",[a("video-cover",{attrs:{url:t.localId}})],1),e._v(" "),a("div",{staticClass:"cover"},[a("i",{staticClass:"el-icon-video-play icon"})])]):e._e()]),e._v(" "),a("div",{staticClass:"info-container"},[a("div",{staticClass:"creator"},[t.creator?a("span",{staticClass:"font-exs color-info"},[e._v(e._s(t.creator.name))]):e._e(),e._v(" "),a("span",{staticClass:"font-exs color-info"},[e._v(e._s(t.updateAt))])]),e._v(" "),a("div",{staticClass:"operator"},[a("el-checkbox",{key:t.uuid,attrs:{label:t.uuid}},[e._v(e._s((t.uuid,"")))]),e._v(" "),a("el-t-button",{attrs:{type:"text"},on:{click:function(a){return e.handleViewTags(t.toTags)}}},[e._v("适用标签")]),e._v(" "),a("div",{staticClass:"operator-icon"},["UNDER_REVCIEW"===t.auditStateForOperation?a("span",{staticClass:"color-primary font-exs"},[e._v("审核中")]):a("el-t-button",{attrs:{type:"text"},on:{click:function(a){return e.handleDelete(t.uuid)}}},[a("i",{staticClass:"el-icon-delete"})])],1)],1)])])])],1)})),0):a("div",{staticClass:"text-align-center"},[a("span",{staticClass:"tips font-exs color-info"},[e._v("暂无数据")])]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,width:e.width,center:"",title:"适用标签","destroy-on-close":""},on:{"update:visible":function(t){e.dialogVisible=t}}},["image"===e.view?a("el-image",{attrs:{src:"/api/public/file/"+e.imageUrl},on:{load:e.onLoad}}):e._e(),e._v(" "),"video"===e.view?a("video",{ref:"videoPlay",attrs:{width:"600",height:"400",controls:"",src:"/api/public/file/"+e.videoUrl},on:{canplay:e.onCanplay}}):e._e(),e._v(" "),"tags"===e.view?a("div",[e.shownTags.length?a("div",e._l(e.shownTags,(function(t){return a("div",{key:t.groupId,staticClass:"tagGroup"},[a("div",{staticClass:"group-container"},[a("div",{staticClass:"group-name"},[a("span",{staticClass:"font-exs color-info"},[e._v(e._s(t.groupName))])]),e._v(" "),a("div",{staticClass:"tags"},e._l(t.tags,(function(t){return a("el-tag",{key:t.uuid,attrs:{size:"mini"}},[e._v(e._s(t.tagName))])})),1)])])})),0):a("div",{staticClass:"text-align-center",staticStyle:{"line-height":"30px"}},[a("span",{staticClass:"font-exs color-info"},[e._v("未设置")])])]):e._e()],1)],1)},_e=[],Ce=(a("7514"),a("ac6a"),a("456d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.coverImage?a("el-image",{staticStyle:{cursor:"pointer"},attrs:{fit:"cover",lazy:"",src:e.coverImage}}):a("video",{ref:"videoZoom",attrs:{width:"0",height:"0",src:"/api/public/file/"+e.alterUrl}})}),xe=[],$e={props:{url:{type:String,default:""}},data:function(){return{coverImage:""}},computed:{alterUrl:function(){return this.url}},mounted:function(){var e=this;this.$nextTick((function(){var t=e.$refs["videoZoom"];console.log(t),t.currentTime=1;var a=document.createElement("canvas");t.oncanplay=function(){a.width=t.videoWidth,a.height=t.videoHeight,a.getContext("2d").drawImage(t,0,0,a.width,a.height);var i=a.toDataURL("image/jpeg");e.coverImage=i}}))},methods:{handleView:function(e){console.log(e),this.$emit("handleView",e)}}},ke=$e,Te=Object(p["a"])(ke,Ce,xe,!1,null,null,null),we=Te.exports,Se={name:"CardGrid",components:{VideoCover:we},props:{value:{type:Array,default:function(){return[]}},options:{type:Array,default:function(){return[]}}},model:{prop:"value",event:"change"},data:function(){return{width:"",tagsWidth:"640px",imageWidth:"",videoWidth:"640px",dialogVisible:!1,checked:this.value,view:"video",videoUrl:"",imageUrl:"",shownTags:[]}},watch:{value:{handler:function(e,t){this.checked=e}}},computed:{listAll:function(){return this.options},alterValue:function(){return this.value}},mounted:function(){},methods:{handleEdit:function(e){this.$emit("handleEdit",e)},handleDelete:function(e){this.$emit("handleDelete",e)},handleChangeCheck:function(e){this.$emit("change",e)},handleViewVideo:function(e){this.videoUrl=e,this.view="video",this.dialogVisible=!0},handleViewTags:function(e){this.view="tags",this.shownTags=this.grouping(e),this.dialogVisible=!0},grouping:function(e){return Object.keys(e).length?e.reduce((function(e,t){var a=e.find((function(e){return t.groupId===e.groupId}));if(a)a.tags.push(t);else{var i={groupId:t.groupId,groupName:t.groupName,tags:[t]};e.push(i)}return e}),[]):[]},handleViewImage:function(e){this.imageUrl=e,this.view="image",this.dialogVisible=!0},handleCheckAll:function(){var e=this,t=[];this.checked.length===this.listAll.length?this.checked=[]:this.checked.length<this.listAll.length&&(this.checked=[],t=this.listAll.map((function(e){return e.uuid})),t.forEach((function(t){e.checked.push(t)}))),this.$emit("change",t)},onLoad:function(e){var t=e.target,a=0;(t.fileSize>0||t.width>1&&t.height>1)&&(a=t.width+40),this.width=a+"px"},onCanplay:function(e){this.width="640px"}}},De=Se,Ee=(a("e3cd"),a("96df"),Object(p["a"])(De,ye,_e,!1,null,"1c646dfc",null)),Le=Ee.exports,Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,"modal-append-to-body":!1,center:"","append-to-body":"",width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"分组",prop:"uuid"}},[a("el-select",{on:{change:e.handleChange},model:{value:e.form.uuid,callback:function(t){e.$set(e.form,"uuid",t)},expression:"form.uuid"}},e._l(e.options,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.groupName,value:e.uuid}})})),1)],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-t-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-t-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)],1)},Ue=[],qe=(a("c5f6"),{props:{value:{type:Number,default:null},options:{type:Array,default:function(){return[]}}},model:{prop:"value",event:"change"},data:function(){return{title:"移至分组",dialogVisible:!1,uuid:"",rules:{uuid:[{required:!0,message:"请选择目标分组",trigger:"blur"}]},form:{uuid:""}}},watch:{value:{handler:function(e,t){e&&(this.form.uuid=e)},immediate:!0}},methods:{handleChange:function(){this.$emit("change",this.form.uuid)},handleCancel:function(){this.dialogVisible=!1},handleConfirm:function(){var e=this;this.$refs["form"].validate((function(t){t?e.$emit("handleTransfer"):e.$message({type:"warning",message:"请检查输入"})}))}}}),Oe=qe,Ie=Object(p["a"])(Oe,Ae,Ue,!1,null,null,null),je=Ie.exports,Re={components:{BoardHeader:be,CardGrid:Le,DialogTransfer:je},data:function(){return{selects:[],groupUuid:0,mode:"list"}},watch:{selects:{handler:function(e,t){var a=this;e.length!==this.listAll.length&&this.$nextTick((function(){a.$refs["boardHeader"].checked=!1}))},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({loading:function(e){return e.media.loading},permissionMap:function(e){return e.permission.permissionMap},listAll:function(e){return e.media.textListAll},mediaType:function(e){return e.enum.mediaType},groupListAll:function(e){return e.media.mediaGroupListAll}})),methods:{handleEdit:function(e){},handleDelete:function(e){var t=[];"number"===typeof e||"string"===typeof e?t.push(e):t=e,this.$emit("handleDelete",t)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleTransfer:function(){var e=this.selects,t=this.groupUuid;this.$emit("handleTransfer",{mediaUuid:e,groupUuid:t})},handleSelectAll:function(e){"list"===this.mode?this.$refs["mediaGroupTable"].toggleAllSelection():this.$refs["cardGrid"].handleCheckAll()},handleBatchTransfer:function(){console.log("移动分组"),this.selects.length?this.$refs["dialogTransfer"].dialogVisible=!0:this.$message({type:"warning",message:"请至少勾选一项！"})},handleBatchDelete:function(){if(this.selects.length){var e=this.selects;this.$emit("handleDelete",e)}else this.$message({type:"warning",message:"请至少选择一项！"})},handleToggleLayout:function(e){this.mode=e},closeDialog:function(){this.$refs["dialogTransfer"].dialogVisible=!1},handleAddMedia:function(){this.$emit("handleCreateText")},selectable:function(e,t){return"UNDER_REVCIEW"!==e.auditStateForOperation}}},Ne=Re,Me=Object(p["a"])(Ne,de,me,!1,null,"79b9af5e",null),ze=Me.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("board-header",{ref:"boardHeader",on:{selectAll:e.handleSelectAll,batchTransfer:e.handleBatchTransfer,batchDelete:e.handleBatchDelete,addMedia:e.handleAddMedia,toggleLayout:e.handleToggleLayout}}),e._v(" "),a("div",{staticClass:"btn-container"},[a("keep-alive",["list"===e.mode?a("el-table",{ref:"mediaGroupTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,lazy:"","highlight-current-row":"","show-header":!0,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:e.selectable,type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"缩略图"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-image",{staticStyle:{width:"36px",height:"36px",cursor:"pointer"},attrs:{fit:"cover",src:"/api/public/file/"+i.localId},on:{click:function(t){return e.handleView(i.localId)}}})]}}],null,!1,4161150650)}),e._v(" "),a("el-table-column",{attrs:{label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.creator.name))])]}}],null,!1,3631078758)}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["UNDER_REVCIEW"===i.auditStateForOperation?a("span",{staticClass:"color-primary"},[e._v("审核中")]):a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleDelete(i.uuid)}}},[e._v("删除")])]}}],null,!1,609190278)})],1):a("card-grid",{ref:"cardGrid",attrs:{options:e.listAll},on:{handleDelete:e.handleDelete},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,width:e.width},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-image",{attrs:{src:"/api/public/file/"+e.originImage},on:{load:e.onLoad}})],1)],1),e._v(" "),a("dialog-transfer",{ref:"dialogTransfer",attrs:{options:e.groupListAll},on:{handleTransfer:e.handleTransfer},model:{value:e.groupUuid,callback:function(t){e.groupUuid=t},expression:"groupUuid"}})],1)},Fe=[],Ve={components:{BoardHeader:be,CardGrid:Le,DialogTransfer:je},name:"ImageBoard",data:function(){return{width:"",originImage:"",dialogVisible:!1,selects:[],groupUuid:0,mode:"list"}},watch:{selects:{handler:function(e,t){var a=this;e.length!==this.listAll.length&&this.$nextTick((function(){a.$refs["boardHeader"].checked=!1}))},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({permissionMap:function(e){return e.permission.permissionMap},listAll:function(e){return e.media.imageListAll},loading:function(e){return e.media.loading},mediaType:function(e){return e.enum.mediaType},groupListAll:function(e){return e.media.mediaGroupListAll}})),methods:{handleAddMedia:function(){this.$emit("handleCreateImage")},handleView:function(e){this.originImage=e,this.dialogVisible=!0},onLoad:function(e){var t=e.target,a=0;(t.fileSize>0||t.width>1&&t.height>1)&&(a=t.width+40),this.width=a+"px"},handleEdit:function(e){},handleDelete:function(e){var t=[];"number"===typeof e||"string"===typeof e?t.push(e):t=e,this.$emit("handleDelete",t)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleTransfer:function(){var e=this.selects,t=this.groupUuid;this.$emit("handleTransfer",{mediaUuid:e,groupUuid:t})},handleSelectAll:function(e){"list"===this.mode?this.$refs["mediaGroupTable"].toggleAllSelection():this.$refs["cardGrid"].handleCheckAll()},handleBatchTransfer:function(){console.log("移动分组"),this.selects.length?this.$refs["dialogTransfer"].dialogVisible=!0:this.$message({type:"warning",message:"请至少勾选一项！"})},handleBatchDelete:function(){if(this.selects.length){var e=this.selects;this.$emit("handleDelete",e)}else this.$message({type:"warning",message:"请至少选择一项！"})},handleToggleLayout:function(e){this.mode=e},closeDialog:function(){this.$refs["dialogTransfer"].dialogVisible=!1},selectable:function(e,t){return"UNDER_REVCIEW"!==e.auditStateForOperation}}},Be=Ve,Ge=Object(p["a"])(Be,Pe,Fe,!1,null,"6662669c",null),We=Ge.exports,He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("board-header",{ref:"boardHeader",on:{selectAll:e.handleSelectAll,batchTransfer:e.handleBatchTransfer,batchDelete:e.handleBatchDelete,addMedia:e.handleAddMedia,toggleLayout:e.handleToggleLayout}}),e._v(" "),a("div",{staticClass:"btn-container"},[a("keep-alive",["list"===e.mode?a("el-table",{ref:"mediaGroupTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,lazy:"","highlight-current-row":"","show-header":!0,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:e.selectable,type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"预览图"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e.coverImage?a("el-image",{staticStyle:{width:"36px",height:"36px",cursor:"pointer"},attrs:{fit:"cover",src:e.coverImage},on:{click:function(t){return e.handleView(i.localId)}}}):a("video",{ref:"videoZoom",attrs:{width:"0",height:"0",src:"/api/public/file/"+i.localId}})]}}],null,!1,71690724)}),e._v(" "),a("el-table-column",{attrs:{label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.creator.name))])]}}],null,!1,3631078758)}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return["UNDER_REVCIEW"===t.row.auditStateForOperation?a("span",{staticClass:"color-primary"},[e._v("审核中")]):a("el-t-button",{attrs:{type:"text"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.$index)}}},[e._v("删除")])]}}],null,!1,3689266675)})],1):a("card-grid",{ref:"cardGrid",attrs:{options:e.listAll},on:{handleDelete:e.handleDelete},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,width:"640px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("video",{ref:"videoPlay",attrs:{width:"600",height:"400",controls:"",src:"/api/public/file/"+e.originUrl},on:{canplay:e.onLoad}})]),e._v(" "),a("dialog-transfer",{ref:"dialogTransfer",attrs:{options:e.groupListAll},on:{handleTransfer:e.handleTransfer},model:{value:e.groupUuid,callback:function(t){e.groupUuid=t},expression:"groupUuid"}})],1)},Je=[],Ye={components:{BoardHeader:be,CardGrid:Le,DialogTransfer:je},data:function(){return{coverImage:"",originUrl:"",width:"",dialogVisible:!1,selects:[],groupUuid:0,mode:"list"}},watch:{selects:{handler:function(e,t){var a=this;e.length!==this.listAll.length&&this.$nextTick((function(){a.$refs["boardHeader"].checked=!1}))},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({loading:function(e){return e.media.loading},permissionMap:function(e){return e.permission.permissionMap},listAll:function(e){return e.media.videoListAll},mediaType:function(e){return e.enum.mediaType},groupListAll:function(e){return e.media.mediaGroupListAll}})),mounted:function(){var e=this;this.$nextTick((function(){var t=e.$refs["videoZoom"];if(console.log(t),t){t.currentTime=1;var a=document.createElement("canvas");a.width=36,a.height=36,t.oncanplay=function(){a.getContext("2d").drawImage(t,0,0,a.width,a.height);var i=a.toDataURL("image/jpeg");e.coverImage=i}}}))},methods:{handleAddMedia:function(){this.$emit("handleCreateVideo")},handleView:function(e){this.originUrl=e,this.dialogVisible=!0},onLoad:function(e){var t=e.target,a=0;(t.fileSize>0||t.width>1&&t.height>1)&&(a=this.$refs["videoPlay"].videoWidth+40),this.width=a+"px"},handleEdit:function(e){},handleDelete:function(e){var t=[];"number"===typeof e||"string"===typeof e?t.push(e):t=e,this.$emit("handleDelete",t)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleTransfer:function(){var e=this.selects,t=this.groupUuid;this.$emit("handleTransfer",{mediaUuid:e,groupUuid:t})},handleSelectAll:function(e){"list"===this.mode?this.$refs["mediaGroupTable"].toggleAllSelection():this.$refs["cardGrid"].handleCheckAll()},handleBatchTransfer:function(){console.log("移动分组"),this.selects.length?this.$refs["dialogTransfer"].dialogVisible=!0:this.$message({type:"warning",message:"请至少勾选一项！"})},handleBatchDelete:function(){if(this.selects.length){var e=this.selects;this.$emit("handleDelete",e)}else this.$message({type:"warning",message:"请至少选择一项！"})},handleToggleLayout:function(e){this.mode=e},closeDialog:function(){this.$refs["dialogTransfer"].dialogVisible=!1},selectable:function(e,t){return"UNDER_REVCIEW"!==e.auditStateForOperation}}},Xe=Ye,Ke=Object(p["a"])(Xe,He,Je,!1,null,"8367800a",null),Qe=Ke.exports,Ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("board-header",{ref:"boardHeader",on:{selectAll:e.handleSelectAll,batchTransfer:e.handleBatchTransfer,batchDelete:e.handleBatchDelete,addMedia:e.handleAddMedia,toggleLayout:e.handleToggleLayout}}),e._v(" "),a("div",{staticClass:"btn-container"},[a("keep-alive",["list"===e.mode?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"mediaGroupTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header","show-header":!0},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:e.selectable,type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.creator.name))])]}}],null,!1,1339504964)}),e._v(" "),a("el-table-column",{attrs:{label:"标题",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"描述",prop:"description"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["UNDER_REVCIEW"===i.auditStateForOperation?a("div",[a("span",{staticClass:"color-primary"},[e._v("审核中")])]):a("div",[a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleEdit(i.uuid)}}},[e._v("编辑")]),e._v(" "),a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleDelete(i.uuid)}}},[e._v("删除")])],1)]}}],null,!1,3135697143)})],1):a("card-grid",{ref:"cardGrid",attrs:{options:e.listAll},on:{handleDelete:e.handleDelete},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1)],1),e._v(" "),a("dialog-transfer",{ref:"dialogTransfer",attrs:{options:e.groupListAll},on:{handleTransfer:e.handleTransfer},model:{value:e.groupUuid,callback:function(t){e.groupUuid=t},expression:"groupUuid"}})],1)},et=[],tt={components:{BoardHeader:be,CardGrid:Le,DialogTransfer:je},data:function(){return{selects:[],groupUuid:0,mode:"list"}},watch:{selects:{handler:function(e,t){var a=this;e.length!==this.listAll.length&&this.$nextTick((function(){a.$refs["boardHeader"].checked=!1}))},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({loading:function(e){return e.media.loading},permissionMap:function(e){return e.permission.permissionMap},listAll:function(e){return e.media.articleListAll},mediaType:function(e){return e.enum.mediaType},groupListAll:function(e){return e.media.mediaGroupListAll}})),methods:{handleEdit:function(e){this.$emit("handleEditArticle",e)},handleDelete:function(e){var t=[];"number"===typeof e||"string"===typeof e?t.push(e):t=e,this.$emit("handleDelete",t)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleTransfer:function(){var e=this.selects,t=this.groupUuid;this.$emit("handleTransfer",{mediaUuid:e,groupUuid:t})},handleSelectAll:function(e){"list"===this.mode?this.$refs["mediaGroupTable"].toggleAllSelection():this.$refs["cardGrid"].handleCheckAll()},handleBatchTransfer:function(){console.log("移动分组"),this.selects.length?this.$refs["dialogTransfer"].dialogVisible=!0:this.$message({type:"warning",message:"请至少勾选一项！"})},handleBatchDelete:function(){if(this.selects.length){var e=this.selects;this.$emit("handleDelete",e)}else this.$message({type:"warning",message:"请至少选择一项！"})},handleToggleLayout:function(e){this.mode=e},closeDialog:function(){this.$refs["dialogTransfer"].dialogVisible=!1},handleAddMedia:function(){this.$emit("handleCreateArticle")},selectable:function(e,t){return"UNDER_REVCIEW"!==e.auditStateForOperation}}},at=tt,it=(a("50cd"),Object(p["a"])(at,Ze,et,!1,null,"33ff279d",null)),nt=it.exports,st=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("board-header",{ref:"boardHeader",on:{selectAll:e.handleSelectAll,batchTransfer:e.handleBatchTransfer,batchDelete:e.handleBatchDelete,addMedia:e.handleAddMedia,toggleLayout:e.handleToggleLayout}}),e._v(" "),a("div",{staticClass:"btn-container"},[a("keep-alive",["list"===e.mode?a("el-table",{ref:"mediaGroupTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,lazy:"","highlight-current-row":"","show-header":!0,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:e.selectable,type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"文件名",prop:"fileName"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.creator.name))])]}}],null,!1,3631078758)}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["UNDER_REVCIEW"===i.auditStateForOperation?a("span",{staticClass:"color-primary"},[e._v("审核中")]):a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleDelete(i.uuid)}}},[e._v("删除")])]}}],null,!1,609190278)})],1):a("card-grid",{ref:"cardGrid",attrs:{options:e.listAll},on:{handleDelete:e.handleDelete},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1)],1),e._v(" "),a("dialog-transfer",{ref:"dialogTransfer",attrs:{options:e.groupListAll},on:{handleTransfer:e.handleTransfer},model:{value:e.groupUuid,callback:function(t){e.groupUuid=t},expression:"groupUuid"}})],1)},rt=[],lt={components:{BoardHeader:be,CardGrid:Le,DialogTransfer:je},data:function(){return{selects:[],groupUuid:0,mode:"list"}},watch:{selects:{handler:function(e,t){var a=this;e.length!==this.listAll.length&&this.$nextTick((function(){a.$refs["boardHeader"].checked=!1}))},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({permissionMap:function(e){return e.permission.permissionMap},listAll:function(e){return e.media.fileListAll},loading:function(e){return e.media.loading},mediaType:function(e){return e.enum.mediaType},groupListAll:function(e){return e.media.mediaGroupListAll}})),methods:{handleAddMedia:function(){this.$emit("handleCreateFile")},handleView:function(e){this.originImage=e,this.dialogVisible=!0},onLoad:function(e){var t=e.target,a=0;(t.fileSize>0||t.width>1&&t.height>1)&&(a=t.width+40),this.width=a+"px"},handleEdit:function(e){},handleDelete:function(e){var t=[];"number"===typeof e||"string"===typeof e?t.push(e):t=e,this.$emit("handleDelete",t)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleTransfer:function(){var e=this.selects,t=this.groupUuid;this.$emit("handleTransfer",{mediaUuid:e,groupUuid:t})},handleSelectAll:function(e){"list"===this.mode?this.$refs["mediaGroupTable"].toggleAllSelection():this.$refs["cardGrid"].handleCheckAll()},handleBatchTransfer:function(){console.log("移动分组"),this.selects.length?this.$refs["dialogTransfer"].dialogVisible=!0:this.$message({type:"warning",message:"请至少勾选一项！"})},handleBatchDelete:function(){if(this.selects.length){var e=this.selects;this.$emit("handleDelete",e)}else this.$message({type:"warning",message:"请至少选择一项！"})},handleToggleLayout:function(e){this.mode=e},closeDialog:function(){this.$refs["dialogTransfer"].dialogVisible=!1},selectable:function(e,t){return"UNDER_REVCIEW"!==e.auditStateForOperation}}},ot=lt,ct=Object(p["a"])(ot,st,rt,!1,null,"71c002c8",null),ut=ct.exports,dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("board-header",{ref:"boardHeader",attrs:{hasAdd:!1},on:{selectAll:e.handleSelectAll,batchTransfer:e.handleBatchTransfer,batchDelete:e.handleBatchDelete,addMedia:e.handleAddMedia,toggleLayout:e.handleToggleLayout}}),e._v(" "),a("div",{staticClass:"btn-container"},[a("keep-alive",["list"===e.mode?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"mediaGroupTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,lazy:"","highlight-current-row":"","show-header":!0,"header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:e.selectable,type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.creator.name))])]}}],null,!1,1339504964)}),e._v(" "),a("el-table-column",{attrs:{label:"资源类型"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e.mediaType[i.type]))])]}}],null,!1,35385553)}),e._v(" "),a("el-table-column",{attrs:{label:"标题"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.title||"--"))])]}}],null,!1,4163490675)}),e._v(" "),a("el-table-column",{attrs:{label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.description||"--"))])]}}],null,!1,1168446997)}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["UNDER_REVCIEW"===i.auditStateForOperation?a("span",{staticClass:"color-primary"},[e._v("审核中")]):a("el-t-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleDelete(i.uuid)}}},[e._v("删除")])]}}],null,!1,609190278)})],1):a("card-grid",{ref:"cardGrid",attrs:{options:e.listAll},on:{handleDelete:e.handleDelete},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1)],1),e._v(" "),a("dialog-transfer",{ref:"dialogTransfer",attrs:{options:e.groupListAll},on:{handleTransfer:e.handleTransfer},model:{value:e.groupUuid,callback:function(t){e.groupUuid=t},expression:"groupUuid"}})],1)},mt=[],ft={components:{BoardHeader:be,CardGrid:Le,DialogTransfer:je},data:function(){return{checked:!1,mode:"list",selects:[],groupUuid:0}},watch:{selects:{handler:function(e,t){var a=this;e.length!==this.listAll.length&&this.$nextTick((function(){a.$refs["boardHeader"].checked=!1}))},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({loading:function(e){return e.media.loading},permissionMap:function(e){return e.permission.permissionMap},listAll:function(e){return e.media.mediaList},mediaType:function(e){return e.enum.mediaType},groupListAll:function(e){return e.media.mediaGroupListAll}})),mounted:function(){},methods:{handleEdit:function(e){},handleDelete:function(e){var t=[];"number"===typeof e||"string"===typeof e?t.push(e):t=e,this.$emit("handleDelete",t)},handleSelectionChange:function(e){this.selects=e.map((function(e){return e.uuid}))},handleTransfer:function(){var e=this.selects,t=this.groupUuid;this.$emit("handleTransfer",{mediaUuid:e,groupUuid:t})},handleSelectAll:function(e){"list"===this.mode?this.$refs["mediaGroupTable"].toggleAllSelection():this.$refs["cardGrid"].handleCheckAll()},handleBatchTransfer:function(){console.log("移动分组"),this.selects.length?this.$refs["dialogTransfer"].dialogVisible=!0:this.$message({type:"warning",message:"请至少勾选一项！"})},handleBatchDelete:function(){if(this.selects.length){var e=this.selects;this.$emit("handleDelete",e)}else this.$message({type:"warning",message:"请至少选择一项！"})},handleAddMedia:function(){},handleToggleLayout:function(e){this.mode=e},closeDialog:function(){this.$refs["dialogTransfer"].dialogVisible=!1},selectable:function(e,t){return"UNDER_REVCIEW"!==e.auditStateForOperation}}},ht=ft,pt=(a("327a"),Object(p["a"])(ht,dt,mt,!1,null,"54a3411b",null)),gt=pt.exports,vt={name:"MediaListAll",components:{ListHeader:ue,FormDialog:ne,TextBoard:ze,ImageBoard:We,VideoBoard:Qe,ArticleBoard:nt,FileBoard:ut,AllBoard:gt},data:function(){return{query:{startTime:"",endTime:"",fileName:"",groupUuid:""},groupName:"",activeName:"zero",currentGroup:{},uploadImage:{groupUuid:"",type:"IMAGE"},uploadVideo:{groupUuid:"",type:"VIDEO"},uploadFile:{groupUuid:"",type:"FILE"},imageTypes:["image/jpeg","image/gif","image/png"],timer:null}},watch:{groupListAll:{handler:function(e,t){var a=this;this.$nextTick((function(){var e;a.$refs["mediaGroupTable"].setCurrentRow(a.groupListAll[0]);var t=null===(e=a.groupListAll[0])||void 0===e?void 0:e.uuid,i={groupUuid:t};a.initMediaList(i),a.currentGroup=a.groupListAll[0]}))},immediate:!0}},computed:Object(r["a"])({},Object(d["c"])({groupListAll:function(e){return e.media.mediaGroupListAll},loading:function(e){return e.media.loading},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.handleRefresh(e.query),e.initDataList()})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{handleSearchGroup:function(){var e=this.groupName;this.initDataList({groupName:e})},handleSearch:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){var a,i;t.query.groupUuid=null===(a=t.currentGroup)||void 0===a?void 0:a.uuid;var n=null===(i=t.currentGroup)||void 0===i?void 0:i.uuid;t.initMediaList(Object(r["a"])(Object(r["a"])({},e),{},{groupUuid:n})),t.activeName="zero"}),1e3)},initDataList:function(e){var t=this;this.$store.dispatch("media/getMediaGroupListAll",e).then((function(){})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},initMediaList:function(e){var t=this;this.$store.dispatch("media/getMediaListAll",e).then((function(){})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleEditGroup:function(e){var t=this.groupListAll[e];this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="EditGroupTemplate",this.$refs["formDialog"].eventType="editGroup",this.$refs["formDialog"].transfer=t},handleCreateGroup:function(){this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="CreateGroupTemplate",this.$refs["formDialog"].eventType="createGroup"},handleCreateVideo:function(){this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="CreateVideoTemplate",this.$refs["formDialog"].eventType="createVideo",this.$refs["formDialog"].transfer=this.currentGroup},handleCreateFile:function(){this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="CreateFileTemplate",this.$refs["formDialog"].eventType="createFile",this.$refs["formDialog"].transfer=this.currentGroup},handleDeleteGroup:function(e){var t=this,a=this.groupListAll[e].uuid,i={uuid:a};this.$confirm("是否删除当前分组","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("media/deleteMediaGroup",i).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e,duration:3e3})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleRowClick:function(e){console.log(e),this.currentGroup=e,this.query.groupUuid=e.uuid;var t={groupUuid:e.uuid};this.initMediaList(t)},handleCreateText:function(){this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="CreateTextTemplate",this.$refs["formDialog"].eventType="createText",this.$refs["formDialog"].transfer=this.currentGroup},handleEditText:function(e){console.log(e);e.uuid;this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="EditTextTemplate",this.$refs["formDialog"].eventType="editText"},handleCreateImage:function(){this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].event="CreateImageTemplate",this.$refs["formDialog"].eventType="createImage",this.$refs["formDialog"].transfer=this.currentGroup},handleTransfer:function(e,t){var a=this;this.$store.dispatch("media/moveMedieToGroup",t).then((function(){a.$message({type:"success",message:"操作成功"}),a.initMediaList(a.query),a.$refs[e].closeDialog()})).catch((function(e){a.$message({type:"error",message:e||"操作失败"})}))},handleDelete:function(e){var t=this,a={mediaUuids:e};this.$confirm("是否删除当前素材","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("media/batchDeleteMedia",a).then((function(){t.$message({type:"success",message:"操作成功"}),t.handleRefresh()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleCreateArticle:function(e){this.$router.push({path:"/media/article/detail/0"})},handleEditArticle:function(e){this.$router.push({path:"/media/article/detail/"+e})},handleRefresh:function(){var e=this.currentGroup.uuid;this.query.groupUuid=e,this.initMediaList(Object(r["a"])(Object(r["a"])({},this.query),{},{groupUuid:e}))}}},bt=vt,yt=(a("55fd"),Object(p["a"])(bt,i,n,!1,null,"251c4a0b",null));t["default"]=yt.exports},d4f7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\permission\\list\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},d5a5:function(e,t,a){},d6ee:function(e,t,a){"use strict";var i=a("b654"),n=a.n(i);n.a},d70c:function(e,t,a){"use strict";var i=a("4b1b"),n=a.n(i);n.a},d713:function(e,t,a){"use strict";var i=a("19f8"),n=a.n(i);n.a},d72f:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("src\\views\\department\\detail\\index.vue")])},n=[],s={},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=o.exports},d7ce:function(e,t,a){"use strict";var i=a("61de"),n=a.n(i);n.a},d84b:function(e,t,a){},d8c2:function(e,t,a){"use strict";var i=a("8f3c"),n=a.n(i);n.a},d8e6:function(e,t,a){"use strict";var i=a("0cb8"),n=a.n(i);n.a},d977:function(e,t,a){e.exports=a.p+"static/img/0.e4f8cd9c.png"},d9fb:function(e,t,a){"use strict";var i=a("7a61"),n=a.n(i);n.a},daca:function(e,t,a){"use strict";var i=a("9e60"),n=a.n(i);n.a},dc31:function(e,t,a){"use strict";var i=a("a6cb"),n=a.n(i);n.a},dcef:function(e,t,a){},ddfc:function(e,t,a){},de008:function(e,t,a){},de8f:function(e,t,a){},dfb0:function(e,t,a){},e0e2:function(e,t,a){},e1b2:function(e,t,a){"use strict";var i=a("4952"),n=a.n(i);n.a},e1e9:function(e,t,a){},e200:function(e,t,a){"use strict";var i=a("0115"),n=a.n(i);n.a},e28e:function(e,t,a){"use strict";var i=a("0717"),n=a.n(i);n.a},e2ea:function(e,t,a){},e3cd:function(e,t,a){"use strict";var i=a("fc12"),n=a.n(i);n.a},e428:function(e,t,a){},e534c:function(e,t,a){"use strict";var i=a("6aff"),n=a.n(i);n.a},e6c0:function(e,t,a){"use strict";var i=a("047b"),n=a.n(i);n.a},e892:function(e,t,a){"use strict";var i=a("bf39"),n=a.n(i);n.a},e8a6:function(e,t,a){"use strict";var i=a("b87c"),n=a.n(i);n.a},e974f:function(e,t,a){"use strict";var i=a("8b50"),n=a.n(i);n.a},eb95:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("任务详情")])]),e._v(" "),a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"创建人："}},[a("user-tag",{attrs:{hasPop:!1,user:e.detail.creator}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开始时间："}},[e._v(e._s(e.detail.startTime))]),e._v(" "),a("el-form-item",{attrs:{label:"邀请消息："}},[e._v(e._s(e.detail.content))])],1)],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("数据统计")])])]),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("header-detail",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.result_list,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"客户名",prop:"potentialCustomer.name"}}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",prop:"potentialCustomer.mobile"}}),e._v(" "),a("el-table-column",{attrs:{label:"预设标签"},scopedSlots:e._u([{key:"default",fn:function(t){return[Object.keys(t.row.potentialCustomer.potentialCustomerTags).length?a("tags-drawer",{attrs:{tags:t.row.potentialCustomer.potentialCustomerTags}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"添加次数",prop:"potentialCustomer.tryCount"}}),e._v(" "),a("el-table-column",{attrs:{label:"入库时间",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属员工"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("user-tag",{attrs:{hasPop:!1,user:e.row.potentialCustomer.belong}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"添加员工"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("user-tag",{attrs:{hasPop:!1,user:e.row.potentialCustomer.creator}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:e.addStatus(t.row.addResult)},[e._v(e._s(e.batchAddTaskEnum[t.row.addResult]))])]}}])})],1)],1)],1)},n=[],s=(a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},l=[],o=a("2f62"),c={components:{},data:function(){return{dialogVisible:!1,event:"",eventType:""}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("cancelTask"==this.eventType)return"取消"}}},u=c,d=a("2877"),m=Object(d["a"])(u,r,l,!1,null,null,null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:""}},[a("el-form-item",{attrs:{label:"任务状态："}},[a("el-select",{attrs:{clearable:""},on:{change:e.handleChangeFirst},model:{value:e.query.status,callback:function(t){e.$set(e.query,"status",t)},expression:"query.status"}},e._l(e.statusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"客户名："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.mobile,callback:function(t){e.$set(e.query,"mobile",t)},expression:"query.mobile"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary",clearable:""},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},p=[],g={data:function(){return{statusList:[{value:"NOTSTARTED",label:"未开始"},{value:"INTERRUPT",label:"中断"},{value:"PROCESSING",label:"进行中"},{value:"CANCELED",label:"已取消"},{value:"FINISHED",label:"已完成"}],query:{status:"",name:"",mobile:""}}},computed:Object(s["a"])({},Object(o["c"])({})),methods:{handleChangeFirst:function(e){this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},v=g,b=(a("1b58"),Object(d["a"])(v,h,p,!1,null,"ca86d482",null)),y=b.exports,_=a("51fb"),C=a("6424"),x=a("c1ac"),$={components:{EventDialog:f,UserTag:_["a"],headerDetail:y,TagsDrawer:C["a"]},data:function(){return{pageConfig:{total:0,pageNumber:1,pageSize:20},detail:{creator:{name:"",uuid:"",userId:""},startTime:""},query:{mobile:null,name:null,page:null,size:null,status:null,uuid:null}}},created:function(){this.getDetail(),this.query.uuid=this.$route.params.uuid,this.initDataList(this.query)},computed:Object(s["a"])(Object(s["a"])({},Object(o["c"])({userDetail:function(e){return e.userManage.userDetail},loading:function(e){return e.externalUser.loading},batchAddTaskEnum:function(e){return e.enum.batchAddTask},result_list:function(e){return e.externalUser.result_list},result_page:function(e){return e.externalUser.result_page}})),{},{addStatus:function(){return function(e){switch(e){case"NOTSTARTED":return"color-primary";case"INTERRUPT":return"color-danger";case"PROCESSING":return"color - success";case"CANCELED":return"";case"FINISHED":return""}}}}),mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)}))},beforeDestroy:function(){this.$bus.$off("handleRefresh")},methods:{initDataList:function(e){var t=this;console.log(e),this.$store.dispatch("externalUser/getResultList",e).then((function(){t.pageConfig.pageNumber=t.result_page.pageNumber+1,t.pageConfig.total=t.result_page.total})).catch((function(e){console.log(e),t.$message({type:"error",message:"初始化失败"})}))},getDetail:function(){var e=this;Object(x["g"])(this.$route.params.uuid).then((function(t){e.detail=t}))},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.query.uuid=this.$route.params.uuid,this.initDataList(this.query)},handleSearch:function(e){var t=e.name,a=e.mobile,i=e.status;this.query.name=t||t,this.query.mobile=a||a,this.query.status=i||i,console.log(e,"handleSearch"),this.initDataList(this.query)}}},k=$,T=Object(d["a"])(k,i,n,!1,null,null,null);t["default"]=T.exports},ebf0:function(e,t,a){},ecb1:function(e,t,a){"use strict";var i=a("a10e"),n=a.n(i);n.a},ecf3:function(e,t,a){"use strict";var i=a("e0e2"),n=a.n(i);n.a},ecfe:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize,"page-sizes":[10,20,50,100]},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage,"size-change":e.handleSizeChange}})},n=[],s={props:{pageConfig:{type:Object,default:function(){return{}}}},methods:{changePage:function(e){this.$emit("current-change",e)},handleSizeChange:function(e){this.$emit("size-change",e)}}},r=s,l=a("2877"),o=Object(l["a"])(r,i,n,!1,null,null,null);t["a"]=o.exports},ed35:function(e,t,a){},ed55:function(e,t,a){"use strict";var i=a("b8bf"),n=a.n(i);n.a},eda8:function(e,t,a){"use strict";var i=a("ae51"),n=a.n(i);n.a},ee39:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["{}"!=JSON.stringify(e.alterGroups)?a("div",{staticClass:"drawer-container"},[e._l(e.alterGroups,(function(t,i){return a("div",{key:i,staticClass:"drawer-item"},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"font-exs color-info group-name"},[e._v(e._s(i)+"：")])]),e._v(" "),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"tags-container"},e._l(e.alterTags(t),(function(t,i){return a("el-tag",{key:i,staticClass:"tag-unit text-ellipsis",attrs:{type:"info",size:"mini"}},[e._v(e._s(t.tagName))])})),1)])],1)],1)})),e._v(" "),e.total>2?a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.curly=!e.curly}}},[a("span",[e._v(e._s(e.curly?"展开":"收起"))]),e._v(" "),a("i",{class:[e.curly?"el-icon-caret-bottom":"el-icon-caret-top"]})])],1):e._e()],2):a("span",[e._v("--")])])},n=[],s=(a("ac6a"),a("456d"),{props:{tags:{type:Object,default:function(){return{}}}},name:"tags-drawer",data:function(){return{curly:!1}},watch:{tags:{handler:function(e,t){e&&(Object.keys(e).length>2?this.curly=!0:this.curly=!1)},immediate:!0}},computed:{total:function(){return this.tags?Object.keys(this.tags).length:0},alterGroups:function(){var e=this;if(this.tags){var t=Object.keys(this.tags);return this.curly?t.reduce((function(t,a,i){return i<2&&(t[a]=e.tags[a]),t}),{}):t.reduce((function(t,a,i){return t[a]=e.tags[a],t}),{})}}},mounted:function(){},methods:{alterTags:function(e){return this.curly?e.slice(0,1):e}}}),r=s,l=(a("a475"),a("ed55"),a("2877")),o=Object(l["a"])(r,i,n,!1,null,"05f632df",null);t["a"]=o.exports},ee3d:function(e,t,a){"use strict";var i=a("72b3"),n=a.n(i);n.a},ee58:function(e,t,a){},ef7a:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",auth:e.permissionMap["potentialCustomer"]["potentialCustomer_add"],popAuth:!0},on:{click:function(t){return t.stopPropagation(),e.handleCreate(t)}}},[e._v("新增用户")]),e._v(" "),a("el-t-button",{attrs:{auth:e.permissionMap["potentialCustomer"]["potentialCustomer_allocation"]},on:{click:function(t){return t.stopPropagation(),e.handleDistribute(t)}}},[e._v("分配")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"",fit:"","highlight-current-row":"","header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户名",align:"left",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",align:"left",prop:"mobile"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",width:"250"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("tags-drawer",{attrs:{tags:t.potentialCustomerTags}})]}}])},[a("template",{slot:"header"},[a("span",[e._v("\n              预设标签\n              "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",{staticClass:"font-exs color-info"},[e._v("添加成为用户后，将自动打上预设标签。")])]),e._v(" "),a("i",{staticClass:"el-icon-question"})])],1)])],2),e._v(" "),a("el-table-column",{attrs:{label:"批量添加次数",align:"left",prop:"tryCount"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.belong).length?a("div",[a("async-user-tag",{attrs:{uuid:i.belong.uuid,size:"small",type:"info"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(i.belong.name)+"\n              ")])],1):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"添加员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.creator).length?a("div",[a("async-user-tag",{attrs:{uuid:i.creator.uuid,size:"small",type:"info"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(i.creator.name)+"\n              ")])],1):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"入库时间",align:"left",prop:"importTime"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["potentialCustomer"]["potentialCustomer_update"]},on:{click:function(a){return a.stopPropagation(),e.handleAllocation(t.row)}}},[e._v("分配")]),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["potentialCustomer"]["potentialCustomer_update"]},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-t-button",{attrs:{type:"text",popAuth:!0,auth:e.permissionMap["potentialCustomer"]["potentialCustomer_delete"],size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=(a("ac6a"),a("7f7f"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"run-way-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"客户名称："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属员工："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.belongUuid,callback:function(t){e.$set(e.query,"belongUuid",t)},expression:"query.belongUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"添加员工："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.creatorUuid,callback:function(t){e.$set(e.query,"creatorUuid",t)},expression:"query.creatorUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"入库时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"添加次数："}},[a("el-radio-group",{model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:1}},[e._v("全部客户")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("未添加过的客户")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("\n        自定义添加次数的客户\n        "),a("span",{staticStyle:{display:"inline-block",width:"50px",color:"#000"}},[a("el-input",{ref:"minInput",staticClass:"min",attrs:{size:"mini"},on:{input:function(t){return e.inputMin(t)},focus:e.focusInput},model:{value:e.query.min,callback:function(t){e.$set(e.query,"min","string"===typeof t?t.trim():t)},expression:"query.min"}}),e._v(" "),a("span",[e._v("--")]),e._v(" "),a("el-input",{staticClass:"max",attrs:{size:"mini"},on:{focus:e.focusInput,input:function(t){return e.inputMax(t)}},model:{value:e.query.max,callback:function(t){e.$set(e.query,"max","string"===typeof t?t.trim():t)},expression:"query.max"}}),e._v(" "),a("span",[e._v("次")])],1)])],1)],1),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=(a("a481"),a("2f62")),u={data:function(){return{value:[],query:{name:"",belongUuid:"",creatorUuid:"",startTime:"",endTime:"",flag:1,max:null,min:null},timer:null}},watch:{"query.flag":{handler:function(e,t){var a=this;2!=e?(this.query.min="",this.query.max=""):this.$nextTick((function(){a.$refs.minInput.focus()}))},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){this.query.startTime=this.value[0],this.query.endTime=this.value[1]},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSelectedChange:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.value=this.$options.data().value,this.$emit("handleRefresh")},inputMin:function(e){(this.query.min||this.query.max)&&(this.query.flag=2);var t=/[^\d]/g;this.query.min=e.replace(t,""),(""==this.query.min||this.query.min<=0||this.query.min>99)&&(this.$message.warning("输入数字必须在0-100之间"),this.query.min=0)},inputMax:function(e){var t=/[^\d]/g;this.query.max=e.replace(t,""),(""==this.query.max||this.query.max<0||this.query.max>100)&&(this.$message.warning("输入数字必须在0-100之间"),this.query.max=1)},focusInput:function(){this.query.flag=2}}},d=u,m=(a("b2b5"),a("9299"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"0480ebd2",null),h=f.exports,p=a("fba9"),g=a("6424"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},b=[],y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"客户名"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"持有人"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.belongUuid,callback:function(t){e.$set(e.form,"belongUuid",t)},expression:"form.belongUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预设标签"}},[a("label",{staticClass:"tag-label",attrs:{slot:"label"},slot:"label"},[e._v("\n      预设标签\n      "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"添加成为用户后，将自动打上预设标签",placement:"right"}},[a("i",{staticClass:"el-icon-question tip"})])],1)]),e._v(" "),a("div",[a("tags-selected",{attrs:{tagListSelect:e.tagListSelect,checkboxGroup:e.form.tagId},on:{change:e.handleCheckedTagsChange}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},_=[],C=a("fbff"),x=a("61f7"),$={inject:["reload"],components:{TagsSelected:C["a"]},data:function(){var e=function(e,t,a){!t||Object(x["b"])(t)?a():a(new Error("手机格式不正确"))};return{hasParent:!1,form:{belongUuid:"",mobile:"",name:"",tagId:[]},rules:{mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:e,trigger:["blur","change"]}]},result:[]}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(c["b"])(["uuid"])),Object(c["c"])({userListAll:function(e){return e.user.listSelect},tagListSelect:function(e){return e.tag.tagListSelect}})),created:function(){this.initFilter()},mounted:function(){this.form.belongUuid=this.uuid},methods:{initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleCheckedTagsChange:function(e,t){this.checkboxGroup=e},handleConfirm:function(){var e=this;this.form.tagId=this.checkboxGroup,this.$refs["form"].validate((function(t){t?e.$store.dispatch("potentialCustomer/batchAdd",e.form).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){console.error(t),e.$message({type:"error",message:"操作失败"})})):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("potentialCustomer/getList").then((function(){})).catch((function(t){e.$message({type:"error",message:t})}))}}},k=$,T=(a("e6c0"),Object(m["a"])(k,y,_,!1,null,"40ffa927",null)),w=T.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"客户名"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预设标签"}},[a("label",{staticClass:"tag-label",attrs:{slot:"label"},slot:"label"},[e._v("\n      预设标签\n      "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"添加成为用户后，将自动打上预设标签",placement:"right"}},[a("i",{staticClass:"el-icon-question tip"})])],1)]),e._v(" "),a("div",[a("tags-selected",{attrs:{tagListSelect:e.tagListSelect,checkboxGroup:e.form.tagId,packUp:!0,isShow:!0},on:{change:e.handleCheckedTagsChange}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},D=[],E={inject:["reload"],props:{transfer:{type:Object,default:function(){}}},components:{TagsSelected:C["a"]},data:function(){return{checkboxGroup:[],hasParent:!1,changeTag:!1,form:{mobile:"",name:"",tagId:[],belongUuid:"",uuid:""},rules:{name:[{required:!0,message:"请输入客户名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{transfer:{handler:function(e,t){var a=this;console.log(e,"newVal");var i=e.belong,n=e.uuid,s=e.selectedTag,r=e.mobile,l=e.name;this.form.name=l,this.form.belongUuid=i.uuid,this.form.uuid=n,this.form.mobile=r,s.length>0&&s.map((function(e){a.form.tagId.push(e)}))},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({tagListSelect:function(e){return e.tag.tagListSelect}})),mounted:function(){},methods:{handleCheckedTagsChange:function(e,t){this.changeTag=!0,this.checkboxGroup=e},handleConfirm:function(){var e=this;this.changeTag&&(this.form.tagId=this.checkboxGroup),this.$store.dispatch("potentialCustomer/potentialCustomerUpdate",this.form).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("potentialCustomer/getListMy").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},L=E,A=Object(m["a"])(L,S,D,!1,null,null,null),U=A.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-select",{staticStyle:{width:"100%","margin-bottom":"20px"},model:{value:e.form.userUuid,callback:function(t){e.$set(e.form,"userUuid",t)},expression:"form.userUuid"}},e._l(e.userListSelect,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},O=[],I=a("8cbb"),j={props:{transfer:{type:Object,default:function(){}}},components:{ComplexSelect:I["a"]},data:function(){return{selects:[],form:{userUuid:"",uuid:[]}}},watch:{transfer:{handler:function(e,t){console.log(e,"8888");var a=e.uuid;this.form.uuid=a},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({departmentList:function(e){return e.department.departmentList},userListSelect:function(e){return e.user.listSelect}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){var e=this,t=this.form;this.$store.dispatch("potentialCustomer/allocation",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.closeDialog(),e.handleRefresh()})).catch((function(t){e.$message({type:"error",message:t})}))},code:function(e){1==e?this.$message({type:"error",message:"分配失败"}):(this.$message({type:"success",message:"操作成功"}),this.handleRefresh()),this.closeDialog()},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},R=j,N=Object(m["a"])(R,q,O,!1,null,null,null),M=N.exports,z={components:{CreateTemplate:w,EditTemplate:U,DistributeTemplate:M},data:function(){return{dialogVisible:!1,event:"DistributeTemplate",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配客户"},close:function(){this.event=""}}},P=z,F=Object(m["a"])(P,v,b,!1,null,null,null),V=F.exports,B=a("8690"),G=a("ecfe"),W={components:{ListHeader:h,FormDialog:V,ToolBar:B["a"],TagsDrawer:g["a"],AsyncUserTag:p["a"],CustomerPagination:G["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,name:"",belongUuid:"",creatorUuid:"",startTime:"",endTime:"",flag:"",min:"",max:""},selects:[]}},watch:{},computed:Object(r["a"])({},Object(c["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.potentialCustomer.loading},listAll:function(e){return e.potentialCustomer.listAll},page:function(e){return e.potentialCustomer.listAllPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("potentialCustomer/getList",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t;e.max<e.min&&(t=e.max,e.max=e.min,e.min=t);var a=e.belongUuid,i=e.creatorUuid,n=e.endTime,s=(e.flag,e.max),r=e.min,l=e.name,o=e.startTime;2==e.flag?(this.query.flag=!0,this.query.min=r,this.query.max=s):1==e.flag?(this.query.flag="",this.query.min="",this.query.max=""):(this.query.flag=!1,this.query.min=0,this.query.max=0),this.query.name=l||"",this.query.belongUuid=a||"",this.query.creatorUuid=i||"",this.query.endTime=n||"",this.query.startTime=o||"",this.query.page=0,this.initDataList(this.query)},sortNumber:function(e,t){return e-t},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleCreate:function(){this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].dialogVisible=!0},handleDistribute:function(){var e=this.selects.map((function(e){return e.uuid})),t={uuid:e};this.selects.length?(this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=t):this.$message({type:"warning",message:"请至少选择一个客户"})},handleAllocation:function(e){var t=this;e.uuid=[e.uuid],this.$refs.multipleTable.clearSelection(),this.handleSelectionChange([e]),this.selects.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)})),this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=e},handleEdit:function(e){var t=e.belong,a=e.uuid,i=e.mobile,n=e.name,s=[];e.potentialCustomerTags.map((function(e){e.tags.map((function(e){s.push(e.tagId)}))}));var r={belong:t,uuid:a,selectedTag:s,mobile:i,name:n};this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=r},handleDelete:function(e){var t=this,a=e.uuid,i={uuid:[a]};this.$confirm("是否删除当前客户","删除潜在客户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("potentialCustomer/deletePotentialCustomer",i).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleSelectionChange:function(e){this.selects=e},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},H=W,J=(a("4a37"),a("ffe9"),Object(m["a"])(H,i,n,!1,null,"026aa9f1",null));t["default"]=J.exports},efbd:function(e,t,a){"use strict";var i=a("45d8"),n=a.n(i);n.a},efe7:function(e,t,a){},f04c:function(e,t,a){},f061:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasExport:!1}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",auth:e.permissionMap["role"]["role_update"],popAuth:!0},on:{click:function(t){return t.stopPropagation(),e.handleConfirm(t)}}},[e._v(e._s(e.permissionMap["role"]["role_update"].needAudit?"提交审核":"完成"))])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[Object.keys(e.isIndeterminate).length?a("el-form",e._l(e.permissionRenderMap,(function(t,i){return a("el-form-item",{key:i,attrs:{label:e.roleDetail[i]}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate[i]},on:{change:function(t){return e.handleCheckAllChange(i)}},model:{value:e.checkAll[i],callback:function(t){e.$set(e.checkAll,i,t)},expression:"checkAll[key]"}},[e._v("全选")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:function(t){return e.handleSingleChange(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[key]"}},e._l(e.list[i],(function(t){return a("el-checkbox",{key:t.code,attrs:{label:t.uuid}},[e._v(e._s(t.title))])})),1),e._v(" "),a("el-divider")],1)})),1):e._e()],1)],1)])},n=[],s=(a("8615"),a("ac6a"),a("5530")),r=a("2f62"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},o=[],c={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")}}},u=c,d=(a("72a0"),a("2877")),m=Object(d["a"])(u,l,o,!1,null,"7541f0ba",null),f=m.exports,h={name:"role-detail",components:{ToolBar:f},data:function(){return{checkAll:{},checked:{},isIndeterminate:{},list:{},form:{roleUuid:null,permissionUuids:[]}}},computed:Object(s["a"])({},Object(r["c"])({permissionRenderMap:function(e){return e.permission.permissionRenderMap},permissionMap:function(e){return e.permission.permissionMap},roleDetail:function(e){return e.enum.roleDetail}})),created:function(){var e=this,t=this.$route.query.code;this.form.roleUuid=+this.$route.params.uuid,this.initData().then((function(){e.initDetail({roleCode:t})}))},mounted:function(){},methods:{initDetail:function(e){var t=this;this.$store.dispatch("permission/getRoleTemplatePermissionList",e).then((function(e){var a=function(a){e[a].forEach((function(e){t.checked[a].push(e.uuid)})),e[a].length==t.list[a].length&&(t.checkAll[a]=!0)};for(var i in e)a(i)})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},initData:function(){var e=this;return new Promise((function(t,a){e.$store.dispatch("permission/getListAll").then((function(a){for(var i in a)e.$set(e.checkAll,i,!1),e.$set(e.isIndeterminate,i,!1),e.$set(e.checked,i,[]),e.$set(e.list,i,a[i]);t(a)})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"}),a(t)}))}))},handleCheckAllChange:function(e){var t=this;0==this.checkAll[e]?(this.checkAll[e]=!1,this.checked[e]=[]):1==this.checkAll[e]&&(this.checkAll[e]=!0,this.checked[e]=[],this.list[e].map((function(a){t.checked[e].push(a.uuid)}))),this.isIndeterminate[e]=!1},handleSingleChange:function(e){var t=this.checked[e].length;this.checkAll[e]=t===this.list[e].length,this.isIndeterminate[e]=t>0&&t<this.list[e].length},doExport:function(){},handleConfirm:function(){var e=this,t=Object.values(this.checked).reduce((function(e,t){return e.concat(t)}),[]);this.form.permissionUuids=t,this.$store.dispatch("roleTemplate/roleLinkPermission",this.form).then((function(t){e.$message({type:"success",message:"操作成功"});var a=e.$route.query.code;e.initDetail({roleCode:a})})).catch((function(t){e.$message({type:"error",message:t||"操作失败"})}))}}},p=h,g=Object(d["a"])(p,i,n,!1,null,null,null);t["default"]=g.exports},f0ec:function(e,t,a){},f1b6:function(e,t,a){},f2ff:function(e,t,a){},f345:function(e,t,a){},f37f:function(e,t,a){"use strict";var i=a("b8b5"),n=a.n(i);n.a},f38f:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",{staticClass:"mb-10"},[a("div",{staticClass:"flex-alinecenter"},[a("span",{staticClass:"font-es mr-15"},[e._v("自动回复开关")]),e._v(" "),a("el-switch",{on:{change:e.handleClickReplySwitch},model:{value:e.isReplySwitch,callback:function(t){e.isReplySwitch=t},expression:"isReplySwitch"}}),e._v(" "),a("span",{staticClass:"ml-20 mr-10 font-es"},[e._v("自动回复是针对客户的常见问题而设置的标准回复内容,可快速响应客户的问题。管理员可统一添加关键词和自动回复的消息")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.handleClickSetAutoReplay(t)}}},[e._v("设置")])],1)]),e._v(" "),a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"条记录",hasRefresh:!0},on:{handleExport:e.doExport,handleRefresh:e.handleRefresh}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["riskManagement"]["riskManagement_add"]},on:{click:function(t){return t.stopPropagation(),e.handleCreate(t)}}},[e._v("新建回复")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"规则名称",align:"left",prop:"ruleWord"}}),e._v(" "),a("el-table-column",{attrs:{label:"关键词",align:"left",prop:"keyWord"}}),e._v(" "),a("el-table-column",{attrs:{label:"回复内容",align:"left",prop:"replyWord"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",["CONTENT"!=i.autoReplyType?a("span",[e._v(e._s(e.autoReplyContentType[i.autoReplyType]))]):e._e(),e._v(" "),a("p",[e._v(e._s(i.replyWord))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"企业标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.autoReplyTags.length>0?a("div",[a("strong",[e._v(e._s("CONTAIN"==i.autoReplyTagType?"包含其一":"完全匹配"))]),e._v(" "),i.autoReplyTags.length>0?a("tags-drawer",{attrs:{tags:i.autoReplyTags}}):e._e()],1):a("span",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.creator).length?a("div",e._l([i.creator],(function(t){return a("async-user-tag",{key:t.uuid,attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(t.name)+"\n              ")])})),1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",popAuth:!0,size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-t-button",{attrs:{type:"text",popAuth:!0,size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("96cf"),a("1da1")),r=a("5530"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"external-user-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"规则名称："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入规则名称"},model:{value:e.query.ruleName,callback:function(t){e.$set(e.query,"ruleName","string"===typeof t?t.trim():t)},expression:"query.ruleName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"关键词："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入关键词"},model:{value:e.query.keyWord,callback:function(t){e.$set(e.query,"keyWord","string"===typeof t?t.trim():t)},expression:"query.keyWord"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"回复内容："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入回复内容"},model:{value:e.query.replyWord,callback:function(t){e.$set(e.query,"replyWord","string"===typeof t?t.trim():t)},expression:"query.replyWord"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户标签："}},[a("div",{staticClass:"tag-border"},[a("el-select",{attrs:{size:"mini",multiple:""},on:{change:e.handleChangeSecond},model:{value:e.query.tagIds,callback:function(t){e.$set(e.query,"tagIds",t)},expression:"query.tagIds"}},e._l(e.tagListAll,(function(t,i){return a("el-option-group",{key:i,attrs:{label:t.groupName}},e._l(t.tagList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.tagName,value:e.uuid}})})),1)})),1),e._v(" "),a("span",{staticClass:"tag-warp"},[a("el-radio-group",{model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:!0}},[e._v("包含任一")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("完全匹配")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            包含任一：有任意一个选择的标签的用户;\n            "),a("br"),e._v("完全匹配：必须拥有全部选择的标签的用户。\n          ")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"创建时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{value:[],contractWay:[{type:"员工主动添加",id:"1"},{type:"员工被动添加",id:"2"},{type:"二维码扫码添加",id:"3"}],query:{ruleName:"",keyWord:"",replyWord:"",tagIds:[],flag:!0,startTime:"",endTime:""},timer:null}},computed:Object(r["a"])({},Object(c["c"])({tagListAll:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){console.log(e),this.query.startTime=this.value[0],this.query.endTime=this.value[1]},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query},handleClearable:function(e){this.query[e]=""}}},d=u,m=(a("f4b4"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"7de0e177",null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"700px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[a("div",[a(e.event,{tag:"component",attrs:{transfer:e.transfer}})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"规则名称",prop:"rule",maxlength:"15","show-word-limit":""}},[a("el-input",{attrs:{placeholder:"请输入规则名称"},model:{value:e.form.rule,callback:function(t){e.$set(e.form,"rule","string"===typeof t?t.trim():t)},expression:"form.rule"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"关键词",prop:"keyWord"}},[a("el-input",{model:{value:e.form.keyword,callback:function(t){e.$set(e.form,"keyword","string"===typeof t?t.trim():t)},expression:"form.keyword"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.form.keyType,callback:function(t){e.$set(e.form,"keyType",t)},expression:"form.keyType"}},[a("el-option",{attrs:{label:"包含",value:"CONTAIN"}}),e._v(" "),a("el-option",{attrs:{label:"完全匹配",value:"COMPLETE"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文字消息"}},[a("div",{staticClass:"full-w"},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入文字消息"},model:{value:e.form.reply,callback:function(t){e.$set(e.form,"reply",t)},expression:"form.reply"}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"图片/文章/链接"}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"message-box-content"},[a("el-radio-group",{model:{value:e.form.autoReplyType,callback:function(t){e.$set(e.form,"autoReplyType",t)},expression:"form.autoReplyType"}},[a("el-radio",{attrs:{label:"IMAGE"}},[e._v("图片")]),e._v(" "),a("el-radio",{attrs:{label:"FILE"}},[e._v("文件")]),e._v(" "),a("el-radio",{attrs:{label:"ARTICLE"}},[e._v("文章")])],1),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"IMAGE"==e.form.autoReplyType,expression:"form.autoReplyType == 'IMAGE'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleSetMessageImage,"before-upload":e.beforeUploadImage}},[e.messageImage?a("el-image",{staticClass:"avatar",attrs:{fit:"contain",src:e.messageImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),e._v(" "),e.messageImage?a("i",{staticClass:"el-icon-circle-close close",on:{click:function(t){return t.stopPropagation(),e.handleDelMessageImage(t)}}}):e._e()],1)]),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"FILE"==e.form.autoReplyType,expression:"form.autoReplyType == 'FILE'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{attrs:{action:"/api/upload","on-success":e.handleSetMessageFile,"before-upload":e.beforeUploadFile,"before-remove":e.beforeRemoveFile,"on-remove":e.removeFile,multiple:"","show-file-list":!0,"file-list":e.fileList}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.messageFile,expression:"!messageFile"}],attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"ARTICLE"==e.form.autoReplyType,expression:"form.autoReplyType == 'ARTICLE'"}],staticClass:"message-content"},[a("el-select",{staticClass:"label-warp",staticStyle:{width:"100%"},attrs:{"popper-append-to-body":!1,clearable:"",placeholder:"请选择","popper-class":"selectinfo"},on:{change:e.handleChoseLink,clear:e.handleClear},model:{value:e.form.mediaId,callback:function(t){e.$set(e.form,"mediaId",t)},expression:"form.mediaId"}},[e.form.mediaId?a("div",{staticClass:"display-flex align-items-center label-input",attrs:{slot:"prefix"},slot:"prefix"},[a("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:"/api/public/file/"+e.welcomecontentT.imgId,alt:""}}),e._v(" "),a("div",{staticClass:"input-title"},[a("span",[e._v(e._s(e.welcomecontentT.title))]),e._v(" "),a("div",{staticClass:"input-content text-over"},[e._v(e._s(e.welcomecontentT.description))])])]):e._e(),e._v(" "),e._l(e.articleListSelect,(function(t,i){return a("el-option",{key:i,attrs:{label:t.title,value:t.uuid}},[a("div",{staticClass:"option-warp flex-between-alinecenter"},[a("div",{staticClass:"link-img"},[a("img",{staticClass:"option-img",attrs:{src:"/api/public/file/"+t.imgId}})]),e._v(" "),a("div",{staticClass:"option-content flex-1"},[a("p",[e._v(e._s(t.title))]),e._v(" "),a("p",[e._v(e._s(t.description))])])])])}))],2)],1)],1)])]),e._v(" "),a("el-form-item",{attrs:{label:"配置标签"}},[a("el-radio-group",{model:{value:e.form.autoReplyTagType,callback:function(t){e.$set(e.form,"autoReplyTagType",t)},expression:"form.autoReplyTagType"}},[a("el-radio",{attrs:{label:"CONTAIN"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"COMPLETE"}},[e._v("完全匹配")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:" "}},[a("tag-multi-select",{on:{"select-change":e.handleChange},model:{value:e.form.tagIdList,callback:function(t){e.$set(e.form,"tagIdList",t)},expression:"form.tagIdList"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},b=[],y=(a("7514"),a("7f7f"),a("8cbb")),_=a("fba9"),C=a("12e3"),x=a("f6e6"),$={inject:["reload"],components:{AsyncUserTag:_["a"],ComplexSelect:y["a"],inputEdit:C["a"],TagMultiSelect:x["a"]},data:function(){return{fileList:[],type:"",form:{autoReplyTagType:"CONTAIN",autoReplyType:"CONTENT",fileName:"",keyType:"CONTAIN",keyword:"",mediaId:"",reply:"",rule:"",tagIdList:[0]},insertName:!0,messageImage:"",messageVideo:"",messageFile:"",mediaId:"",welcomecontentT:{},memberNick:"客户昵称",rules:{rule:[{required:!0,message:"请输入规则名称",trigger:"blur"}],keyword:[{required:!0,message:"请输入关键词",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]},selectTags:[]}},watch:{},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({articleListSelect:function(e){return e.media.articleListSelect}})),{},{toUser:function(){return this.form.toUser}}),mounted:function(){this.initFilter()},methods:{initFilter:function(){var e=this;this.$store.dispatch("media/getArticleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleConfirm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){"FILE"!=e.form.autoReplyType&&(e.form.fileName="");var a=e.form;e.$store.dispatch("automatic/add",a).then((function(){e.$message({type:"success",message:"新建成功"}),e.handleCancel(),e.initDataList()})).catch((function(t){e.$message({type:"error",message:t||"新建失败"})}))}else e.$message({type:"error",message:"请检查输入"})}))},insertionMemberName:function(e){this.insertName=!1,this.form.reply=this.form.reply+'<span class="nickName">'.concat(e,"</span>&#8203;")},handleSetMessageImage:function(e,t){this.messageImage=URL.createObjectURL(t.raw),this.form.mediaId=e.id},handleSetMessageFile:function(e,t){this.messageFile=URL.createObjectURL(t.raw),this.form.mediaId=e.id,this.form.fileName=e.name},beforeUploadImage:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},beforeUploadFile:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("上传视频大小不能超过 50MB!"),t},beforeRemoveFile:function(e){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleClear:function(){this.form.mediaId="",this.welcomecontentT={}},removeFile:function(e){this.messageFile="",this.form.mediaId=null},handleDelMessageImage:function(){this.messageImage="",this.form.mediaId=null},handleDelMessageVideo:function(){this.messageVideo="",this.form.mediaId=null},handleDelMessageFile:function(){this.messageFile="",this.form.mediaId=null},handleChoseLink:function(e){this.welcomecontentT=this.articleListSelect.find((function(t){return t.uuid===e})),this.welcomecontentT&&this.welcomecontentT.uuid&&(this.form.mediaId=this.welcomecontentT.uuid)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleChange:function(){},initDataList:function(){var e=this;this.$store.dispatch("automatic/getListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))}}},k=$,T=(a("71d5"),a("39b1"),Object(m["a"])(k,v,b,!1,null,"8e2c7018",null)),w=T.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"默认回复"}},[a("span",{staticClass:"color-primary mr-10 set-auto-replay",on:{click:e.setAutoRepaly}},[e._v("配置")]),e._v(" "),a("span",[e._v("当未匹配到关键词，小助理将发送次条消息内容")])]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.isSetAuto,expression:"isSetAuto == true"}],attrs:{label:"文字消息"}},[a("div",{staticClass:"full-w"},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入文字消息"},model:{value:e.form.reply,callback:function(t){e.$set(e.form,"reply",t)},expression:"form.reply"}})],1)]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.isSetAuto,expression:"isSetAuto == true"}],attrs:{label:"图片/文章/链接"}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"message-box-content"},[a("el-radio-group",{on:{change:e.changeAutoReplyType},model:{value:e.form.autoReplyType,callback:function(t){e.$set(e.form,"autoReplyType",t)},expression:"form.autoReplyType"}},[a("el-radio",{attrs:{label:"CONTENT"}},[e._v("文本")]),e._v(" "),a("el-radio",{attrs:{label:"IMAGE"}},[e._v("图片")]),e._v(" "),a("el-radio",{attrs:{label:"FILE"}},[e._v("文件")]),e._v(" "),a("el-radio",{attrs:{label:"ARTICLE"}},[e._v("文章")])],1),e._v(" "),"IMAGE"==e.form.autoReplyType?a("section",{staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleSetMessageImage,"before-upload":e.beforeUploadImage}},[e.messageImage?a("el-image",{staticClass:"avatar",attrs:{fit:"contain",src:e.messageImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),e._v(" "),e.messageImage?a("i",{staticClass:"el-icon-circle-close close",on:{click:function(t){return t.stopPropagation(),e.handleDelMessageImage(t)}}}):e._e()],1)]):e._e(),e._v(" "),"FILE"==e.form.autoReplyType?a("section",{staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{attrs:{action:"/api/upload","on-success":e.handleSetMessageFile,"before-upload":e.beforeUploadFile,"before-remove":e.beforeRemoveFile,"on-remove":e.removeFile,multiple:"","show-file-list":!0,"file-list":e.fileList}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.fileList.length<=0,expression:"fileList.length<=0"}],attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)]):e._e(),e._v(" "),"ARTICLE"==e.form.autoReplyType?a("div",{staticClass:"message-content"},[a("el-select",{staticClass:"label-warp",staticStyle:{width:"100%"},attrs:{"popper-append-to-body":!1,clearable:"",placeholder:"请选择","popper-class":"selectinfo"},on:{change:e.handleChoseLink,clear:e.handleClear},model:{value:e.form.mediaId,callback:function(t){e.$set(e.form,"mediaId",t)},expression:"form.mediaId"}},[e.form.mediaId?a("div",{staticClass:"display-flex align-items-center label-input",attrs:{slot:"prefix"},slot:"prefix"},[a("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:"/api/public/file/"+e.welcomecontentT.imgId,alt:""}}),e._v(" "),a("div",{staticClass:"input-title"},[a("span",[e._v(e._s(e.welcomecontentT.title))]),e._v(" "),a("div",{staticClass:"input-content text-over"},[e._v(e._s(e.welcomecontentT.description))])])]):e._e(),e._v(" "),e._l(e.articleListSelect,(function(t,i){return a("el-option",{key:i,attrs:{label:t.title,value:t.uuid}},[a("div",{staticClass:"option-warp flex-between-alinecenter"},[a("div",{staticClass:"link-img"},[a("img",{staticClass:"option-img",attrs:{src:"/api/public/file/"+t.imgId}})]),e._v(" "),a("div",{staticClass:"option-content flex-1"},[a("p",[e._v(e._s(t.title))]),e._v(" "),a("p",[e._v(e._s(t.description))])])])])}))],2)],1):e._e()],1)])]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.isSetAuto,expression:"isSetAuto == false"}],attrs:{label:"重复回复"}},[a("div",{staticClass:"flex-alinecenter"},[a("span",{staticClass:"font-es mr-15"},[e._v(e._s(e.repeat?"开启":"关闭"))]),e._v(" "),a("el-switch",{on:{change:e.handleChangeRepeatTime},model:{value:e.repeat,callback:function(t){e.repeat=t},expression:"repeat"}})],1)]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==e.isSetAuto,expression:"isSetAuto == false"}]},[a("div",{staticClass:"flex-alinecenter"},[a("span",{staticClass:"mr-10"},[e._v("同一内容在")]),e._v(" "),a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",disabled:!e.repeat},on:{change:e.handleChangeRepeatTime},model:{value:e.repeatTime,callback:function(t){e.repeatTime=t},expression:"repeatTime"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),a("span",{staticClass:"ml-10"},[e._v("内对同一客户不再重复回复")])],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.isSetAuto,expression:"isSetAuto == true"}],staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},D=[],E=(a("c5f6"),a("14b9"),{inject:["reload"],components:{AsyncUserTag:_["a"],ComplexSelect:y["a"],inputEdit:C["a"],TagMultiSelect:x["a"]},data:function(){return{repeat:!1,isSetAuto:!1,value1:!1,repeatTime:"30",options:[{value:"30",label:"30分钟"},{value:"60",label:"60分钟"},{value:"90",label:"90分钟"},{value:"120",label:"2小时"},{value:"180",label:"3小时"},{value:"240",label:"4小时"},{value:"300",label:"5小时"},{value:"360",label:"6小时"}],form:{autoReplyType:"CONTENT",mediaId:"",reply:"",fileName:""},fileList:[],messageImage:"",messageVideo:"",messageFile:"",welcomecontentT:{},rules:{rule:[{required:!0,message:"请输入规则名称",trigger:"blur"}],keyword:[{required:!0,message:"请输入关键词",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]},selectTags:[]}},watch:{},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({articleListSelect:function(e){return e.media.articleListSelect},automaticDefaultDetail:function(e){return e.automatic.automaticDefaultDetail}})),{},{toUser:function(){return this.form.toUser}}),mounted:function(){this.initData(),this.initFilter()},methods:{initData:function(){this.$store.dispatch("automatic/automaticDefaultDetail").then((function(){})).catch((function(e){}))},initFilter:function(){var e=this;this.$store.dispatch("media/getArticleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleConfirm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){"FILE"!=e.form.autoReplyType&&(e.form.fileName="");var a=e.form;e.$store.dispatch("automatic/automaticAddDefault",a).then((function(){e.$message({type:"success",message:"新建成功"}),e.isSetAuto=!1,e.initData()})).catch((function(t){e.$message({type:"error",message:t||"新建失败"})}))}else e.$message({type:"error",message:"请检查输入"})}))},changeAutoReplyType:function(e){this.form.mediaId=""},handleChangeRepeatTime:function(e){var t=this,a={flag:this.repeat,interval:this.repeatTime};this.$store.dispatch("automatic/automaticSwitchReplyInterval",a).then((function(){t.$message({type:"success",message:"修改成功"})})).catch((function(e){console.log(e)}))},setAutoRepaly:function(){var e=this;this.isSetAuto=!0,this.$nextTick((function(){"FILE"==e.automaticDefaultDetail.autoReplyType&&(e.fileList=[],e.automaticDefaultDetail.mediaUrl&&e.fileList.push({name:e.automaticDefaultDetail.fileName,url:e.automaticDefaultDetail.mediaUrl})),"IMAGE"==e.automaticDefaultDetail.autoReplyType&&(e.messageImage=e.automaticDefaultDetail.mediaUrl),"ARTICLE"==e.automaticDefaultDetail.autoReplyType?(e.form.mediaId=Number(e.automaticDefaultDetail.mediaId),e.handleChoseLink(e.form.mediaId)):e.form.mediaId=e.automaticDefaultDetail.mediaId,e.form.autoReplyType=e.automaticDefaultDetail.autoReplyType?e.automaticDefaultDetail.autoReplyType:"CONTENT",e.form.reply=e.automaticDefaultDetail.replyWord}))},handleSetMessageImage:function(e,t){this.messageImage=URL.createObjectURL(t.raw),this.form.mediaId=e.id},handleSetMessageFile:function(e,t){console.log(t),this.messageFile=URL.createObjectURL(t.raw),this.form.mediaId=e.id,this.form.fileName=e.name},beforeUploadImage:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},beforeUploadFile:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("上传视频大小不能超过 50MB!"),t},beforeRemoveFile:function(e){return this.messageFile="",this.$confirm("确定移除 ".concat(e.name,"？"))},handleClear:function(){this.form.mediaId="",this.welcomecontentT={}},removeFile:function(e){this.messageFile="",this.form.mediaId=null},handleDelMessageImage:function(){this.messageImage="",this.form.mediaId=null},handleDelMessageVideo:function(){this.messageVideo="",this.form.mediaId=null},handleDelMessageFile:function(){this.messageFile="",this.form.mediaId=null},handleChoseLink:function(e){this.welcomecontentT=this.articleListSelect.find((function(t){return t.uuid===e})),this.welcomecontentT&&this.welcomecontentT.uuid&&(this.form.mediaId=this.welcomecontentT.uuid)},handleCancel:function(){this.isSetAuto=!1},handleChange:function(){},refresh:function(){var e=this;this.$store.dispatch("sensitive/getSensitiveListAll").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),L=E,A=(a("bdbf"),a("a308"),Object(m["a"])(L,S,D,!1,null,"ea87fac8",null)),U=A.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"规则名称",prop:"rule",maxlength:"15","show-word-limit":""}},[a("el-input",{attrs:{placeholder:"请输入规则名称"},model:{value:e.form.rule,callback:function(t){e.$set(e.form,"rule","string"===typeof t?t.trim():t)},expression:"form.rule"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"关键词",prop:"keyWord"}},[a("el-input",{model:{value:e.form.keyword,callback:function(t){e.$set(e.form,"keyword","string"===typeof t?t.trim():t)},expression:"form.keyword"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.form.keyType,callback:function(t){e.$set(e.form,"keyType",t)},expression:"form.keyType"}},[a("el-option",{attrs:{label:"包含",value:"CONTAIN"}}),e._v(" "),a("el-option",{attrs:{label:"完全匹配",value:"COMPLETE"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文字消息"}},[a("div",{staticClass:"full-w"},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入文字消息"},model:{value:e.form.reply,callback:function(t){e.$set(e.form,"reply",t)},expression:"form.reply"}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"图片/文章/链接"}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"message-box-content"},[a("el-radio-group",{on:{change:e.changeAutoReplyType},model:{value:e.form.autoReplyType,callback:function(t){e.$set(e.form,"autoReplyType",t)},expression:"form.autoReplyType"}},[a("el-radio",{attrs:{label:"IMAGE"}},[e._v("图片")]),e._v(" "),a("el-radio",{attrs:{label:"FILE"}},[e._v("文件")]),e._v(" "),a("el-radio",{attrs:{label:"ARTICLE"}},[e._v("文章")])],1),e._v(" "),"IMAGE"==e.form.autoReplyType?a("section",{staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleSetMessageImage,"before-upload":e.beforeUploadImage}},[e.messageImage?a("el-image",{staticClass:"avatar",attrs:{fit:"contain",src:e.messageImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),e._v(" "),e.messageImage?a("i",{staticClass:"el-icon-circle-close close",on:{click:function(t){return t.stopPropagation(),e.handleDelMessageImage(t)}}}):e._e()],1)]):e._e(),e._v(" "),"FILE"==e.form.autoReplyType?a("section",{staticClass:"message-content display-flex"},[a("el-upload",{attrs:{action:"/api/upload","on-success":e.handleSetMessageFile,"on-remove":e.handleRemove,"before-upload":e.beforeUploadFile,"before-remove":e.beforeRemoveFile,multiple:"",limit:1,"show-file-list":!0,"file-list":e.fileList}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.fileList.length<=0,expression:"fileList.length<=0"}],attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1):e._e(),e._v(" "),"ARTICLE"==e.form.autoReplyType?a("div",{staticClass:"message-content"},[a("el-select",{staticClass:"label-warp",staticStyle:{width:"100%"},attrs:{"popper-append-to-body":!1,clearable:"",placeholder:"请选择","popper-class":"selectinfo"},on:{change:e.handleChoseLink,clear:e.handleClear},model:{value:e.form.mediaId,callback:function(t){e.$set(e.form,"mediaId",t)},expression:"form.mediaId"}},[e.form.mediaId&&e.welcomecontentT.imgId?a("div",{staticClass:"display-flex align-items-center label-input",attrs:{slot:"prefix"},slot:"prefix"},[a("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:"/api/public/file/"+e.welcomecontentT.imgId,alt:""}}),e._v(" "),a("div",{staticClass:"input-title"},[a("span",[e._v(e._s(e.welcomecontentT.title))]),e._v(" "),a("div",{staticClass:"input-content text-over"},[e._v(e._s(e.welcomecontentT.description))])])]):e._e(),e._v(" "),e._l(e.articleListSelect,(function(t,i){return a("el-option",{key:i,attrs:{label:t.title,value:t.uuid}},[a("div",{staticClass:"option-warp flex-between-alinecenter"},[a("div",{staticClass:"link-img"},[a("img",{staticClass:"option-img",attrs:{src:"/api/public/file/"+t.imgId}})]),e._v(" "),a("div",{staticClass:"option-content flex-1"},[a("p",[e._v(e._s(t.title))]),e._v(" "),a("p",[e._v(e._s(t.description))])])])])}))],2)],1):e._e()],1)])]),e._v(" "),a("el-form-item",{attrs:{label:"配置标签"}},[a("el-radio-group",{model:{value:e.form.autoReplyTagType,callback:function(t){e.$set(e.form,"autoReplyTagType",t)},expression:"form.autoReplyTagType"}},[a("el-radio",{attrs:{label:"CONTAIN"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"COMPLETE"}},[e._v("完全匹配")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:" "}},[a("tag-multi-select",{on:{"select-change":e.handleChange},model:{value:e.form.tagIdList,callback:function(t){e.$set(e.form,"tagIdList",t)},expression:"form.tagIdList"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},O=[],I=(a("ac6a"),a("8615"),{inject:["reload"],components:{AsyncUserTag:_["a"],ComplexSelect:y["a"],inputEdit:C["a"],TagMultiSelect:x["a"]},props:{transfer:{type:Object,default:function(){}}},data:function(){return{fileList:[],form:{autoReplyTagType:"CONTAIN",autoReplyType:"CONTENT",keyType:"CONTAIN",fileName:"",keyword:"",mediaId:"",reply:"",rule:"",tagIdList:[],uuid:""},insertName:!0,messageImage:"",messageVideo:"",messageFile:"",welcomecontentT:{},memberNick:"客户昵称",rules:{rule:[{required:!0,message:"请输入规则名称",trigger:"blur"}],keyword:[{required:!0,message:"请输入关键词",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]},selectTags:[]}},watch:{transfer:{handler:function(e,t){console.log(e,"3333"),this.form.autoReplyTagType=e.autoReplyTagType,this.form.autoReplyType=e.autoReplyType,this.form.keyType=e.keyType,this.form.fileName=e.fileName,this.form.keyword=e.keyWord,this.form.reply=e.replyWord,this.form.rule=e.ruleWord,this.form.uuid=e.uuid;var a=[];"IMAGE"==e.autoReplyType&&(this.messageImage=e.mediaUrl),"FILE"==e.autoReplyType&&(this.fileList=[],e.mediaUrl&&this.fileList.push({name:e.fileName,url:e.mediaUrl})),"ARTICLE"==e.autoReplyType?(this.form.mediaId=Number(e.mediaId),this.handleChoseLink(this.form.mediaId)):this.form.mediaId=e.mediaId,"{}"!=JSON.stringify(e.autoReplyTags)&&Object.values(e.autoReplyTags).length>0&&e.autoReplyTags.map((function(e){e.tags.map((function(e){a.push(e.uuid)}))})),this.form.tagIdList=a}}},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({articleListSelect:function(e){return e.media.articleListSelect}})),{},{toUser:function(){return this.form.toUser}}),mounted:function(){this.initFilter()},methods:{initFilter:function(){var e=this;this.$store.dispatch("media/getArticleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?("FILE"!=e.form.autoReplyType&&(e.form.fileName=""),console.log(e.form,"8888"),e.$store.dispatch("automatic/automaticUpdate",t).then((function(){e.$message({type:"success",message:"新建成功"}),e.handleCancel(),e.initDataList()})).catch((function(t){e.$message({type:"error",message:t||"新建失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},changeAutoReplyType:function(e){this.form.mediaId=""},handleSetMessageImage:function(e,t){this.messageImage=URL.createObjectURL(t.raw),this.form.mediaId=e.id},handleSetMessageFile:function(e,t){this.messageFile=URL.createObjectURL(t.raw),this.form.mediaId=e.id,this.form.fileName=e.name},beforeUploadImage:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},beforeUploadFile:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("上传视频大小不能超过 50MB!"),t},handleRemove:function(e,t){console.log(e,t),this.fileList=t},beforeRemoveFile:function(e,t){return console.log("1111",this.fileList,t),this.$confirm("确定移除 ".concat(e.name,"？"))},handleClear:function(){this.form.mediaId="",this.welcomecontentT={}},removeFile:function(e){},handleDelMessageImage:function(){this.messageImage="",this.form.mediaId=null},handleDelMessageVideo:function(){this.messageVideo="",this.form.mediaId=null},handleDelMessageFile:function(){this.messageFile="",this.form.mediaId=null},handleChoseLink:function(e){this.welcomecontentT=this.articleListSelect.find((function(t){return t.uuid===e})),this.welcomecontentT&&this.welcomecontentT.uuid&&(this.form.mediaId=this.welcomecontentT.uuid)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleChange:function(){},initDataList:function(){var e=this;this.$store.dispatch("automatic/getListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))}}}),j=I,R=(a("814b"),a("b97d"),Object(m["a"])(j,q,O,!1,null,"6b46a4bc",null)),N=R.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"规则名称",prop:"rule",maxlength:"15","show-word-limit":""}},[a("span",[e._v(e._s(e.form.rule))])]),e._v(" "),a("el-form-item",{attrs:{label:"关键词",prop:"keyWord"}},[a("span",[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"请选择",disabled:""},slot:"prepend",model:{value:e.form.keyType,callback:function(t){e.$set(e.form,"keyType",t)},expression:"form.keyType"}},[a("el-option",{attrs:{label:"包含",value:"CONTAIN"}}),e._v(" "),a("el-option",{attrs:{label:"完全匹配",value:"COMPLETE"}})],1),e._v("\n      "+e._s(e.form.keyword)+"\n    ")],1)]),e._v(" "),a("el-form-item",{attrs:{label:"文字消息"}},[a("div",{staticClass:"full-w"},[a("span",[e._v(e._s(e.form.reply))])])]),e._v(" "),a("el-form-item",{attrs:{label:"图片/文章/链接"}},[a("div",{staticClass:"msg-textarea-box full-w"},[a("div",{staticClass:"message-box-content"},[a("el-radio-group",{on:{change:e.changeAutoReplyType},model:{value:e.form.autoReplyType,callback:function(t){e.$set(e.form,"autoReplyType",t)},expression:"form.autoReplyType"}},[a("el-radio",{attrs:{label:"IMAGE"}},[e._v("图片")]),e._v(" "),a("el-radio",{attrs:{label:"FILE"}},[e._v("文件")]),e._v(" "),a("el-radio",{attrs:{label:"ARTICLE"}},[e._v("文章")])],1),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"IMAGE"==e.form.autoReplyType,expression:"form.autoReplyType == 'IMAGE'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/upload","show-file-list":!1,"on-success":e.handleSetMessageImage,"before-upload":e.beforeUploadImage}},[e.messageImage?a("el-image",{staticClass:"avatar",attrs:{fit:"contain",src:e.messageImage}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),e._v(" "),e.messageImage?a("i",{staticClass:"el-icon-circle-close close",on:{click:function(t){return t.stopPropagation(),e.handleDelMessageImage(t)}}}):e._e()],1)]),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:"FILE"==e.form.autoReplyType,expression:"form.autoReplyType == 'FILE'"}],staticClass:"message-content display-flex"},[a("div",{staticClass:"img-warp"},[a("el-upload",{attrs:{action:"/api/upload","on-success":e.handleSetMessageFile,"before-upload":e.beforeUploadFile,"before-remove":e.beforeRemoveFile,"on-remove":e.removeFile,multiple:"","show-file-list":!0,"file-list":e.fileList}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:""==e.messageFile,expression:"messageFile == ''"}],attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"ARTICLE"==e.form.autoReplyType,expression:"form.autoReplyType == 'ARTICLE'"}],staticClass:"message-content"},[a("el-select",{staticClass:"label-warp",staticStyle:{width:"100%"},attrs:{"popper-append-to-body":!1,clearable:"",placeholder:"请选择","popper-class":"selectinfo"},on:{change:e.handleChoseLink,clear:e.handleClear},model:{value:e.form.mediaId,callback:function(t){e.$set(e.form,"mediaId",t)},expression:"form.mediaId"}},[e.form.mediaId?a("div",{staticClass:"display-flex align-items-center label-input",attrs:{slot:"prefix"},slot:"prefix"},[a("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:"/api/public/file/"+e.welcomecontentT.imgId,alt:""}}),e._v(" "),a("div",{staticClass:"input-title"},[a("span",[e._v(e._s(e.welcomecontentT.title))]),e._v(" "),a("div",{staticClass:"input-content text-over"},[e._v(e._s(e.welcomecontentT.description))])])]):e._e(),e._v(" "),e._l(e.articleListSelect,(function(t,i){return a("el-option",{key:i,attrs:{label:t.title,value:t.uuid}},[a("div",{staticClass:"option-warp flex-between-alinecenter"},[a("div",{staticClass:"link-img"},[a("img",{staticClass:"option-img",attrs:{src:"/api/public/file/"+t.imgId}})]),e._v(" "),a("div",{staticClass:"option-content flex-1"},[a("p",[e._v(e._s(t.title))]),e._v(" "),a("p",[e._v(e._s(t.description))])])])])}))],2)],1)],1)])]),e._v(" "),a("el-form-item",{attrs:{label:"配置标签"}},[a("el-radio-group",{model:{value:e.form.autoReplyTagType,callback:function(t){e.$set(e.form,"autoReplyTagType",t)},expression:"form.autoReplyTagType"}},[a("el-radio",{attrs:{label:"CONTAIN"}},[e._v("包含其一")]),e._v(" "),a("el-radio",{attrs:{label:"COMPLETE"}},[e._v("完全匹配")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:" "}},[a("tag-multi-select",{on:{"select-change":e.handleChange},model:{value:e.form.tagIdList,callback:function(t){e.$set(e.form,"tagIdList",t)},expression:"form.tagIdList"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},z=[],P={inject:["reload"],components:{AsyncUserTag:_["a"],ComplexSelect:y["a"],inputEdit:C["a"],TagMultiSelect:x["a"]},props:{transfer:{type:Object,default:function(){}}},data:function(){return{fileList:[],type:"",form:{autoReplyTagType:"CONTAIN",autoReplyType:"CONTENT",keyType:"CONTAIN",fileName:"",keyword:"",mediaId:"",reply:"",rule:"",tagIdList:[]},insertName:!0,messageImage:"",messageVideo:"",messageFile:"",mediaId:"",welcomecontentT:{},memberNick:"客户昵称",rules:{rule:[{required:!0,message:"请输入规则名称",trigger:"blur"}],keyword:[{required:!0,message:"请输入关键词",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]},selectTags:[]}},watch:{transfer:{handler:function(e,t){console.log(e,"3333"),this.form.autoReplyTagType=e.autoReplyTagType,this.form.autoReplyType=e.autoReplyType,this.form.keyType=e.keyType,this.form.fileName=e.fileName,this.form.keyword=e.keyWord,this.form.mediaId=e.mediaId,this.form.reply=e.replyWord,this.form.rule=e.ruleWord;var a=[];"{}"!=e.autoReplyTags&&e.autoReplyTags.length>0&&e.autoReplyTags.map((function(e){e.tags.map((function(e){a.push(e.uuid)}))})),this.fileList=[],e.fileName&&e.mediaUrl&&this.fileList.push({name:e.fileName,url:e.mediaUrl}),this.form.tagIdList=a},immediate:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])({articleListSelect:function(e){return e.media.articleListSelect}})),{},{toUser:function(){return this.form.toUser}}),mounted:function(){this.initFilter()},methods:{initFilter:function(){var e=this;this.$store.dispatch("media/getArticleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleConfirm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){"FILE"!=e.form.autoReplyType&&(e.form.fileName="");var a=e.form;e.$store.dispatch("automatic/add",a).then((function(){e.$message({type:"success",message:"新建成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:t||"新建失败"})}))}else e.$message({type:"error",message:"请检查输入"})}))},changeAutoReplyType:function(e){this.form.mediaId=""},handleSetMessageImage:function(e,t){this.messageImage=URL.createObjectURL(t.raw),this.form.mediaId=e.id},handleSetMessageFile:function(e,t){this.messageFile=URL.createObjectURL(t.raw),this.form.mediaId=e.id},beforeUploadImage:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},beforeUploadFile:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("上传视频大小不能超过 50MB!"),t},beforeRemoveFile:function(e){var t=this;this.$confirm("确定移除 ".concat(e.name,"？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.fileList=[],t.$message({type:"success",message:"删除成功!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleClear:function(){this.form.mediaId="",this.welcomecontentT={}},removeFile:function(e){this.messageFile="",this.form.mediaId=null},handleDelMessageImage:function(){this.messageImage="",this.form.mediaId=null},handleDelMessageVideo:function(){this.messageVideo="",this.form.mediaId=null},handleDelMessageFile:function(){this.messageFile="",this.form.mediaId=null},handleChoseLink:function(e){this.welcomecontentT=this.articleListSelect.find((function(t){return t.uuid===e})),this.welcomecontentT&&this.welcomecontentT.uuid&&(this.form.mediaId=this.welcomecontentT.uuid)},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleChange:function(){}}},F=P,V=(a("cfd3"),a("0b55"),Object(m["a"])(F,M,z,!1,null,"3fb220f9",null)),B=V.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.form.departmentsUuid,callback:function(t){e.$set(e.form,"departmentsUuid",t)},expression:"form.departmentsUuid"}},e._l(e.departments,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v("\n    "+e._s(e.user.uuid)+"\n    "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},W=[],H={data:function(){return{form:{departmentsUuid:0}}},computed:Object(r["a"])({},Object(c["c"])({user:function(e){return e.user.currentRowUserList},departments:function(e){return e.department.departments}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){}}},J=H,Y=Object(m["a"])(J,G,W,!1,null,null,null),X=Y.exports,K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"被通知人"}},[a("div",[a("el-radio",{attrs:{label:"USER"},model:{value:e.form.informType,callback:function(t){e.$set(e.form,"informType",t)},expression:"form.informType"}},[e._v("员工通知")]),e._v(" "),a("el-radio",{attrs:{label:"ROLE"},model:{value:e.form.informType,callback:function(t){e.$set(e.form,"informType",t)},expression:"form.informType"}},[e._v("角色通知")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:""}}),e._v(" "),a("div",{staticClass:"mb-20"},[a("keep-alive",["ROLE"==e.form.informType?a("div",{staticClass:"role-container mb-20"},[a("el-select",{attrs:{multiple:""},model:{value:e.roleSelects,callback:function(t){e.roleSelects=t},expression:"roleSelects"}},e._l(e.roleListSelect,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1):a("div",[a("complex-select",{attrs:{section:"user",options:e.departmentList},model:{value:e.userSelects,callback:function(t){e.userSelects=t},expression:"userSelects"}})],1)]),e._v(" "),a("span",{staticClass:"font-exs color-info"},[e._v("当员工触发敏感词后，除通知以上设置被通知人，触发的员工本人也将收到通知消息。")])],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)},Q=[],Z={inject:["reload"],props:{transfer:{type:Object,default:function(){return{}}}},components:{ComplexSelect:y["a"]},data:function(){return{roleSelects:[],userSelects:[],form:{informType:"ROLE",sensitiveUuid:[],noticeUuid:[]}}},watch:{transfer:{handler:function(e,t){console.log(e.sensitiveUuid),this.form.sensitiveUuid=e.sensitiveUuid},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({departmentList:function(e){return e.department.departmentList},roleListSelect:function(e){return e.role.roleListSelect}})),created:function(){this.initFilter()},mounted:function(){console.log(this.$store.state.role)},methods:{initFilter:function(){var e=this;this.$store.dispatch("role/getRoleListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},handleConfirm:function(){var e=this,t=this.userSelects.length?this.userSelects.map((function(e){return e.uuid})):this.roleSelects.map((function(e){return e.uuid})),a=Object(r["a"])(Object(r["a"])({},this.form),{},{noticeUuid:t});console.log(a),this.$store.dispatch("sensitive/updateNoticeUser",a).then((function(t){0==t.code&&(e.$message({type:"success",message:"操作成功"}),e.reload())})).catch((function(t){e.$message({type:"error",message:t||"操作失败"})}))}}},ee=Z,te=Object(m["a"])(ee,K,Q,!1,null,null,null),ae=te.exports,ie={components:{CreateTemplate:w,EditTemplate:N,DetailTemplate:B,DistributeTemplate:X,ChangeTemplate:ae,CreateSetTemplate:U},data:function(){return{dialogVisible:!1,event:"",eventType:"",transfer:{}}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"create"===this.eventType?"新建回复内容":"createSet"===this.eventType?"全局设置":"edit"===this.eventType?"编辑自动回复":"detail"===this.eventType?"详情":"change"===this.eventType?"修改通知人":void 0},close:function(){this.event=""}}},ne=ie,se=Object(m["a"])(ne,p,g,!1,null,null,null),re=se.exports,le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},oe=[],ce={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},ue=ce,de=(a("daca"),Object(m["a"])(ue,le,oe,!1,null,"a2e8120c",null)),me=de.exports,fe=a("1b32"),he=a("6424"),pe=a("1a6c"),ge=a("ecfe"),ve={components:{ListHeader:h,FormDialog:re,ToolBar:me,AsyncUserTag:_["a"],AsyncUserDrawer:fe["a"],RoleDrawer:pe["a"],TagsDrawer:he["a"],CustomerPagination:ge["a"]},data:function(){return{isReplySwitch:!1,pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,ruleName:"",keyWord:"",replyWord:"",tagIds:[],flag:!0,startTime:"",endTime:""},rowSelects:[]}},watch:{},computed:Object(r["a"])({},Object(c["c"])({loading:function(e){return e.automatic.loading},listAll:function(e){return e.automatic.listAll},page:function(e){return e.automatic.page},permissionMap:function(e){return e.permission.permissionMap},autoReplyContentType:function(e){return e.enum.autoReplyContentType},replySwitch:function(e){return e.automatic.replySwitch}})),created:function(){this.initDataList(this.query),this.initFilter()},methods:{doExport:function(e){console.log(e)},initDataList:function(e){var t=this;this.$store.dispatch("automatic/getListAll",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total,t.isReplySwitch=t.replySwitch})).catch((function(e){t.$message({type:"error",message:e||"初始化失败"})}))},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},handleClickReplySwitch:function(){var e={flag:this.isReplySwitch};this.$store.dispatch("automatic/automaticSwitchReply",e).then((function(){})).catch((function(e){}))},handleEdit:function(e){var t=this,a=e.uuid;console.log(e,"row"),this.$refs["formDialog"].event="EditTemplate",this.$refs["formDialog"].eventType="edit",this.$refs["formDialog"].dialogVisible=!0,this.$store.dispatch("automatic/automaticDetail",a).then((function(e){t.$refs["formDialog"].transfer=e})).catch((function(e){}))},handleSearch:function(e){var t=e.ruleName,a=e.keyWord,i=e.replyWord,n=e.tagIds,s=e.flag,r=e.startTime,l=e.endTime;this.query.ruleName=t||"",this.query.keyWord=a||"",this.query.replyWord=i||"",this.query.tagIds=n?n+"":[],this.query.flag=!!s,this.query.startTime=r||"",this.query.endTime=l||"",this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleClickSetAutoReplay:function(){this.$refs["formDialog"].event="CreateSetTemplate",this.$refs["formDialog"].eventType="createSet",this.$refs["formDialog"].dialogVisible=!0},handleCreate:function(){this.$refs["formDialog"].event="CreateTemplate",this.$refs["formDialog"].eventType="create",this.$refs["formDialog"].dialogVisible=!0},handleDelete:function(e){var t=this,a={uuid:row.uuid};this.$confirm("是否删除当前自动回复","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("automatic/doDelete",a).then((function(){t.$message({type:"success",message:"操作成功"}),t.initDataList(t.query)})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){}))},handleBatchChange:function(){if(this.rowSelects.length){var e=this.rowSelects.map((function(e){return e.uuid})),t={sensitiveUuid:e};this.$refs["formDialog"].event="ChangeTemplate",this.$refs["formDialog"].eventType="change",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=t}else this.$message({type:"warning",message:"请至少选择一项"})},handleSelectionChange:function(e){this.rowSelects=e},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},be=ve,ye=(a("2dff"),a("6766"),Object(m["a"])(be,i,n,!1,null,"20371d8e",null));t["default"]=ye.exports},f468:function(e,t,a){},f4b4:function(e,t,a){"use strict";var i=a("0fa7"),n=a.n(i);n.a},f4d4:function(e,t,a){},f552:function(e,t,a){},f558:function(e,t,a){"use strict";var i=a("9682"),n=a.n(i);n.a},f577:function(e,t,a){"use strict";var i=a("5658"),n=a.n(i);n.a},f57a:function(e,t,a){},f5a7:function(e,t,a){},f5be:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{on:{handleExport:e.doExport}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_redistributionExUser"]},on:{click:e.handleDistribute}},[e._v("分配客户资源")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.quitUserRelationExUserList,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"离职员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"user-card"},[a("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px"},attrs:{src:t.row.avatar,lazy:""}}),e._v(" "),a("div",{staticClass:"client-info"},[a("span",{staticClass:"remark"},[e._v(e._s(t.row.name))]),e._v(" "),a("div",[e._v(e._s(t.row.role.name))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"公司",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.departments,(function(t,i){return a("div",{key:i},[a("p",[e._v(e._s(t.name))])])}))}}])}),e._v(" "),a("el-table-column",{attrs:{label:"待分配人数",prop:"externalUserNum",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"待分配群数",prop:"groupNum",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"离职时间",align:"left",prop:"updatedAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"ALLOCATE"===t.row.userStatus?"success":"info"}},[e._v(e._s(e.quitUserRelationExUserListUserStatus[t.row.userStatus]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_redistributionExUser"]},on:{click:function(a){return a.stopPropagation(),e.handleDistributeSingle(t.row)}}},[e._v("分配")]),e._v(" "),a("el-t-button",{attrs:{popAuth:!0,auth:e.permissionMap["externalUser"]["externalUser_quitUserRelationExUserList"],type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=(a("ac6a"),a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"external-user-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"已离职成员："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入已离职成员名称"},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户状态："}},[a("el-select",{model:{value:e.query.status,callback:function(t){e.$set(e.query,"status",t)},expression:"query.status"}},e._l(e.contractWay,(function(e,t){return a("el-option",{key:t,attrs:{label:e.type,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"离职时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{contractWay:[{type:"待分配",id:"ALLOCATE"},{type:"等待分配审核",id:"2"},{type:"已分配",id:"ALLOCATED"}],value:[],query:{name:"",status:"",startTime:"",endTime:""}}},computed:Object(s["a"])({},Object(o["c"])({})),methods:{handleSelectedTime:function(e){this.query.startTime=this.value[0],this.query.endTime=this.value[1]},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.query=this.$options.data().query}}},u=c,d=a("2877"),m=Object(d["a"])(u,r,l,!1,null,null,null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"","destroy-on-close":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component",attrs:{selectData:e.selectedAllData}})],1)])],1)},p=[],g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("div",[a("complex-select",{attrs:{options:e.departmentList},model:{value:e.selects,callback:function(t){e.selects=t},expression:"selects"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleConfrim("form")}}},[e._v("确定")])],1)])],1)},v=[],b=a("8cbb"),y={inject:["reload"],props:{selectData:{type:Array,default:function(){}}},components:{ComplexSelect:b["a"]},data:function(){return{selects:[],form:{departmentsUuid:""},rules:{departmentsUuid:[{required:!0,message:"请选择分配人员",trigger:["change","blur"]}]}}},watch:{selectData:function(e,t){var a=this;console.log(e,"33"),e.forEach((function(e){a.selects.push(e)}))}},computed:Object(s["a"])({},Object(o["c"])({user:function(e){return e.user.currentRowUserList},departmentList:function(e){return e.department.departmentList},userListSelect:function(e){return e.user.listSelect},quitUserCurrentRow:function(e){return e.externalUser.quitUserCurrentRow}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.$refs["form"].resetFields(),this.selects=this.$options.data().selects,this.closeDialog()},handleConfrim:function(){var e=this;console.log(this.selects,"selects");var t=this.selects.map((function(e){return e.uuid}));console.log(t,"a","selectData");var a=this.selectData.map((function(e){return e.uuid})),i={handoverUuids:a,takeoverUserId:t.join()};console.log(i,"payload"),this.$store.dispatch("externalUser/redistributionExUser",i).then((function(t){switch(console.log(t,"999"),t){case 0:e.$message({type:"error",message:"分配出现异常，部分未成功"}),e.handleCancel();break;case-1:e.$message({type:"error",message:"分配失败"}),e.handleCancel();break;default:e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.handleRefresh();break}})).catch((function(t){e.$message({type:"error",message:"操作失败"})})),this.$refs["form"].resetFields()},handleRefresh:function(){this.$bus.$emit("handleRefresh")}}},_=y,C=Object(d["a"])(_,g,v,!1,null,null,null),x=C.exports,$={components:{DistributeTemplate:x},data:function(){return{dialogVisible:!1,event:"",eventType:"distribute",selectedAllData:[]}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(s["a"])({},Object(o["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){if("distribute"===this.eventType)return"分配模板"}}},k=$,T=Object(d["a"])(k,h,p,!1,null,null,null),w=T.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},D=[],E={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},L=E,A=(a("e8a6"),Object(d["a"])(L,S,D,!1,null,"5d227f06",null)),U=A.exports,q=a("ecfe"),O={name:"runWayListAll",components:{ListHeader:f,FormDialog:w,ToolBar:U,CustomerPagination:q["a"]},data:function(){return{pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,status:"",name:"",startTime:"",endTime:""},selectedAllData:[]}},watch:{},computed:Object(s["a"])({},Object(o["c"])({loading:function(e){return e.externalUser.loading},quitUserRelationExUserListUserStatus:function(e){return e.enum.quitUserRelationExUserListUserStatus},quitUserRelationExUserList:function(e){return e.externalUser.quitUserRelationExUserList},quitListPage:function(e){return e.externalUser.quitListPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.initDataList(this.query),this.initFilter()},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)})),this.$once("hook:beforeDestroy",(function(){e.$bus.$off("handleRefresh")}))},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("department/getDepartmentListAll").then((function(){})).catch((function(t){e.$message({type:"error",message:t||"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getQuitUserRelationExUserList",e).then((function(){t.pageConfig.pageNumber=t.quitListPage.pageNumber+1,t.pageConfig.total=t.quitListPage.total})).catch((function(e){console.error(e),t.$message({type:"error",message:e||"初始化失败"})}))},handleSearch:function(e){var t=e.name,a=e.status,i=e.startTime,n=e.endTime;this.query.name=t||this.query.name,this.query.status=a||this.query.status,this.query.startTime=i||this.query.startTime,this.query.endTime=n||this.query.endTime,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},handleDetail:function(e){console.log(e,"row");var t=e.uuid;this.$router.push({path:"/user/detail/"+t})},handleDistribute:function(){this.selectedAllData.length?(this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].selectedAllData=this.selectedAllData):this.$message({type:"warning",message:"请至少选择一个客户"})},handleDistributeSingle:function(e){var t=this;this.$refs.multipleTable.clearSelection(),this.handleSelectionChange([e]),this.selectedAllData.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)}));var a={};this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0,this.$refs["formDialog"].transfer=a,this.$store.commit("externalUser/SAVE_QUITUSERCURRENTROW",e)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},handleSelectionChange:function(e){this.selectedAllData=e},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},I=O,j=(a("96c4"),a("77f4"),Object(d["a"])(I,i,n,!1,null,"48ec7cd3",null));t["default"]=j.exports},f5e3:function(e,t,a){},f5e3b:function(e,t,a){"use strict";var i=a("f5e3"),n=a.n(i);n.a},f625:function(e,t,a){"use strict";var i=a("67b6"),n=a.n(i);n.a},f6bc:function(e,t,a){},f6d6:function(e,t,a){"use strict";var i=a("4166"),n=a.n(i);n.a},f7f9:function(e,t,a){"use strict";var i=a("7d54"),n=a.n(i);n.a},f8bf:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",[a("el-col",{attrs:{span:16}},[a("div",[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{hasRefresh:!0,hasExport:!1,msg:"共"+e.pageConfig.total+"条记录"},on:{handleRefresh:e.handleRefresh}},[a("div",{attrs:{slot:"right"},slot:"right"})])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.listAll,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"},on:{"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{label:"阅读客户",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-image",{staticStyle:{width:"36px",height:"36px"},attrs:{src:i.externalUser.avatar}}),e._v(" "),a("div",{staticStyle:{"margin-left":"10px"}},[a("span",[e._v(e._s(i.externalUser.name))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"首次阅读",align:"left",prop:"createdAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"最近阅读",align:"left",prop:"updatedAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"阅读时长",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                      "+e._s(a.readTime)+" 秒\n                  ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"阅读次数",align:"left",prop:"readCount"}})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{currentChange:e.changePage}})],1)])],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"margin-left":"10px"}},[a("el-card",{staticClass:"content-spacing"},[a("div",[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("h3",{staticStyle:{display:"inline-block"}},[e._v("文章详情")]),e._v(" "),a("el-t-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"mini",type:"primary"},on:{click:e.handleEdit}},[e._v("编辑")])],1),e._v(" "),a("h4",{staticStyle:{"margin-bottom":"20px"}},[a("span",[e._v("标题：")]),e._v(" "),a("span",[e._v(e._s(e.articleDetail.title))])]),e._v(" "),a("h5",{staticStyle:{"margin-bottom":"10px"}},[e._v("描述")]),e._v(" "),a("div",{staticStyle:{"margin-bottom":"20px"}},[a("span",{staticClass:"font-exs color-info"},[e._v(e._s(e.articleDetail.description))])]),e._v(" "),a("h5",{staticStyle:{"margin-bottom":"20px"}},[e._v("正文")]),e._v(" "),e.articleDetail.imgId?a("div",{staticClass:"cover-image"},[a("el-image",{attrs:{fit:"contain",src:"/api/public/file/"+e.articleDetail.imgId}})],1):e._e(),e._v(" "),a("div",{staticClass:"article-container"},[a("div",{domProps:{innerHTML:e._s(e.articleDetail.articleContent)}})])])])],1)])],1)],1)},n=[],s=(a("96cf"),a("1da1")),r=(a("7f7f"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"external-user-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"阅读人："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入客户名称"},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{value:[],contractWay:[{type:"员工主动添加",id:"1"},{type:"员工被动添加",id:"2"},{type:"二维码扫码添加",id:"3"}],query:{name:"",contractWayId:"",userId:"",tagIds:[],flag:!0,startTime:"",endTime:""},timer:null}},computed:Object(r["a"])({},Object(c["c"])({tagListAll:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){console.log(e),this.query.startTime=this.value[0],this.query.endTime=this.value[1],this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSelectedChange:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query}}},d=u,m=(a("0fa3"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"7d1b9de7",null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},g=[],v={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},b=v,y=(a("d4aa"),Object(m["a"])(b,p,g,!1,null,"bd54b36a",null)),_=y.exports,C=a("ecfe"),x={components:{CustomerPagination:C["a"],ListHeader:h,ToolBar:_},data:function(){return{showDrawer:!1,pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,name:""},articleUuid:""}},watch:{},computed:Object(r["a"])({},Object(c["c"])({loading:function(e){return e.media.loading},listAll:function(e){return e.media.browsingRecords},page:function(e){return e.media.recordsPage},permissionMap:function(e){return e.permission.permissionMap},articleDetail:function(e){return e.media.articleDetail}})),created:function(){var e,t,a,i,n=null===(e=this.$route)||void 0===e||null===(t=e.params)||void 0===t?void 0:t.articleUuid;this.articleUuid=null===(a=this.$route)||void 0===a||null===(i=a.params)||void 0===i?void 0:i.articleUuid;var s=this.query;this.initDataList({uuid:n,data:s}),this.initArticle(n)},methods:{doExport:function(e){console.log(e)},initFilter:function(){var e=this;this.$store.dispatch("batchSendTask/getListMy").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getAllUserList").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},initArticle:function(e){var t=this;this.$store.dispatch("media/getArticleDetail",e).then((function(){})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},initDataList:function(e){var t=this;this.$store.dispatch("media/browsingRecords",e).then((function(){t.pageConfig.pageNumber=t.page.pageNumber+1,t.pageConfig.total=t.page.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail",query:{uuid:t}})},handleSearch:function(e){var t=e.name;this.query.name=t;var a=this.articleUuid,i=this.query;console.log("sousuo",i),this.initDataList({uuid:a,data:i})},handleRefresh:function(){var e=this.articleUuid,t=this.query;this.initDataList({uuid:e,data:t})},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1;var t=this.articleUuid,a=this.query;this.initDataList({uuid:t,data:a})},handleCreate:function(){this.$router.push({path:"/media/article/detail/0"})},handleEdit:function(e){var t=this.$route.params.articleUuid;this.$router.push({path:"/media/article/detail/"+t})},handleDelete:function(e){var t=this,a=this.listAll[e].uuid;this.$confirm("是否删除当前动态","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("media/deleteMedia",{uuid:a}).then((function(){t.$message({type:"success",message:"操作成功"}),t.reload()})).catch((function(e){t.$message({type:"error",message:e})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e)}))},handleRowClick:function(e){console.log(e)}}},$=x,k=(a("4a60"),a("330d"),Object(m["a"])($,i,n,!1,null,"3d801028",null));t["default"]=k.exports},f926:function(e,t,a){"use strict";var i=a("dfb0"),n=a.n(i);n.a},f953:function(e,t,a){"use strict";var i=a("0923"),n=a.n(i);n.a},fa22:function(e,t,a){},fa3f:function(e,t,a){"use strict";var i=a("7945"),n=a.n(i);n.a},faad:function(e,t,a){},fab0:function(e,t,a){"use strict";var i=a("a6b4"),n=a.n(i);n.a},fbff:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tag-warp"},[e._l(e.newTagsListPack,(function(t,i){return a("div",{key:i,staticClass:"tag-list-warp"},[a("el-row",{attrs:{gutter:20,type:"flex",justify:"center"}},[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"lg-42"},[e._v(e._s(t.groupName))])]),e._v(" "),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"tag-list display-flex align-items-center flex-wrap"},[a("el-checkbox-group",{attrs:{size:"small"},on:{change:e.handleCheckedTagsChange},model:{value:e.checkedGroup,callback:function(t){e.checkedGroup=t},expression:"checkedGroup"}},e._l(t.tagList,(function(t,i){return a("el-checkbox-button",{key:i,staticStyle:{"margin-bottom":"5px","margin-right":"5px"},attrs:{label:t.tagId,border:""}},[e._v(e._s(t.tagName))])})),1)],1)])],1)],1)})),e._v(" "),e.isShowMore&&e.newTagsList.length>2?a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.curly=!e.curly}}},[e._v("\n      展开 \n      "),a("i",{class:[e.curly?"el-icon-caret-bottom":"el-icon-caret-top"]})])],1):e._e()],2)},n=[],s=(a("6762"),a("2fdb"),a("5530")),r=a("2f62"),l={props:{tagListSelect:{type:Array,default:function(){return[]}},checkboxGroup:{type:Array,default:function(){return[]}},packUp:{type:Boolean,default:function(){return!1}},isShow:{type:Boolean,default:function(){return!1}}},watch:{packUp:{handler:function(e,t){e&&(this.curly=e)},immediate:!0},isShow:{handler:function(e,t){console.log(e,"nd444ddd"),e&&(this.isShowMore=e)},immediate:!0}},computed:Object(s["a"])(Object(s["a"])({},Object(r["c"])({})),{},{newTagsListPack:function(){return console.log(this.curly,"curly"),this.curly?this.newTagsList.slice(0,2):this.newTagsList}}),data:function(){return{checkedGroup:[],newTagsList:[],curly:!1,isShowMore:!1}},created:function(){var e=this;this.checkedGroup=this.checkboxGroup,this.checkedGroup.length>0?(this.newTagsList=JSON.parse(JSON.stringify(this.tagListSelect)),this.newTagsList.map((function(t,a){var i=t.tagList.some((function(t){return e.checkedGroup.includes(t.tagId)}));i&&(e.newTagsList.splice(a,1),e.newTagsList.unshift(t))}))):this.newTagsList=JSON.parse(JSON.stringify(this.tagListSelect)),console.log(this.curly,"88888888888")},mounted:function(){},methods:{handleCheckedTagsChange:function(e){this.$emit("change",e)}}},o=l,c=(a("790a"),a("5abb"),a("2877")),u=Object(c["a"])(o,i,n,!1,null,"d86d695e",null);t["a"]=u.exports},fc12:function(e,t,a){},fc32:function(e,t,a){},fc5d:function(e,t,a){"use strict";var i=a("c1fb"),n=a.n(i);n.a},fd1d:function(e,t,a){"use strict";var i=a("d3577"),n=a.n(i);n.a},fdeb:function(e,t,a){},fdf4:function(e,t,a){},fe26:function(e,t,a){},fe94:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{msg:"共"+e.pageConfig.total+"个客户"},on:{handleExport:e.doExport}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.runWayListAll,"row-key":"uuid",stripe:"",lazy:"",fit:"","highlight-current-row":"","header-row-class-name":"el-table-header"}},[a("el-table-column",{attrs:{label:"流失客户",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"user-card"},[a("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px"},attrs:{src:t.row.externalUser.avatar,lazy:""}}),e._v(" "),a("div",{staticClass:"client-info"},[a("span",{staticClass:"remark"},[e._v("\n                  "+e._s(t.row.remark)+"\n                  "),a("span",{staticClass:"main-color"},[e._v(e._s(1==t.row.externalUser.type?"@微信":"@企业微信"))])]),e._v(" "),a("div",[e._v(e._s(t.row.externalUser.name))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属员工",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[Object.keys(i.user).length?a("div",e._l([i.user],(function(t){return a("async-user-tag",{key:t.uuid,attrs:{size:"small",type:"info",uuid:t.uuid}},[a("i",{staticClass:"el-icon-user-solid"}),e._v("\n                "+e._s(t.name)+"\n              ")])})),1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"标签",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.tags?a("tags-drawer-obj",{attrs:{tags:t.row.tags.corpTags}}):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"流失时间",align:"left",prop:"updatedAt"}}),e._v(" "),a("el-table-column",{attrs:{label:"流失类型",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.delFollow?"被客户删除":"主动删除客户"))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index,t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("customer-pagination",{attrs:{pageConfig:e.pageConfig},on:{"current-change":e.changePage,"size-change":e.changeSize}})],1)])],1)},n=[],s=(a("7f7f"),a("5530")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",staticClass:"run-way-list-all-header",attrs:{inline:"","label-width":"120px"}},[a("el-form-item",{attrs:{label:"客户名称："}},[a("el-input",{attrs:{clearable:""},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name","string"===typeof t?t.trim():t)},expression:"query.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"流失类型："}},[a("el-select",{model:{value:e.query.delFollow,callback:function(t){e.$set(e.query,"delFollow",t)},expression:"query.delFollow"}},e._l(e.typeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属员工："}},[a("el-select",{attrs:{filterable:""},model:{value:e.query.userUuid,callback:function(t){e.$set(e.query,"userUuid",t)},expression:"query.userUuid"}},e._l(e.userListAll,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"流失时间："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.handleSelectedTime},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户标签："}},[a("div",{staticClass:"tag-border"},[a("el-select",{attrs:{filterable:"",size:"mini",multiple:""},model:{value:e.query.tagIds,callback:function(t){e.$set(e.query,"tagIds",t)},expression:"query.tagIds"}},e._l(e.tagListAll,(function(t){return a("el-option-group",{key:t.groupId,attrs:{label:t.groupName}},e._l(t.tagList,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.tagName,value:e.uuid}})})),1)})),1),e._v(" "),a("span",{staticClass:"tag-warp"},[a("el-radio-group",{model:{value:e.query.flag,callback:function(t){e.$set(e.query,"flag",t)},expression:"query.flag"}},[a("el-radio",{attrs:{label:!0}},[e._v("包含任一")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("完全匹配")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"right"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            包含任一：有任意一个选择的标签的用户;\n            "),a("br"),e._v("完全匹配：必须拥有全部选择的标签的用户。\n          ")]),e._v(" "),a("i",{staticClass:"el-icon-question tip"})])],1)],1)]),e._v(" "),a("div",{staticClass:"handle-warp"},[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},l=[],o=a("2f62"),c={data:function(){return{value:[],query:{name:"",userUuid:"",tagIds:[],flag:!0,startTime:"",endTime:"",delFollow:""},typeOptions:[{label:"主动删除客户",value:!1},{label:"被客户删除",value:!0}],contractWay:[{type:"员工主动添加",id:"1"},{type:"员工被动添加",id:"2"},{type:"二维码扫码添加",id:"3"}],timer:null}},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListSelect},userListAll:function(e){return e.user.listSelect}})),methods:{handleSelectedTime:function(e){this.query.startTime=this.value[0],this.query.endTime=this.value[1]},handleChangeSecond:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.$emit("handleSearch",t.query)}),1e3)},handleSelectedChange:function(e){this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),this.value=this.$options.data().value,this.query=this.$options.data().query}}},u=c,d=(a("ecb1"),a("2877")),m=Object(d["a"])(u,r,l,!1,null,"3cb87beb",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tool-bar-container"},[a("div",{staticClass:"left"},[e._t("left")],2),e._v(" "),a("div",{staticClass:"middle-left"},[e.hasExport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionExport}},[e._v("导出Excel")]):e._e(),e._v(" "),e.hasImport?a("el-button",{attrs:{type:"primary"},on:{click:e.actionImport}},[e._v("导入Excel")]):e._e(),e._v(" "),e.hasRefresh?a("el-button",{attrs:{type:"text"},on:{click:e.actionRefresh}},[e._v("更新数据")]):e._e(),e._v(" "),a("span",{staticClass:"font-s color-info"},[e._v(e._s(e.msg))])],1),e._v(" "),a("div",{staticClass:"right"},[e._t("right")],2)])])},p=[],g={props:{msg:{type:String},hasExport:{type:Boolean,default:!0},hasImport:{type:Boolean,default:!1},hasRefresh:{type:Boolean,default:!1}},methods:{actionExport:function(){this.$emit("handleExport","导出")},actionImport:function(){this.$emit("handleImport","导入")},actionRefresh:function(){this.$emit("handleRefresh")}}},v=g,b=(a("a9d4"),Object(d["a"])(v,h,p,!1,null,"ba694076",null)),y=b.exports,_=a("fba9"),C=a("ee39"),x=a("51fb"),$=a("ecfe"),k={name:"runWayListAll",components:{ListHeader:f,ToolBar:y,AsyncUserTag:_["a"],TagsDrawerObj:C["a"],UserTag:x["a"],CustomerPagination:$["a"]},data:function(){return{hasPop:!1,pageConfig:{total:0,pageNumber:0,pageSize:10},query:{page:0,size:10,flag:!0,name:"",tagIds:"",userUuid:"",startTime:"",endTime:"",delFollow:""}}},watch:{},computed:Object(s["a"])({},Object(o["c"])({tagListAll:function(e){return e.tag.tagListAll},loading:function(e){return e.externalUser.loading},runWayListAll:function(e){return e.externalUser.runWayListAll},runWayListAllPage:function(e){return e.externalUser.runWayListAllPage}})),created:function(){this.initDataList(this.query),this.initFilter()},methods:{initDataList:function(e){var t=this;this.$store.dispatch("externalUser/getRunWayListAll",e).then((function(){t.pageConfig.pageNumber=t.runWayListAllPage.pageNumber+1,t.pageConfig.total=t.runWayListAllPage.total})).catch((function(e){console.error(e),t.$message({type:"error",message:"初始化失败"})}))},initFilter:function(){var e=this;this.$store.dispatch("tag/getListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})})),this.$store.dispatch("user/getUserListSelect").then((function(){})).catch((function(t){e.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e,t){this.$router.push({path:"/externalUser/detail/".concat(t.externalUser.uuid),query:{userId:t.user.userId}})},handleSearch:function(e){var t=e.name,a=(e.contractWayId,e.userUuid),i=e.tagIds,n=e.flag,s=e.startTime,r=e.endTime,l=e.delFollow;this.query.delFollow=""===l?"":!0===l,this.query.flag=!!n,this.query.name=t||this.query.name,this.query.tagIds=i?i+"":this.query.tagIds,this.query.userUuid=a||this.query.userUuid,this.query.startTime=s||this.query.startTime,this.query.endTime=r||this.query.endTime,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){this.query.page=e-1,this.pageConfig.pageNumber=e-1,this.initDataList(this.query)},doExport:function(e){console.log(e)},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},T=k,w=(a("1396"),a("e534c"),Object(d["a"])(T,i,n,!1,null,"204ae988",null));t["default"]=w.exports},feab:function(e,t,a){"use strict";var i=a("3179"),n=a.n(i);n.a},fefc:function(e,t,a){"use strict";var i=a("377b"),n=a.n(i);n.a},ff22:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"content-spacing"},[a("list-header",{ref:"listHeader",on:{handleSearch:e.handleSearch,handleRefresh:e.handleRefresh}})],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("tool-bar",{attrs:{usersNumber:e.userPage.total},on:{handleExport:e.doExport,handleUpdate:e.handleUpdate}},[a("div",{attrs:{slot:"right"},slot:"right"},[a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["user"]["user_update"]},on:{click:e.actionRole}},[e._v("批量分配角色")]),e._v(" "),a("el-t-button",{attrs:{type:"primary",popAuth:!0,auth:e.permissionMap["department"]["department_allocation"]},on:{click:e.actionDepartment}},[e._v("批量分配部门")])],1)])],1),e._v(" "),a("el-card",{staticClass:"content-spacing"},[a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userList,"row-key":"uuid",stripe:"",lazy:"","highlight-current-row":"","header-row-class-name":"el-table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"员工姓名",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"部门",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.departments[0]?a("div",[e._v(e._s(t.row.departments[t.row.departments.length-1].name))]):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"角色",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.role?a("div",[e._v(e._s(t.row.role.name))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isMessageUser",label:"会话存档授权",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:t.row.isMessageUser?"color-success":"color-danger"},[e._v(e._s(t.row.isMessageUser?"已授权":"未授权"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"允许登陆",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:t.row.visible?"color-success":"color-danger"},[e._v(e._s(t.row.visible?"已授权":"未授权"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"通讯录授权",prop:"isFollowUser"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:t.row.isFollowUser?"color-success":"color-danger"},[e._v(e._s(t.row.isFollowUser?"已授权":"未授权"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["user"]["user_update"]},on:{click:function(a){return a.stopPropagation(),e.handleDistributeRole(t.$index)}}},[e._v("分配角色")]),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["department"]["department_allocation"]},on:{click:function(a){return a.stopPropagation(),e.handleDistributeDepartment(t.$index)}}},[e._v("分配部门")]),e._v(" "),a("el-t-button",{attrs:{type:"text",size:"mini",popAuth:!0,auth:e.permissionMap["user"]["user_detail"]},on:{click:function(a){return a.stopPropagation(),e.handleDetail(t.$index)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pager",attrs:{background:"",layout:"total,prev, pager, next,jumper",total:e.pageConfig.total,"current-page":e.pageConfig.pageNumber,"page-size":e.pageConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"update:current-page":function(t){return e.$set(e.pageConfig,"pageNumber",t)},"current-change":e.changePage}})],1)]),e._v(" "),a("form-dialog",{ref:"formDialog"})],1)},n=[],s=a("36cd"),r=(a("7f7f"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{inline:""}},[a("el-form-item",{attrs:{label:"员工姓名："}},[a("el-input",{attrs:{clearable:"",placeholder:"员工姓名"},model:{value:e.query.userName,callback:function(t){e.$set(e.query,"userName","string"===typeof t?t.trim():t)},expression:"query.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所在部门："}},[a("el-select-tree",{attrs:{clearable:"",defaultExpandAll:!0,checkStrictly:!0,data:e.departmentList,props:{value:"uuid",label:"name",children:"children"}},model:{value:e.query.departmentsUuid,callback:function(t){e.$set(e.query,"departmentsUuid",t)},expression:"query.departmentsUuid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"员工角色："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.query.roleUuid,callback:function(t){e.$set(e.query,"roleUuid",t)},expression:"query.roleUuid"}},e._l(e.roleList,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"会话存档授权状态："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.isMessageUser,callback:function(t){e.$set(e.query,"isMessageUser",t)},expression:"query.isMessageUser"}},e._l(e.isMessageUserList,(function(e){return a("el-option",{key:e.isMessageUser,attrs:{label:e.name,value:e.isMessageUser}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"允许登陆授权："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.visible,callback:function(t){e.$set(e.query,"visible",t)},expression:"query.visible"}},e._l(e.visibleList,(function(e){return a("el-option",{key:e.visible,attrs:{label:e.name,value:e.visible}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"通讯录授权："}},[a("el-select",{attrs:{clearable:""},model:{value:e.query.isFollowUser,callback:function(t){e.$set(e.query,"isFollowUser",t)},expression:"query.isFollowUser"}},e._l(e.isFollowUserList,(function(e){return a("el-option",{key:e.isFollowUser,attrs:{label:e.name,value:e.isFollowUser}})})),1)],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:" "}},[a("el-t-button",{attrs:{size:"mini",type:"primary",clearable:""},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),a("el-t-button",{attrs:{size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1)],1)},o=[],c=a("2f62"),u={data:function(){return{options:[{label:"待审核",value:"TO_BE_REVIEWED"},{label:"审核通过",value:"APPROVED"},{label:"审核不通过",value:"AUDIT_FAILED"}],query:{userName:"",departmentsUuid:"",roleUuid:"",isFollowUser:null,isMessageUser:null,visible:null},isFollowUserList:[{isFollowUser:1,name:"已授权"},{isFollowUser:0,name:"未授权"}],isMessageUserList:[{isMessageUser:1,name:"已授权"},{isMessageUser:0,name:"未授权"}],visibleList:[{visible:1,name:"允许"},{visible:0,name:"禁止"}]}},computed:Object(r["a"])({},Object(c["c"])({roleList:function(e){return e.role.roleListSelect},departmentList:function(e){return e.department.listSelect}})),methods:{handleChangeFirst:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSecond:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeThird:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeForth:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeFifth:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleChangeSixth:function(e){console.log(e),this.$emit("handleSearch",this.query)},handleSearch:function(){this.$emit("handleSearch",this.query)},handleRefresh:function(){this.$emit("handleRefresh"),console.log(this.$options),this.query=this.$options.data().query}}},d=u,m=(a("ce8a"),a("2877")),f=Object(m["a"])(d,l,o,!1,null,"126b5802",null),h=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.genTitle(),visible:e.dialogVisible,"modal-append-to-body":!1,"append-to-body":"",width:"600px",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a(e.event,{tag:"component"})],1)])],1)},g=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},b=[],y={inject:["reload"],data:function(){return{hasParent:!1,form:{name:"",code:"",org:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{hasParent:{handler:function(e,t){},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},methods:{handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/addRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}},_=y,C=Object(m["a"])(_,v,b,!1,null,null,null),x=C.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级"}},[a("el-checkbox",{model:{value:e.hasParent,callback:function(t){e.hasParent=t},expression:"hasParent"}},[e._v("是否为子部门")])],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}},e._l(10,(function(t){return a("el-option",{key:t,attrs:{disabled:!e.hasParent,label:t,value:t}})})),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},k=[],T=(a("ac6a"),a("456d"),{inject:["reload"],data:function(){return{hasParent:!1,form:{code:"",name:"",org:0,uuid:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]}}},watch:{currDepartmentTemplate:{handler:function(e,t){e&&this.initData()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({currentRole:function(e){return e.role.currentRole},currentDepartment:function(e){return e.department.currentDepartment}})),updated:function(){},methods:{initData:function(){var e=this.currentDepartment.parent;this.form.name=this.currentDepartment.name,Object.keys(e).length&&(this.hasParent=!0,this.$set(this.form,"parent",e.uuid))},handleConfirm:function(){var e=this,t=this.form;this.$refs["form"].validate((function(a){a?(console.log(t),e.$store.dispatch("role/updateRole",t).then((function(){e.$message({type:"success",message:"操作成功"}),e.handleCancel(),e.refresh()})).catch((function(t){e.$message({type:"error",message:"操作失败"})}))):e.$message({type:"error",message:"请检查输入"})}))},handleCancel:function(){this.$parent.$parent.dialogVisible=!1},refresh:function(){var e=this;console.log("刷新"),this.$store.dispatch("role/getRoleList").then((function(){e.reload()})).catch((function(t){e.$message({type:"error",message:t})}))}}}),w=T,S=Object(m["a"])(w,$,k,!1,null,null,null),D=S.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select-tree",{attrs:{placeholder:"请选择部门",defaultExpandAll:!0,checkStrictly:!0,data:e.departmentList,props:e.departmentProps},model:{value:e.depUuid,callback:function(t){e.depUuid=t},expression:"depUuid"}})],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},L=[],A=(a("5df3b"),{data:function(){return{depUuid:"",departmentProps:{value:"uuid",label:"name",children:"children"},form:{userId:""},forms:[],isBatchUpdate:!1}},computed:Object(r["a"])({},Object(c["c"])({user:function(e){return e.user.currentRowUserList},users:function(e){return e.user.currentRowUsers},departmentList:function(e){return e.department.listSelect}})),watch:{user:{handler:function(e,t){0!=Object.keys(e)&&(this.depUuid=e.departments[0].uuid,this.isBatchUpdate=!1,this.form.userId=e.userId)},immediate:!0},users:{handler:function(e,t){var a=this;e.length>0&&(this.depUuid=e[0].departments[0].uuid,this.isBatchUpdate=!0,e.map((function(e,t){a.forms[t]={userId:e.userId}})))},immediate:!0}},methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){var e=this;if(this.isBatchUpdate){var t=[];this.forms.map((function(a,i){t[i]=e.$store.dispatch("department/allocation",Object(r["a"])(Object(r["a"])({},a),{},{depUuid:e.depUuid}))})),Promise.all(t).then((function(t){console.log(t),e.$message({type:"success",message:"操作成功"}),e.$bus.$emit("handleRefresh"),e.closeDialog()})).catch((function(t){e.$message({type:"error",message:t}),e.$bus.$emit("handleRefresh"),e.closeDialog()}))}else{var a=Object(r["a"])(Object(r["a"])({},this.form),{},{depUuid:this.depUuid});this.$store.dispatch("department/allocation",a).then((function(t){e.$message({type:"success",message:"操作成功"}),e.$bus.$emit("handleRefresh"),e.closeDialog()})).catch((function(t){e.$message({type:"error",message:t})}))}}}}),U=A,q=Object(m["a"])(U,E,L,!1,null,null,null),O=q.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-select",{model:{value:e.roleUuid,callback:function(t){e.roleUuid=t},expression:"roleUuid"}},e._l(e.roleList,(function(e){return a("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),e._v(" "),a("div",{staticClass:"text-align-center"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleConfrim}},[e._v("确定")])],1)],1)],1)},j=[],R={data:function(){return{roleUuid:"",form:{alias:"",departmentUuids:[],name:"",position:"",uuid:""},forms:[],isBatchUpdate:!1}},watch:{user:{handler:function(e,t){0!=Object.keys(e)&&(this.roleUuid=e.role.uuid,this.isBatchUpdate=!1,this.form.alias=e.alias,this.form.name=e.name,this.form.position=e.position,this.form.uuid=e.uuid)},immediate:!0},users:{handler:function(e,t){var a=this;e.length>0&&(this.isBatchUpdate=!0,this.roleUuid=e[0].role.uuid,e.map((function(e,t){a.forms[t]={alias:e.alias,name:e.name,position:e.position,uuid:e.uuid}})))},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({user:function(e){return e.user.currentRowUserList},users:function(e){return e.user.currentRowUsers},roleList:function(e){return e.role.roleListSelect}})),methods:{closeDialog:function(){this.$parent.$parent.dialogVisible=!1},handleCancel:function(){this.closeDialog()},handleConfrim:function(){var e=this;if(this.isBatchUpdate){var t=[];this.forms.map((function(a,i){t[i]=e.$store.dispatch("user/user_update",Object(r["a"])(Object(r["a"])({},a),{},{roleUuid:e.roleUuid}))})),Promise.all(t).then((function(t){console.log(t),e.$message({type:"success",message:"操作成功"}),e.$bus.$emit("handleRefresh"),e.closeDialog()})).catch((function(t){e.$message({type:"error",message:t}),e.$bus.$emit("handleRefresh"),e.closeDialog()}))}else{var a=Object(r["a"])(Object(r["a"])({},this.form),{},{roleUuid:this.roleUuid});this.$store.dispatch("user/user_update",a).then((function(t){e.$message({type:"success",message:"操作成功"}),e.$bus.$emit("handleRefresh"),e.closeDialog()})).catch((function(t){e.$message({type:"error",message:t})}))}}}},N=R,M=Object(m["a"])(N,I,j,!1,null,null,null),z=M.exports,P={components:{CreateTemplate:x,EditTemplate:D,DistributeTemplate:O,DistributeRoleTemplate:z},data:function(){return{dialogVisible:!1,event:"",eventType:""}},watch:{eventType:{handler:function(e,t){e&&this.genTitle()},immediate:!0}},computed:Object(r["a"])({},Object(c["c"])({})),mounted:function(){},updated:function(){},methods:{genTitle:function(){return"distribute"===this.eventType?"分配部门":"distributeRole"===this.eventType?"分配角色":void 0}}},F=P,V=Object(m["a"])(F,p,g,!1,null,null,null),B=V.exports,G=a("8690"),W={components:{ListHeader:h,FormDialog:B,ToolBar:G["a"]},data:function(){return{pageConfig:{total:0,pageNumber:1,pageSize:20},query:{page:0,size:20,userName:"",departmentsUuid:"",roleUuid:"",isFollowUser:null,isMessageUser:null,visible:null},checkedUserList:[]}},watch:{},computed:Object(r["a"])({},Object(c["c"])({loading:function(e){return e.user.loading},userList:function(e){return e.user.userList},userPage:function(e){return e.user.userPage},permissionMap:function(e){return e.permission.permissionMap}})),created:function(){this.$store.dispatch("role/getRoleListSelect"),this.$store.dispatch("department/getDepartmentListSelect"),this.initDataList(this.query)},mounted:function(){var e=this;this.$bus.$on("handleRefresh",(function(){e.initDataList(e.query)}))},beforeDestroy:function(){this.$bus.$off("handleRefresh")},methods:{handleSelectionChange:function(e){this.checkedUserList=e},doExport:function(e){if(0==this.checkedUserList.length)console.log("请求接口导出全部");else{var t=["员工姓名","部门","角色","会话存档授权","允许登陆","通讯录授权"],i=[];this.checkedUserList.map((function(e){i.push([e.name,e.departments[e.departments.length-1].name,e.role.name,e.isMessageUser?"已授权":"未授权",e.visible?"允许":"禁止",e.isFollowUser?"已授权":"未授权"])})),Promise.resolve().then((function(){return Object(s["a"])(a("4bf8d"))})).then((function(e){e.export_json_to_excel({header:t,data:i,filename:"excel-list",autoWidth:!0,bookType:"xlsx"})}))}},handleUpdate:function(){this.initDataList(this.query)},handleDistributeRole:function(e){var t=this.userList[e];this.$store.commit("user/SAVE_CURRENTROW",t),this.$refs["formDialog"].event="DistributeRoleTemplate",this.$refs["formDialog"].eventType="distributeRole",this.$refs["formDialog"].dialogVisible=!0},handleDistributeDepartment:function(e){var t=this.userList[e];this.$store.commit("user/SAVE_CURRENTROW",t),this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0},actionRole:function(){this.checkedUserList.length?(this.$store.commit("user/SAVE_CURRENTROWS",this.checkedUserList),this.$refs["formDialog"].event="DistributeRoleTemplate",this.$refs["formDialog"].eventType="distributeRole",this.$refs["formDialog"].dialogVisible=!0):this.$message({type:"error",message:"请选择至少一项"})},actionDepartment:function(){this.$refs.listHeader.query.departmentsUuid?this.checkedUserList.length?(this.$store.commit("user/SAVE_CURRENTROWS",this.checkedUserList),this.$refs["formDialog"].event="DistributeTemplate",this.$refs["formDialog"].eventType="distribute",this.$refs["formDialog"].dialogVisible=!0):this.$message({type:"error",message:"请选择至少一项"}):this.$message({type:"error",message:"请先选择部门"})},sortChange:function(e){this.initDataList()},pageChange:function(){this.initDataList()},initDataList:function(e){var t=this;this.$store.dispatch("user/getUserList",e).then((function(){t.pageConfig.pageNumber=t.userPage.pageNumber+1,t.pageConfig.total=t.userPage.total})).catch((function(e){t.$message({type:"error",message:"初始化失败"})}))},handleDetail:function(e){var t=this.userList[e].uuid;this.$router.push({path:"/user/detail/"+t})},handleSearch:function(e){var t=e.userName,a=e.departmentsUuid,i=e.roleUuid,n=e.isFollowUser,s=e.isMessageUser,r=e.visible;this.query.userName=t||t,this.query.departmentsUuid=a||a,this.query.roleUuid=i||i,this.query.isFollowUser=n||n,this.query.isMessageUser=s||s,this.query.visible=r||r,this.query.page=0,this.initDataList(this.query)},handleRefresh:function(){console.log("handleRefresh"),this.query=this.$options.data().query,this.initDataList(this.query)},changePage:function(e){console.log(this.query),this.query.page=e-1,this.pageConfig.pageNumber=e,this.initDataList(this.query)},changeSize:function(e){this.query.size=e,this.initDataList(this.query)}}},H=W,J=(a("046d"),Object(m["a"])(H,i,n,!1,null,"cefd78f8",null));t["default"]=J.exports},ffe9:function(e,t,a){"use strict";var i=a("6f6c1"),n=a.n(i);n.a}}]);